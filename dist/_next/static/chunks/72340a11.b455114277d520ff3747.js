(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[6],{ydiI:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AdaptableNoCodeWizard=e.Adaptable=e.waitForCondition=void 0;var o=i("mrSG"),n=i("DR3G"),r=o.__importDefault(i("hbEN")),a=o.__importDefault(i("Muja")),l=o.__importDefault(i("UXvI")),s=o.__importDefault(i("lE2N")),u=o.__importStar(i("q1tI")),p=o.__importStar(i("i8i4")),d=o.__importDefault(i("8QLk")),c=i("EYOP"),h=i("RQz/"),f=i("w5Eo"),m=i("0J2a"),g=o.__importStar(i("fwGq")),C=i("fwGq"),y=o.__importStar(i("+Pxh")),v=i("02Nn"),O=o.__importDefault(i("F9nB")),A=i("zwJd"),S=i("qN6A"),E=o.__importDefault(i("vs66")),b=o.__importDefault(i("U/tm")),w=o.__importDefault(i("1f9d")),N=i("z1Bd"),I=i("pBDx"),D=o.__importStar(i("fkJU")),F=i("adxL"),_=i("KOcV"),G=i("9G3X"),R=i("+0VI"),V=i("bQXN"),x=i("SF8o"),P=i("QEyg"),T=i("hNCx"),L=i("fmQe"),M=i("QIb0"),k=o.__importDefault(i("vk8B")),H=i("n6u+"),K=o.__importDefault(i("OUop")),U=i("yRSI"),B=i("pioK"),W=i("wnz6"),z=i("CUPq"),j=i("YKwl"),Q=i("eoug"),q=i("E/Df"),Y=i("mbJ9"),J=i("Zss7");n.ModuleRegistry.registerModules(n.AllCommunityModules);var X=function(t){t&&(t.field&&!t.colId&&(t.colId=t.field),t.children?t.children.forEach(X):t.colId||I.LogAdaptableWarning("A column is missing the colId - please check ",t,'Either pass a "field" property or a "colId" property.'))};e.waitForCondition=function(t,e){void 0===e&&(e=5e3);var i=Date.now();return t()?Promise.resolve():new Promise((function(o,n){var r=function(o){var a=t();Date.now()-i>e?n("Wait time expired"):a?o():setTimeout((function(){r(o)}),16)};r(o)}))};var Z=n.RowNode.prototype,$=Z.dispatchLocalEvent,tt=n.GridApi.prototype.setColumnDefs,et=function(t,e,i){t.forEach((function(t,o,n){t.children?et(t.children,e,t):e(t,o,n,i)}))},it={},ot=function(){function t(){var t=this;this.colDefPropertyCache=new Map,this.gridOptionsPropertyCache=new Map,this.flashingState=new Map,this._on=function(e,i){return t.emitter?t.emitter.on(e,i):function(){}},this._emit=function(e,i){if(t.emitter)return t.emitter.emit(e,i)},this._emitSync=function(e,i){if(t.emitter)return t.emitter.emitSync(e,i)},this._adaptableReady=!1,this.agGridModules=[],this.isPluginLoaded=function(e){for(var i=t.adaptableOptions.plugins||[],o=0,n=i.length;o<n;o++){if(i[o].pluginId===e)return!0}return!1},this.debouncedSetColumnIntoStore=r.default((function(){t.gridOptions.api&&t.updateColumnsIntoStore()}),C.HALF_SECOND),this.debouncedSaveGridLayout=r.default((function(){t.gridOptions.api&&t.updateLayoutFromGrid()}),C.HALF_SECOND),this.debouncedSetSelectedCells=r.default((function(){t.gridOptions.api&&t.setSelectedCells()}),250),this.debouncedSetSelectedRows=r.default((function(){t.gridOptions.api&&t.setSelectedRows()}),C.HALF_SECOND),this.debouncedFilterGrid=r.default((function(e){void 0===e&&(e=function(){}),t.gridOptions.api&&(t.applyGridFiltering(),e&&e())}),C.HALF_SECOND),this.mapColumnDefs=function(e,i,o){return o=o||{removeEmpty:!1},e=e||t.getGroupAndColumnDefs(),et(e,(function(t,e,n,r){var a=i(t,e,n),l=r?r.children:n;l[e]=a,e===n.length-1&&o.removeEmpty&&r&&(r.children=l.filter((function(t){return!!t})))})),o.removeEmpty&&(e=e.filter((function(t){return!!t}))),e},this.getGroupAndColumnDefs=function(){return[].concat(t.currentColumnDefs||t.gridOptions.columnDefs)},this.getColumnDefsWithCorrectVisibility=function(){var e=t.api.layoutApi.getCurrentVisibleColumnIdsMap();return t.gridOptions.columnApi.getAllColumns().map((function(t){var i=t.getColDef(),o=t.getColId();return i.colId=o,i.hide=!e[o],i}))},this.getPreviousColDefInfo=function(t){return t.__ab||{}}}return t.init=function(e){return t.initInternal(e)},t.initInternal=function(e,i){return o.__awaiter(this,void 0,void 0,(function(){var n,r,a,l,s,u,p,d,c;return o.__generator(this,(function(h){if({renderGrid:void 0,runtimeConfig:null},n=null,Array.isArray(e.plugins)){r=function(t){n=n&&n.then?n.then((function(){return t.beforeInit(e)})):t.beforeInit(e)};try{for(a=o.__values(e.plugins),l=a.next();!l.done;l=a.next())s=l.value,r(s)}catch(f){d={error:f}}finally{try{l&&!l.done&&(c=a.return)&&c.call(a)}finally{if(d)throw d.error}}}return u=function(t){return t.init(e,i,!0).then((function(i){return Array.isArray(e.plugins)&&e.plugins.forEach((function(e){e.afterInit(t)})),i}))},n&&n.then?[2,n.then((function(){var e=new t;return u(e)}))]:(p=new t,[2,u(p)])}))}))},t.collectInstance=function(t){t._id=t.adaptableOptions.adaptableId||f.createUuid(),it[t._id]=t},t.forEachAdaptable=function(t){Object.keys(it).forEach((function(e){t(it[e])}))},t.dismissInstance=function(t){delete it[t._id]},t.prototype.init=function(e,i,n){var r,a,s,u,d,h,f;return o.__awaiter(this,void 0,void 0,(function(){var m,g=this;return o.__generator(this,(function(y){return n||I.ConsoleLogWarning('\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!!! You should not use the "Adaptable" constructor directly, as it was deprecated in v6 and removed in v7!\n!!!!!!!\n!!!!!!! Use const api = await Adaptable.init(adaptableOptions) instead.\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'),this.emitter=new O.default,this.adaptableOptions=b.default.assignadaptableOptions(e),this.hasAutogeneratedPrimaryKey()&&(I.LogAdaptableInfo("Autogenerated primary key (adaptableOptions.autogeneratedPrimaryKey = TRUE) should be used only as a last resort,\n      when no unique column is available, as it limits some Adaptable functionalities!\n\n      For more details see: https://docs.adaptabletools.com/docs/key-topics/primary-key"),this.adaptableOptions.primaryKey=C.AUTOGENERATED_PK_COLUMN),t.collectInstance(this),b.default.checkAdaptableOptions(this.adaptableOptions),this.runtimeConfig=i||{},this.agGridModules=this.runtimeConfig.modules||[],this.gridOptions=this.adaptableOptions.vendorGrid,void 0===this.gridOptions.allowContextMenuWithControlKey&&(this.gridOptions.allowContextMenuWithControlKey=!0),this.isInitialised=!1,this.useRowNodeLookUp=!1,this.forPlugins((function(t){return t.afterInitOptions(g,g.adaptableOptions)})),this.api=new c.AdaptableApiImpl(this),this.forPlugins((function(t){return t.afterInitApi(g,g.api)})),this.DataService=new _.DataService(this),this.agGridHelper=new B.agGridHelper(this,this.gridOptions),this.agGridMenuHelper=new W.agGridMenuHelper(this,this.gridOptions),this.initStore(),this.ValidationService=new x.ValidationService(this),this.ReportService=new R.ReportService(this),this.ModuleService=new V.ModuleService(this),this.CalculatedColumnExpressionService=new F.CalculatedColumnExpressionService(this),this.EntitlementService=new P.EntitlementService(this),this.ExpressionService=new T.ExpressionService(this),this.AlertService=new L.AlertService(this),this.TeamSharingService=new G.TeamSharingService(this),this.forPlugins((function(t){return t.afterInitServices(g)})),this.modules=this.agGridHelper.setUpModules(),this.forPlugins((function(t){return t.afterInitModules(g,g.modules)})),this.gridOptions.api&&(this.gridOptions.api.__adaptable=this),this.gridOptions.columnTypes=this.gridOptions.columnTypes||{},Object.assign(this.gridOptions.columnTypes,((m={})[C.AB_SPECIAL_COLUMN]={},m.abColDefNumber=null!==(r=this.gridOptions.columnTypes.abColDefNumber)&&void 0!==r?r:{},m.abColDefString=null!==(a=this.gridOptions.columnTypes.abColDefString)&&void 0!==a?a:{},m.abColDefBoolean=null!==(s=this.gridOptions.columnTypes.abColDefBoolean)&&void 0!==s?s:{},m.abColDefDate=null!==(u=this.gridOptions.columnTypes.abColDefDate)&&void 0!==u?u:{},m.abColDefObject=null!==(d=this.gridOptions.columnTypes.abColDefObject)&&void 0!==d?d:{},m.abColDefCustom=null!==(h=this.gridOptions.columnTypes.abColDefCustom)&&void 0!==h?h:{},m.abColDefNumberArray=null!==(f=this.gridOptions.columnTypes.abColDefNumberArray)&&void 0!==f?f:{},m)),void 0===this.gridOptions.columnTypes.abColDefNumber.cellEditor&&(this.gridOptions.columnTypes.abColDefNumber.cellEditor=Y.AdaptableNumberEditor),void 0===this.gridOptions.columnTypes.abColDefDate.cellEditor&&(this.gridOptions.columnTypes.abColDefDate.cellEditor=Y.AdaptableDateEditor),[2,this.initializeAgGrid().then((function(t){if(!t)return I.LogAdaptableError("Unable to set up ag-Grid"),g.api;var e=g;return g.gridOptions.api&&(g.gridOptions.api.__adaptable=g,g.gridOptions.api.setColumnDefs=function(t){e.currentColumnDefs=[].concat(t);var i=tt.apply(this,arguments);return e.setupColumns(),i}),g.adaptableStore.Load.then((function(){g.initInternalGridLogic(),b.default.checkValidPrimaryKey(g)}),(function(t){I.LogAdaptableError("Failed to Init Modules : ",t),g.initInternalGridLogic(),g.api.internalApi.hideLoadingScreen()})).then((function(){return o.__awaiter(g,void 0,void 0,(function(){return o.__generator(this,(function(t){return this.isInitialised=!0,this.api.internalApi.hideLoadingScreen(),[2]}))}))})),null==g.abContainerElement&&(g.abContainerElement=g.getadaptableContainerElement()),null!=g.abContainerElement&&(g.abContainerElement.innerHTML="",p.render(M.AdaptableApp({Adaptable:g}),g.abContainerElement)),g.throttleFilterOnEditDataChange=l.default(g.gridOptions.api.onFilterChanged,g.adaptableOptions.searchOptions.filterActionOnUserDataChange.throttleDelay),g.throttleFilterOnTickingDataChange=l.default(g.gridOptions.api.onFilterChanged,g.adaptableOptions.searchOptions.filterActionOnExternalDataChange.throttleDelay),g.api}))]}))}))},t.prototype.forPlugins=function(t){Array.isArray(this.adaptableOptions.plugins)&&this.adaptableOptions.plugins.forEach((function(e){t(e)}))},t.prototype.getPlugin=function(t){var e=(this.adaptableOptions.plugins||[]).filter((function(e){return e.pluginId===t}))[0];if(!e)throw'Cannot find plugin "'+t+'". Make sure you spelled it right!';return e},t.prototype.getPluginProperty=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r=this.adaptableOptions.plugins||[],a=r.filter((function(e){return e.pluginId===t}))[0];if(!a)throw'Cannot find plugin "'+t+'". Make sure you spelled it right!';if(a&&a.hasProperty(e))return a.getProperty(e).apply(void 0,o.__spread(i))},t.prototype.lookupPlugins=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=this.adaptableOptions.plugins||[],r=0,a=n.length;r<a;r++){var l=n[r];if(l.hasProperty(t))return l.getProperty(t).apply(void 0,o.__spread(e))}},t.prototype.initStore=function(){var t=this;this.adaptableStore=new m.AdaptableStore(this),this.adaptableStore.onAny((function(e,i){t.performAudit(i.action,i.state,i.newState),t.forPlugins((function(o){return o.onStoreEvent(e,i,t.adaptableStore)})),e==m.INIT_STATE&&(t._adaptableReady=!0,t.forPlugins((function(e){return e.onAdaptableReady(t,t.adaptableOptions)})),t.api.eventApi.emit("AdaptableReady",{adaptableApi:t.api,vendorGrid:t.adaptableOptions.vendorGrid}))}))},t.prototype.performAudit=function(t,e,i){var o={actionName:t.type,clientTimestamp:new Date,userName:this.adaptableOptions.userName,adaptableId:this.adaptableOptions.adaptableId,adaptableStateKey:this.adaptableOptions.adaptableStateKey,action:t,oldState:e,newState:i};this.api.eventApi.emit("AdaptableStateChanged",o)},t.prototype.initializeAgGrid=function(){var t,i=this;if(this.useRowNodeLookUp=this.agGridHelper.TrySetUpNodeIds(),Array.isArray(this.gridOptions.columnDefs)&&this.gridOptions.columnDefs.forEach(X),(null===(t=this.adaptableOptions.generalOptions)||void 0===t?void 0:t.hideEmptyGroupRows)&&(this.gridOptions.components=this.gridOptions.components||{},this.gridOptions.autoGroupColumnDef=this.gridOptions.autoGroupColumnDef||{},this.gridOptions.autoGroupColumnDef.cellRenderer||(this.gridOptions.autoGroupColumnDef.cellRenderer="__adaptableGroupCellRenderer",this.gridOptions.components.__adaptableGroupCellRenderer=Q.AdaptableGroupCellRenderer)),this.adaptableOptions.userInterfaceOptions.showAdaptableToolPanel&&this.gridOptions.sideBar){this.gridOptions.sideBar=this.gridOptions.sideBar||{},this.gridOptions.components=this.gridOptions.components||{};var r=this.gridOptions.sideBar;if(!0===r)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!0,!0);else if("columns"===r)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!1,!0);else if("filters"===r)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!0,!1);else{var a=this.gridOptions.sideBar;a&&(a.toolPanels=a.toolPanels||[],a.toolPanels.push(this.agGridHelper.createAdaptableToolPanel()))}this.gridOptions.components.AdaptableToolPanel=H.getAdaptableToolPanelAgGridComponent(this),this.gridOptions.api&&this.gridOptions.api.setSideBar(this.gridOptions.sideBar)}var l,s=function(){var t=i.getGridContainerElement();return!(!t&&!(t=i.initVendorContainerFromInitializedAgGrid()))||(I.LogAdaptableError("You must provide an element id in `containerOptions.vendorContainer`"),!1)};if(this.gridOptions.api&&"function"===typeof this.gridOptions.api.getValue)return s()?Promise.resolve(!0):Promise.resolve(!1);if(this.runtimeConfig.waitForAgGrid)return e.waitForCondition((function(){return!!i.gridOptions.api})).then((function(){return i.initVendorContainerFromInitializedAgGrid(),Promise.resolve(!0)}),(function(){return I.ConsoleLogError("Could not find any agGrid instance rendered."),Promise.reject(!1)}));if(!s())return Promise.resolve(!1);var u=(this.adaptableOptions.vendorGrid||{}).modules||[];this.agGridModules=o.__spread(this.agGridModules,u);var p=this.getGridContainerElement();return this.gridOptions.modules&&delete this.gridOptions.modules,l=new n.Grid(p,this.gridOptions,{modules:u}),this.gridOptions.api&&(this.gridOptions.api.__adaptable=this),Promise.resolve(null!=l)},t.prototype.initVendorContainerFromInitializedAgGrid=function(){if(!this.getGridContainerElement()){for(var t,e=this.gridOptions.api&&this.gridOptions.api.gridOptionsWrapper&&this.gridOptions.api.gridOptionsWrapper.layoutElements||[],i=0,o=e.length;i<o;i++){var n=e[i];if(n&&n.matches(".ag-root-wrapper")){var r=n.closest('[class*="ag-theme"]');if(r){t=r;break}}}return t||I.ConsoleLogError("Could not find the agGrid vendor container. This will probably break some AdapTable functionality."),this.adaptableOptions.containerOptions.vendorContainer=t}},t.prototype.filterOnEditDataChange=function(){this.adaptableOptions.searchOptions.filterActionOnUserDataChange.applyFilter==h.FilterOnDataChangeOptions.Always?this.gridOptions.api.onFilterChanged():this.adaptableOptions.searchOptions.filterActionOnUserDataChange.applyFilter==h.FilterOnDataChangeOptions.Throttle&&this.throttleFilterOnEditDataChange()},t.prototype.filterOnTickingDataChange=function(){this.adaptableOptions.searchOptions.filterActionOnExternalDataChange.applyFilter==h.FilterOnDataChangeOptions.Always?this.gridOptions.api.onFilterChanged():this.adaptableOptions.searchOptions.filterActionOnExternalDataChange.applyFilter==h.FilterOnDataChangeOptions.Throttle&&this.throttleFilterOnTickingDataChange()},t.prototype.applyGridFiltering=function(){this.api.filterApi.isQuickFilterAvailable()&&(this.api.filterApi.isQuickFilterVisible()?this.showQuickFilter():this.hideQuickFilter()),this.gridOptions.api.onFilterChanged(),this._emit("GridFiltered"),this.setSelectedCells(),this.setSelectedRows()},t.prototype.isGroupRowNode=function(t){return!!t&&(!!t.isEmptyRowGroupNode()||(!(!t.group||!0!==t.group)||!(!t.leafGroup||!0!==t.leafGroup)))},t.prototype.isVisibleNode=function(t){return null!=this.gridOptions.api.getRenderedNodes().find((function(e){return e.id==t.id}))},t.prototype.isPinnedRowNode=function(t){return!!t&&!!t.isRowPinned()},t.prototype.clearGridFiltering=function(){this.gridOptions.columnApi.getAllColumns().forEach((function(t){t.setFilterActive(!1)}))},t.prototype.clearColumnFiltering=function(t){var e=this;t.forEach((function(t){var i=e.gridOptions.columnApi.getAllColumns().find((function(e){return e.getColId()==t}));i&&i.setFilterActive(!1)}))},t.prototype.hideFilterForm=function(){this.hideFilterFormPopup&&this.hideFilterFormPopup()},t.prototype.updateColumnsIntoStore=function(){var t=this,e=[],i=this.gridOptions.columnApi.getAllColumns(),o=this.gridOptions.columnApi.getAllDisplayedColumnGroups(),n={},r=o.reduce((function(t,e){var i,o,r;if(!(null===(o=null===(i=e.getOriginalColumnGroup)||void 0===i?void 0:i.call(e))||void 0===o?void 0:o.getColGroupDef()))return t;var a=e.getGroupId(),l=!e.getOriginalColumnGroup().getColGroupDef().marryChildren,s=null!==(r=e.getOriginalColumnGroup().getColGroupDef().headerName)&&void 0!==r?r:a,u=e.getLeafColumns();return u.forEach((function(e){var i={ColumnGroupId:a,FriendlyName:s,AllowGroupSplit:l,GroupCount:0};n[i.ColumnGroupId]=n[i.ColumnGroupId]||0,n[i.ColumnGroupId]+=u.length,t[e.getColId()]=i})),t}),{});Object.keys(r).forEach((function(t){r[t].GroupCount=n[r[t].ColumnGroupId]})),i.forEach((function(i){var o=i.getColId();t.api.columnApi.isRowGroupColumn(o)||e.push(t.createAdaptableColumn(i,r))})),this.api.internalApi.setColumns(e)},t.prototype.createAdaptableColumn=function(t,e){return this.agGridHelper.createAdaptableColumnFromVendorColumn(t,e)},t.prototype.safeSetColDefs=function(t){t=this.mapColumnDefs(t,(function(t){return t.field&&null==t.colId&&(t.colId=t.field),t})),this.gridOptions.api.setColumnDefs(t),this.updateColumnsIntoStore()},t.prototype.getFormatColumnCellStyle=function(t,e){var i={},o=t.ColumnStyle;if(o){var n=null===o||void 0===o?void 0:o.GradientStyle;if(n){if(!o.IncludeGroupedRows&&this.isGroupRowNode(e.node))return;var r=this.api.formatColumnApi.getNumericStyleMinValue(o,e),a=this.api.formatColumnApi.getNumericStyleMaxValue(o,e),l=d.default(e.value,r,a),s=void 0,u=!1;if(n.ColumnComparison)s=n.ColumnComparison.Color;else{var p=n.CellRanges.find((function(t){return t.Min<=l&&t.Max>=l}));p&&(s=p.Color,u=p.ReverseGradient)}var c=Math.abs(a-r),h=(e.value-r)/c*100,f=Number((h/100).toPrecision(2));u&&(f=1-f),i.backgroundColor=J(s).setAlpha(f).toRgbString()}}else t.Style&&(i=this.convertAdaptableStyleToCSS(t.Style));if(t.CellAlignment)switch(t.CellAlignment){case"Left":i.textAlign="left";break;case"Right":i.textAlign="right";break;case"Center":i.textAlign="center"}return i},t.prototype.getAlertCellStyle=function(t,e){var i=this.api.internalApi.getAdaptableAlerts().filter((function(i){var o;return(null===(o=i.alertDefinition.AlertProperties)||void 0===o?void 0:o.HighlightCell)&&i.dataChangedInfo&&i.dataChangedInfo.columnId===t.ColumnId&&i.dataChangedInfo.rowNode===e.node}))[0];if(i)return{backgroundColor:K.default.getColorByMessageType(i.alertDefinition.MessageType)}},t.prototype.getFlashingAlertRowStyle=function(t){var e=this.getPrimaryKeyValueFromRowNode(t.node);return this.getFlashingAlertStyleFor(e)},t.prototype.getFlashingAlertStyleFor=function(t,e){var i,o=this.api.internalApi.getAdaptableFlashingAlertFor(t,e);return o?this.convertAdaptableStyleToCSS(null!==(i="up"===o.direction?o.flashingAlertDefinition.UpChangeStyle:"down"===o.direction?o.flashingAlertDefinition.DownChangeStyle:o.flashingAlertDefinition.NeutralChangeStyle)&&void 0!==i?i:{}):{}},t.prototype.getFlashingAlertCellStyle=function(t,e){var i=this.getPrimaryKeyValueFromRowNode(e.node);return this.getFlashingAlertStyleFor(i,t.ColumnId)},t.prototype.getCellHighlightStyle=function(t,e){var i,o=this.getPrimaryKeyValueFromRowNode(e.node),n=this.api.internalApi.getSystemState().HighlightedCells.find((function(e){return t.ColumnId===e.columnId&&e.primaryKeyValue===o}));if(n)switch(null!==(i=n.highlightType)&&void 0!==i?i:"Info"){case"Error":return{backgroundColor:"var(--ab-color-error)"};case"Info":return{backgroundColor:"var(--ab-color-info)"};case"Success":return{backgroundColor:"var(--ab-color-success)"};case"Warning":return{backgroundColor:"var(--ab-color-warn)"}}},t.prototype.getQuickSearchCellStyle=function(){var t=this.api.quickSearchApi.getQuickSearchStyle();if(t&&!S.StringExtensions.IsNotNullOrEmpty(t.ClassName))return this.convertAdaptableStyleToCSS(t)},t.prototype.getEditableCellStyle=function(t,e){var i=this.api.userInterfaceApi.getEditableCellStyle();if(i){var o=this.getGridCellFromRowNode(e.node,t.ColumnId);return o&&this.api.gridApi.areCellsEditable([o])?this.convertAdaptableStyleToCSS(i):void 0}},t.prototype.getReadOnlyCellStyle=function(t,e){var i=this.api.userInterfaceApi.getReadOnlyCellStyle();if(i){var o=this.getGridCellFromRowNode(e.node,t.ColumnId);return o&&!this.api.gridApi.areCellsEditable([o])?this.convertAdaptableStyleToCSS(i):void 0}},t.prototype.getConditionalStyleCellStyle=function(t,e,i){void 0===t&&(t=[]);var n=this.ModuleService.getModuleById(y.ConditionalStyleModuleId),r=t.reduce((function(t,r){return n.isConditionalStyleActiveForColumn(r,e,i)?o.__assign(o.__assign({},t),r.Style):t}),{});return this.convertAdaptableStyleToCSS(r)},t.prototype.getConditionalStyleCellClass=function(t,e,i){void 0===t&&(t=[]);var o=this.ModuleService.getModuleById(y.ConditionalStyleModuleId);return t.map((function(t){var n,r;if((null===(n=t.Style)||void 0===n?void 0:n.ClassName)&&o.isConditionalStyleActiveForColumn(t,e,i))return null===(r=t.Style)||void 0===r?void 0:r.ClassName})).filter((function(t){return!!t})).join(" ")},t.prototype.isQuickSearchActive=function(t,e){if(t.IsExcludedFromQuickSearch)return!1;if(!e.node||e.node.group)return!1;var i=this.api.quickSearchApi.getQuickSearchValue();if(S.StringExtensions.IsNullOrEmpty(i))return!1;var o=D.default.CreateColumnFilter(t.ColumnId,"Contains",[i]);return this.api.filterApi.evaluateColumnFilter(o,e.node)},t.prototype.getPrimaryKeyValueFromRowNode=function(t){var e,i,o=this.getGridOptionsApi();return o&&!this.hasAutogeneratedPrimaryKey()&&(i=o.getValue(this.adaptableOptions.primaryKey,t)),(null===i||void 0==i)&&t&&t.data&&(i=null!==(e=t.data[this.adaptableOptions.primaryKey])&&void 0!==e?e:null),i},t.prototype.getActiveCell=function(){var t=this.gridOptions.api.getFocusedCell();if(t){var e=this.gridOptions.api.getModel().getRow(t.rowIndex);if(e&&!this.isGroupRowNode(e)){var i=t.column.getColId();return this.getGridCellFromRowNode(e,i)}}},t.prototype.getCurrentCellEditValue=function(){var t=this.gridOptions.api.getFocusedCell();if(t){var e=this.gridOptions.api.rowRenderer;if(e){var i=e.rowCompsByIndex[t.rowIndex];if(i){var o=i.cellComps[t.column.getColId()].cellEditor;if(o){var r=o instanceof n.PopupEditorWrapper?o.cellEditor:o;if(r)return r.getValue()}}}}return""},t.prototype.getSortedColumnStateForVisibleColumns=function(t,e){var i=this;e=e||this.gridOptions.columnApi.getColumnState();var n=t.reduce((function(t,e,i){return t[e]=i,t}),{}),r=e.reduce((function(t,e,i){return t[e.colId]=i,t}),{}),a=t.reduce((function(t,e,i){return t[e]=i,t}),{});return o.__spread(e).sort((function(t,e){var o=t.colId,n=e.colId,l=r[o],s=r[n],u=i.api.columnApi.isRowGroupColumn(o),p=i.api.columnApi.isRowGroupColumn(n);return u&&p?1:u?-1:p?1:null!=a[o]&&null==a[n]?-1:null==a[o]&&null!=a[n]?1:null==a[o]&&null==a[n]?l-s:a[t.colId]-a[e.colId]})).map((function(t){return o.__assign(o.__assign({},t),{hide:null==n[t.colId]})}))},t.prototype.setColumnOrder=function(t){var e=this.getSortedColumnStateForVisibleColumns(t);this.gridOptions.columnApi.setColumnState(e),this.updateColumnsIntoStore()},t.prototype.persistLayout=function(t){this.api.layoutApi.shouldAutoSaveLayout(t)?this.api.layoutApi.saveLayout(t):this.api.internalApi.updateCurrentDraftLayout(t)},t.prototype.setLayout=function(t){var e,i,n,r,l,s,u=this;t||(t=this.api.layoutApi.getCurrentLayout()),t.Columns=t.Columns||[];var p=t.Columns.reduce((function(t,e){return t[e]=!0,t}),{}),d=this.gridOptions.columnApi.getColumnState(),c={},h=d.reduce((function(t,e,i){return c[e.colId]=i,t[e.colId]=e,t}),{}),f=0,m=(null!==(e=t.ColumnSorts)&&void 0!==e?e:[]).reduce((function(t,e){var i=e.ColumnId;return p[i]?(t[i]={colId:i,sort:"Asc"===e.SortOrder?"asc":"desc",sortIndex:f},f++,t):t}),{}),g=(t.RowGroupedColumns||[]).reduce((function(t,e,i){return t[e]=i,t}),{}),C={},y=t.AggregationColumns||{},v=o.__spread(t.PivotColumns||[],Object.keys(t.AggregationColumns||{})),O=t.EnablePivot?v||[]:t.Columns;v.length&&t.RowGroupedColumns&&v.push.apply(v,o.__spread(t.RowGroupedColumns));var S=!1,E={},b=this.getSortedColumnStateForVisibleColumns(O,d);if(b=b.map((function(e){var i,n,r,l,s=e.colId,d=h[s],c=!p[s],f=o.__assign(o.__assign({},d),{hide:c});t.ColumnWidthMap&&null!=t.ColumnWidthMap[s]?f.width=t.ColumnWidthMap[s]:E[s]=!0,f.rowGroupIndex=null!=g[s]?g[s]:null,f.rowGroup=null!=f.rowGroupIndex;var v=!!t.PinnedColumnsMap&&t.PinnedColumnsMap[s];if(v&&(f.pinned=v),f.pivotIndex=null,null!=C[s]&&(f.pivotIndex=C[s]),f.aggFunc=null,null!=y[s]){var O=null===(n=null===(i=u.gridOptions)||void 0===i?void 0:i.api)||void 0===n?void 0:n.getColumnDef(s);f.aggFunc=!0===y[s]?null!==(l=null!==(r=e.aggFunc)&&void 0!==r?r:null===O||void 0===O?void 0:O.aggFunc)&&void 0!==l?l:"sum":y[s]}return m[s]?(f.sort=m[s].sort,f.sortIndex=m[s].sortIndex):(f.sort=null,f.sortIndex=null),S=S||!a.default(f,d),f})).filter((function(t){return!!t})),!S){var w=function(t){return t.colId+"-"+t.rowGroupIndex+"-"+t.pivotIndex+"-"+t.aggFunc+"-"+t.pinned+"-"+t.width+"-"+t.hide},N=d.map(w).join(","),I=b.map(w).join(",");S=I!=N}var D=!!t.EnablePivot,F=this.gridOptions.columnApi.isPivotMode()!==D;S=S||F,A.ArrayExtensions.IsNotNullOrEmpty(t.ExpandedRowGroupValues)&&this.adaptableOptions.layoutOptions.includeExpandedRowGroups&&this.expandRowGroupsForValues(t.ExpandedRowGroupValues),S&&(F&&this.gridOptions.columnApi.setPivotMode(D),this.gridOptions.columnApi.setColumnState(b),this.api.gridApi.setColumnSorts(t.ColumnSorts),this.gridOptions.columnApi.setPivotColumns(t.PivotColumns||[]),tt.call(this.gridOptions.api,this.gridOptions.api.getColumnDefs()));var _=Object.keys(E);if(D&&(null===(n=null===(i=this.adaptableOptions)||void 0===i?void 0:i.layoutOptions)||void 0===n?void 0:n.autoSizeColumnsInPivotLayout))return requestAnimationFrame((function(){u.gridOptions.columnApi.autoSizeAllColumns()})),void setTimeout((function(){var t;null===(t=u.gridOptions.columnApi)||void 0===t||t.autoSizeAllColumns(),setTimeout((function(){var t;null===(t=u.gridOptions.columnApi)||void 0===t||t.autoSizeAllColumns()}),200)}),100);(null===(l=null===(r=this.adaptableOptions)||void 0===r?void 0:r.layoutOptions)||void 0===l?void 0:l.autoSizeColumnsInLayout)&&_.length&&(null===(s=this.gridOptions.columnApi)||void 0===s||s.autoSizeColumns(_)),this.forPlugins((function(e){e.afterSetLayout&&e.afterSetLayout(u,t)}))},t.prototype.updateLayoutFromGrid=function(){var t=this.api.layoutApi.getCurrentLayout(),e=o.__assign({},t),i=[],n={},r={},a=[],l=this.gridOptions.columnApi.getColumnState(),s=o.__spread(new Array(l.length)),u=o.__spread(new Array(l.length)),p=[],d={},c=l.reduce((function(t,e){var o=e.colId;return e.sort&&null!=e.sortIndex&&a.push({ColumnId:o,SortOrder:"asc"===e.sort?"Asc":"Desc",SortIndex:e.sortIndex}),null!=e.width&&(t[o]=e.width),null!=e.flex&&(n[o]=e.flex),"left"===e.pinned&&(r[o]="left"),"right"===e.pinned&&(r[o]="right"),e.hide||i.push(o),null!=e.rowGroupIndex&&(s[e.rowGroupIndex]=o),null!=e.pivotIndex&&(u[e.pivotIndex]=o),e.aggFunc&&"string"===typeof e.aggFunc&&(d[o]=e.aggFunc),t}),{});a.sort((function(t,e){return t.SortIndex-e.SortIndex})),this.gridOptions.columnApi.getPivotColumns().forEach((function(t){p.push(t.getColId())})),s=s.filter((function(t){return!!t})),u=u.filter((function(t){return!!t})),e.ColumnWidthMap=c,e.PinnedColumnsMap=r,e.Columns=i,e.ColumnSorts=a,e.RowGroupedColumns=s,Object.keys(d).length&&(e.AggregationColumns=d),e.EnablePivot=this.gridOptions.columnApi.isPivotMode(),e.PivotColumns=p,this.adaptableOptions.layoutOptions.includeExpandedRowGroups&&(e.ExpandedRowGroupValues=this.getExpandRowGroupsKeys()),this.persistLayout(e)},t.prototype.setSelectedCells=function(){var t=this;if(this.isGridSelectable()){var e=this.gridOptions.api.getCellRanges(),i=[],n=[];if(!this.api.internalApi.isGridInPivotMode()){e&&e.forEach((function(e){var r,a,l=!0,s=null!=e.startRow.rowPinned,u=null!=e.endRow.rowPinned;if(s&&(u&&(l=!1),I.ConsoleLogWarning("Cannot select pinned rows in ag-Grid.")),l){var p=Math.min(e.startRow.rowIndex,e.endRow.rowIndex),d=Math.max(e.startRow.rowIndex,e.endRow.rowIndex),c=function(e){if(null!=e){var o=e.getColId(),r=t.api.columnApi.getColumnFromId(o);r&&null==i.find((function(t){return t.ColumnId==r.ColumnId}))&&i.push(r);for(var a=p;a<=d;a++){var l=t.gridOptions.api.getModel().getRow(a);if(l&&!t.isPinnedRowNode(l)){var s=t.getGridCellFromRowNode(l,o);n.push(s)}}}};try{for(var h=o.__values(e.columns),f=h.next();!f.done;f=h.next()){c(f.value)}}catch(m){r={error:m}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}}}));var r={columns:i,gridCells:n};return this.api.internalApi.setSelectedCells(r),this._emit("CellsSelected"),this.agGridHelper.fireSelectionChangedEvent(),r}}},t.prototype.setSelectedRows=function(){var t=this;if(this.isGridSelectable()){var e=this.gridOptions.api.getSelectedNodes(),i=[];if(!this.gridOptions.columnApi.isPivotMode()){A.ArrayExtensions.IsNotNullOrEmpty(e)&&e.forEach((function(e){var o={isMaster:!(null==e.master||1!=e.master),isExpanded:!(null==e.expanded||1!=e.expanded),isGroup:!(null==e.group||1!=e.group),level:e.level},n={primaryKeyValue:t.getPrimaryKeyValueFromRowNode(e),rowData:e.data,rowNode:e,rowInfo:o};i.push(n)}));var o={GridRows:i};return this.api.internalApi.setSelectedRows(o),this.agGridHelper.fireSelectionChangedEvent(),o}}},t.prototype.setValue=function(t){var e,i=this,o=this.api.columnApi.getColumnDataTypeFromColumnId(t.columnId);if(e=o==h.DataType.Number?Number(t.newValue):t.newValue,void 0!=o)if(t.rowNode)t.rowNode.setDataValue(t.columnId,e);else if(this.useRowNodeLookUp){var n=this.gridOptions.api.getRowNode(t.primaryKeyValue);null!=n&&(n.setDataValue(t.columnId,e),t.rowNode=n)}else{var r=!1;this.gridOptions.api.getModel().forEachNode((function(o){r||t.primaryKeyValue==i.getPrimaryKeyValueFromRowNode(o)&&(o.setDataValue(t.columnId,e),t.rowNode=o,r=!0)}))}},t.prototype.cancelEdit=function(){this.gridOptions.api.stopEditing(!0)},t.prototype.getDistinctValuesForColumn=function(t,e){var i=this,o=[],n=this.api.userInterfaceApi.getPermittedValuesForColumn(t);return A.ArrayExtensions.IsNotNull(n)?o=n.map((function(e){return{rawValue:e,displayValue:e,normalisedValue:e,columnId:t.ColumnId,rowNode:void 0}})):e?this.gridOptions.api.forEachNodeAfterFilter((function(e){var n=i.addDistinctColumnValue(e,t.ColumnId);n&&void 0!=n.rawValue&&o.push(n)})):this.gridOptions.api.forEachNode((function(e){var n=i.addDistinctColumnValue(e,t.ColumnId);n&&void 0!=n.rawValue&&o.push(n)})),s.default(o,"displayValue").slice(0,this.adaptableOptions.searchOptions.maxColumnValueItemsDisplayed)},t.prototype.getColumnValueDisplayValuePairList=function(t,e,i){var o=this,n=[],r=new Map,a=this.api.columnApi.getColumnFromId(t),l=this.api.userInterfaceApi.getPermittedValuesForColumn(a);A.ArrayExtensions.IsNotNullOrEmpty(l)?l.forEach((function(e){r.set(e,{rawValue:e,displayValue:e,normalisedValue:e,columnId:t,rowNode:void 0})})):r=null;this.shouldUseRawValueForColumn(a);var s=function(t,e,a){if(t&&!o.isGroupRowNode(t)){var l=o.getGridCellFromRowNode(t,e),s=!r||r.has(l.displayValue);if(s&&i){var u=o.getPrimaryKeyValueFromRowNode(t);s=!!i[u]}s&&n.push(l)}};return e?this.gridOptions.api.forEachNodeAfterFilter((function(e){s(e,t)})):this.gridOptions.api.forEachNode((function(e){s(e,t)})),n.slice(0,this.adaptableOptions.searchOptions.maxColumnValueItemsDisplayed)},t.prototype.addDistinctColumnValue=function(t,e){if(t&&!this.isGroupRowNode(t)){var i=this.getGridCellFromRowNode(t,e);return N.Helper.objectExists(i)?i:void 0}},t.prototype.shouldUseRawValueForColumn=function(t){var e=this.gridOptions.api.getColumnDef(t.ColumnId);return!(!e||null==e.cellRenderer)||!!this.api.columnApi.isFormatNumericStyleColumn(t)},t.prototype.getDisplayValue=function(t,e){var i,o=this;if(this.useRowNodeLookUp){var n=this.gridOptions.api.getRowNode(t),r=this.getGridCellFromRowNode(n,e);r&&(i=r.displayValue)}else{var a=!1;this.gridOptions.api.getModel().forEachNode((function(n){if(!a){var r=o.getGridCellFromRowNode(n,e);r&&t==r.primaryKeyValue&&(i=r.displayValue),a=!0}}))}return i},t.prototype.getGridCellFromRowNode=function(t,e){if(null!=t){var i=this.getPrimaryKeyValueFromRowNode(t),o=this.getRawValueFromRowNode(t,e),n=this.getDisplayValueFromRawValue(e,o),r=this.getNormalisedValueFromRowValue(o,e);this.api.columnApi.getColumnFromId(e);return{rawValue:o,displayValue:n,normalisedValue:r,columnId:e,primaryKeyValue:i,rowNode:t}}},t.prototype.getDisplayValueFromRowNode=function(t,e){var i=this.getGridCellFromRowNode(t,e);return i?i.displayValue:void 0},t.prototype.getDisplayValueFromRawValue=function(t,e){var i=this.api.columnApi.getColumnFromId(t);if(this.api.columnApi.isFormatNumericStyleColumn(i))return this.agGridHelper.getCleanValue(e);if(this.api.columnApi.isActionColumn(t))return this.agGridHelper.getCleanValue(e);var o=this.gridOptions.api.getColumnDef(t);if(o){if("function"==typeof o.valueFormatter){var n=this.gridOptions.columnApi.getAllColumns().find((function(e){return e.getColId()==t})),r=(0,o.valueFormatter)({value:e,node:null,data:null,colDef:o,column:n,api:this.gridOptions.api,columnApi:this.gridOptions.columnApi,context:this.gridOptions.context});return o.cellRenderer?this.agGridHelper.getRenderedValue(o,r):r||""}if(o.cellRenderer)return this.agGridHelper.getRenderedValue(o,e)}return this.agGridHelper.getCleanValue(e)},t.prototype.getNormalisedValueFromRowValue=function(t,e){if(void 0===t||null===t)return t;var i=this.api.columnApi.getColumnDataTypeFromColumnId(e);return"String"===i?"string"!==typeof t?String(t):t:"Number"===i?"number"!==typeof t?Number(t):t:"Boolean"===i?"boolean"!==typeof t?Boolean(t):t:"Date"===i?t instanceof Date?t:new Date(t):t},t.prototype.getRawValueFromRowNode=function(t,e){return this.gridOptions.api.getValue(e,t)},t.prototype.getDataRowFromRowNode=function(t){return null!=t&&void 0!=t?t.data:void 0},t.prototype.getRowNodeForPrimaryKey=function(t){var e=this;if(this.useRowNodeLookUp)return this.gridOptions.api.getRowNode(t);this.gridOptions.api.getModel().forEachNode((function(i){if(t==e.getPrimaryKeyValueFromRowNode(i))return i}))},t.prototype.getRowNodesForPrimaryKeys=function(t){var e=this,i=[];return this.useRowNodeLookUp?t.forEach((function(t){var o=e.gridOptions.api.getRowNode(t);o&&i.push(o)})):t.forEach((function(t){var o=!1;e.gridOptions.api.getModel().forEachNode((function(n){o||t!=e.getPrimaryKeyValueFromRowNode(n)||(i.push(n),o=!0)}))})),i},t.prototype.forAllRowNodesDo=function(t){this.gridOptions.api.getModel().forEachNode((function(e){t(e)}))},t.prototype.forAllVisibleRowNodesDo=function(t){this.gridOptions.api.forEachNodeAfterFilterAndSort((function(e,i){t(e,i)}))},t.prototype.selectNodes=function(t){var e=this;A.ArrayExtensions.IsNotNullOrEmpty(t)&&t.forEach((function(t){return e.selectNode(t)}))},t.prototype.selectNode=function(t){t?t.setSelected(!0,!0):I.LogAdaptableError("No node to select")},t.prototype.isRowNodeVisible=function(t){var e=!1;return this.gridOptions.api.forEachNodeAfterFilter((function(i){i==t&&(e=!0)})),e},t.prototype.redrawBody=function(){this.gridOptions.api.redrawRows(),this._emit("GridRefreshed")},t.prototype.redrawHeader=function(){this.gridOptions.api.refreshHeader()},t.prototype.redrawRow=function(t){var e={rowNodes:[t]};try{this.gridOptions.api.redrawRows(e)}catch(i){I.LogAdaptableError("ag-grid redrawRows was unable to find some row nodes. Tried to redraw row node: ",t,i),console.error(i)}},t.prototype.refreshCells=function(t,e,i){var o={rowNodes:t,columns:e,force:i};this.gridOptions.api.refreshCells(o)},t.prototype.jumpToRow=function(t){this.gridOptions.api.ensureNodeVisible(t,"middle")},t.prototype.jumpToColumn=function(t){this.gridOptions.api.ensureColumnVisible(t)},t.prototype.jumpToCell=function(t,e){this.jumpToRow(e),this.jumpToColumn(t)},t.prototype.getColDefsForSpecialColumns=function(){return o.__spread(this.getColDefsForCalculatedColumns(),this.getColDefsForActionColumns(),this.getColDefsForFreeTextColumns())},t.prototype.getColDefsForFreeTextColumns=function(){var t=this,e=this.api.internalApi.getAdaptableOptions().searchOptions.enableFilterOnSpecialColumns;return this.api.freeTextColumnApi.getAllFreeTextColumn().map((function(i){var o="Number"===i.DataType?Y.AdaptableNumberEditor:"Date"===i.DataType?Y.AdaptableDateEditor:null;return{headerName:i.FriendlyName||i.ColumnId,colId:i.ColumnId,editable:!0,hide:!0,filter:e,sortable:!0,resizable:!0,enableRowGroup:!0,cellEditor:null!==o&&void 0!==o?o:i.TextEditor&&"Large"==i.TextEditor?"agLargeTextCellEditor":"agTextCellEditor",type:[C.AB_SPECIAL_COLUMN,t.agGridHelper.getAgGridDataType(i.DataType)],valueSetter:function(t){return t.data[i.ColumnId]=t.newValue},cellRenderer:i.DataType&&"Boolean"==i.DataType?t.agGridHelper.createCheckboxRendererComp(i.ColumnId,!1):void 0,valueGetter:function(e){return t.api.freeTextColumnApi.getFreeTextColumnValueFromRowNode(i,e.node)}}}))},t.prototype.setupColumnValueGetter=function(t){var e=t.col;this.setColDefProperty(e,"valueGetter",(function(t){return t}))},t.prototype.setupColumnAggFunc=function(t){var e=t.col;this.setColDefProperty(e,"aggFunc",(function(t){return t}))},t.prototype.getColDefsForActionColumns=function(){return this.api.userInterfaceApi.getAllActionColumn().map((function(t){return{headerName:t.friendlyName?t.friendlyName:t.columnId,colId:t.columnId,editable:!1,hide:!1,filter:!1,sortable:!1,resizable:!0,cellRenderer:U.ActionColumnRenderer,type:[C.AB_SPECIAL_COLUMN,"abColDefObject"]}}))},t.prototype.updateColDefsForSpecialColumns=function(){var t=this.getColDefsForSpecialColumns(),e=this.getGroupAndColumnDefs().filter((function(t){var e=t.type;return!(e===C.AB_SPECIAL_COLUMN||Array.isArray(e)&&e.includes(C.AB_SPECIAL_COLUMN))})),i=o.__spread(e,t);this.safeSetColDefs(i),this.setLayout()},t.prototype.getColDefsForCalculatedColumns=function(){var t=this;return this.api.calculatedColumnApi.getAllCalculatedColumn().map((function(e){var i,o=t.CalculatedColumnExpressionService.CleanExpressionColumnNames(null===(i=e.Query)||void 0===i?void 0:i.ScalarExpression);if(!e.CalculatedColumnSettings){var n=!t.adaptableOptions.searchOptions.enableFilterOnSpecialColumns||t.adaptableOptions.searchOptions.enableFilterOnSpecialColumns;e.CalculatedColumnSettings=D.CreateEmptyCalculatedColumn(n).CalculatedColumnSettings}e.CalculatedColumnSettings.DataType||(e.CalculatedColumnSettings.DataType=t.CalculatedColumnExpressionService.GetCalculatedColumnDataType(o));var r={headerName:e.FriendlyName?e.FriendlyName:e.ColumnId,colId:e.ColumnId,hide:!0,editable:!1,width:e.CalculatedColumnSettings.Width,enableValue:e.CalculatedColumnSettings.Aggregatable,filter:e.CalculatedColumnSettings.Filterable,floatingFilter:e.CalculatedColumnSettings.Filterable,resizable:e.CalculatedColumnSettings.Resizable,enableRowGroup:e.CalculatedColumnSettings.Groupable,sortable:e.CalculatedColumnSettings.Sortable,enablePivot:e.CalculatedColumnSettings.Pivotable,type:[C.AB_SPECIAL_COLUMN,t.agGridHelper.getAgGridDataType(e.CalculatedColumnSettings.DataType)],valueGetter:function(e){return t.CalculatedColumnExpressionService.ComputeExpressionValue(o,e.node)}};return null!=e.CalculatedColumnSettings.ShowToolTip&&1==e.CalculatedColumnSettings.ShowToolTip&&(r.tooltipValueGetter=function(){return o}),r}))},t.prototype.isRegularColDef=function(t){return void 0===t.children},t.prototype.isGroupColDef=function(t){return void 0!==t.children},t.prototype.getColDefs=function(){var t=this,e=this.getGroupAndColumnDefs(),i=[];return e.forEach((function(e){t.isRegularColDef(e)&&i.push(e)})),i},t.prototype.getGroupedColDefs=function(){var t=this,e=this.getGroupAndColumnDefs(),i=[];return e.forEach((function(e){t.isGroupColDef(e)&&i.push(e)})),i},t.prototype.getFirstRowNode=function(){var t;return this.gridOptions.api.forEachNode((function(e){e.group||(t=e)})),t},t.prototype.destroy=function(e){var i,o,n,r,a,l;this.gridOptions&&this.gridOptions.api&&(this.gridOptions.api.__adaptable=null,this.gridOptions.api.setColumnDefs=tt,this.gridOptions.getRowStyle=null,e&&!1===e.destroyApi||this.gridOptions.api.destroy()),this.colDefPropertyCache=null,this.gridOptionsPropertyCache=null,this.currentColumnDefs=null,this.rowListeners=null,this.emitter.clearListeners(),this.emitter=null,this._adaptableReady=!1,t.dismissInstance(this);var s=this.getadaptableContainerElement();e&&!e.unmount||(null!=s&&p.unmountComponentAtNode(s),null===(i=this.CalculatedColumnExpressionService)||void 0===i||i.desstroy(),null===(o=this.DataService)||void 0===o||o.desstroy(),null===(n=this.EntitlementService)||void 0===n||n.desstroy(),null===(r=this.ReportService)||void 0===r||r.desstroy(),null===(a=this.ModuleService)||void 0===a||a.desstroy(),null===(l=this.ValidationService)||void 0===l||l.desstroy())},t.prototype.getDefaultIPPStyle=function(){return{Header:{headerColor:"#000000",headerBackColor:"#f5f7f7",headerFontFamily:"sans-serif",headerFontSize:"12px",headerFontStyle:"normal",headerFontWeight:"400",height:65,Columns:this.api.columnApi.getColumns().map((function(t){return{columnFriendlyName:t.FriendlyName,width:200,textAlign:"start"}}))},Row:{color:"#000000",backColor:"#ffffff",altBackColor:"#fcfdfe",fontFamily:"sans-serif",fontSize:"12px",fontStyle:"normal",fontWeight:"400",height:30,Columns:this.api.columnApi.getColumns().map((function(t){return{columnFriendlyName:t.FriendlyName,width:200,textAlign:"start"}}))}}},t.prototype.getCurrentIPPStyle=function(){return this.agGridHelper.getCurrentIPPStyle()},t.prototype.getadaptableContainerElement=function(){if(!this.abContainerElement){var t=this.adaptableOptions.containerOptions.adaptableContainer;if(this.abContainerElement="string"===typeof t?document.getElementById(t):t,!this.abContainerElement){var e=document.getElementById("adaptableBlotter");e&&(I.LogAdaptableWarning('\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!! The old default container element for Adaptable was "#adaptableBlotter", configured via \'containerOptions.adaptableContainer="adaptableBlotter"\'.\n!!!!! Seems like you haven\'t updated your html container selector, so we\'re falling back to using that one.\n!!!!!\n!!!!! To make this warning go away, update your html structure and make sure you have an element with id="adaptable" in your app!\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n'),this.abContainerElement=e)}}return this.abContainerElement},t.prototype.getGridContainerElement=function(){return this.gridContainerElement||(this.gridContainerElement="string"===typeof this.adaptableOptions.containerOptions.vendorContainer?document.getElementById(this.adaptableOptions.containerOptions.vendorContainer):this.adaptableOptions.containerOptions.vendorContainer),this.gridContainerElement},t.prototype.initInternalGridLogic=function(){var e=this;if(null==this.abContainerElement&&(this.abContainerElement=this.getadaptableContainerElement()),null!=this.abContainerElement){var i=this.getGridContainerElement();i&&i.addEventListener("keydown",(function(t){return e._emit("KeyDown",t)}));var r=[n.Events.EVENT_COLUMN_MOVED,n.Events.EVENT_GRID_COLUMNS_CHANGED,n.Events.EVENT_COLUMN_EVERYTHING_CHANGED,n.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,n.Events.EVENT_COLUMN_VISIBLE,n.Events.EVENT_NEW_COLUMNS_LOADED];this.gridOptions.api.addGlobalListener((function(t){r.indexOf(t)>-1&&(e.debouncedSetColumnIntoStore(),e.debouncedFilterGrid())})),this.gridOptions.api.addEventListener(n.Events.EVENT_FIRST_DATA_RENDERED,(function(){e.checkColumnsDataTypeSet(),e.setLayout()})),this.gridOptions.api.addEventListener(n.Events.EVENT_CELL_EDITING_STARTED,(function(t){if(!e.gridOptions.columnApi.isPivotMode()){var i=e.adaptableOptions.editOptions.isCellEditable;if(i)i(e.getGridCellFromRowNode(t.node,t.column.getColId()),t.node)||e.gridOptions.api.stopEditing()}})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(t){"columnPivotModeChanged"==t.type&&null!=t.columnApi&&null!=t.columnApi.columnController&&1==t.columnApi.columnController.pivotMode?(1==e.adaptableOptions.layoutOptions.autoSizeColumnsInPivotLayout&&e.gridOptions.columnApi.autoSizeAllColumns(),e.api.internalApi.setPivotModeOn()):e.api.internalApi.setPivotModeOff()})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_PIVOT_CHANGED,(function(t){"columnPivotChanged"==t.type&&null!=t.columnApi&&null!=t.columnApi.columnController&&1==t.columnApi.columnController.pivotMode&&1==e.adaptableOptions.layoutOptions.autoSizeColumnsInPivotLayout&&e.gridOptions.columnApi.autoSizeAllColumns()}));var a=[n.Events.EVENT_COLUMN_PINNED,n.Events.EVENT_COLUMN_PIVOT_CHANGED,n.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,n.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,n.Events.EVENT_SORT_CHANGED,n.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,n.Events.EVENT_ROW_GROUP_OPENED,n.Events.EVENT_COLUMN_VALUE_CHANGED];this.gridOptions.api.addGlobalListener((function(t){a.indexOf(t)>-1&&e.debouncedSaveGridLayout()})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_RESIZED,(function(t){1==t.finished&&"columnResized"==t.type&&t.column&&(e._emit("ColumnResized",t.column.getColId()),e.debouncedSaveGridLayout())}));var l=[n.Events.EVENT_ROW_GROUP_OPENED,n.Events.EVENT_SELECTION_CHANGED,n.Events.EVENT_ROW_SELECTED];this.gridOptions.api.addGlobalListener((function(t){A.ArrayExtensions.ContainsItem(l,t)&&e.debouncedSetSelectedRows()})),this.gridOptions.api.addEventListener(n.Events.EVENT_RANGE_SELECTION_CHANGED,(function(t){1==t.finished&&e.debouncedSetSelectedCells()})),this.gridOptions.api.addEventListener(n.Events.EVENT_SORT_CHANGED,(function(t){e.onSortChanged(),e.debouncedSetSelectedCells()}));var s=this.adaptableOptions.generalOptions.showGroupingTotalsAsHeader;this.gridOptions.api.addEventListener(n.Events.EVENT_MODEL_UPDATED,(function(t){if(s&&t&&t.api){var e=t.api.getPinnedTopRow(0),i=t.api.getModel().getRootNode();e?e.updateData(i.aggData):t.api.setPinnedTopRowData([i.aggData])}})),this.rowListeners={dataChanged:function(t){e.onRowDataChanged({rowNode:t.node,oldData:t.oldData,newData:t.newData})},cellChanged:function(t){t.column&&e.onCellDataChanged({rowNode:t.node,oldValue:t.oldValue,newValue:t.newValue,colId:t.column.colId})}},Z.dispatchLocalEvent=function(e){var i=e.node,o=$.apply(this,arguments);return i&&t.forEachAdaptable((function(t){if(i.gridApi===t.gridOptions.api){var o=t.rowListeners?t.rowListeners[e.type]:null;o&&o(e)}})),o};var u=this.gridOptions.isExternalFilterPresent;this.gridOptions.isExternalFilterPresent=function(){var t,i,n=e.api.filterApi.getAllColumnFilter(),r=A.ArrayExtensions.IsNotNullOrEmpty(n);if(r)try{for(var a=o.__values(n),l=a.next();!l.done;l=a.next()){var s=l.value,p=e.gridOptions.columnApi.getColumn(s.ColumnId);p&&!p.isFilterActive()&&p.setFilterActive(!0)}}catch(c){t={error:c}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}else(e.gridOptions.columnApi.getAllColumns()||[]).forEach((function(t){t.isFilterActive()&&t.setFilterActive(!1)}));var d=S.StringExtensions.IsNotNullOrEmpty(e.api.queryApi.getCurrentQuery());return r||d||!!u&&u()};var p=this.gridOptions.doesExternalFilterPass;this.gridOptions.doesExternalFilterPass=function(t){var i,n;if(!e.api.internalApi.isServerSearchOptionSet("Query")){var r=e.api.queryApi.getCurrentQuery();if(r)try{if(!e.api.internalApi.getExpressionService().evaluateBooleanExpression(r,t))return!1}catch(d){return I.LogAdaptableError("Invalid query "+r,d),!1}}try{if(!e.api.internalApi.isServerSearchOptionSet("Filter")){var a=e.api.filterApi.getAllColumnFilter();if(a.length>0)try{for(var l=o.__values(a),s=l.next();!s.done;s=l.next()){var u=s.value;if(!e.api.filterApi.evaluateColumnFilter(u,t))return!1}}catch(c){i={error:c}}finally{try{s&&!s.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}}}catch(h){return I.LogAdaptableError(h),!1}return!p||p(t)};var d=this.gridOptions.getMainMenuItems;this.gridOptions.getMainMenuItems=function(t){return e.agGridMenuHelper.buildColumnMenu(t,d)};var c=this.gridOptions.getContextMenuItems;this.gridOptions.getContextMenuItems=function(t){return e.agGridMenuHelper.buildContextMenu(t,c)},this.prepareGrid()}else"string"===typeof this.adaptableOptions.containerOptions.adaptableContainer?I.LogAdaptableError('There is no DIV with id="'+this.adaptableOptions.containerOptions.adaptableContainer+'" so cannot render Adaptable'):I.LogAdaptableError("No valid adaptableContainer found to render Adaptable",this.adaptableOptions.containerOptions.adaptableContainer)},t.prototype.buildStandaloneColumnHeader=function(t){return this.agGridMenuHelper.buildStandaloneColumnHeader(t)},t.prototype.prepareGrid=function(){try{this.updateColDefsForSpecialColumns(),this.applyCurrentTheme(),this.applyFinalRendering(),this.applyGridFiltering()}catch(t){I.LogAdaptableError("AgGrid setup failed"),I.LogAdaptableError(t)}},t.prototype.setupColumns=function(){var t=this,e=this.gridOptions.columnApi.getAllColumns();e.map((function(t){return t.getColDef()})).forEach(X),this.updateColumnsIntoStore(),e.forEach((function(e){var i=e.getColDef(),o=e.getColId(),n={col:e,colDef:i,colId:o,abColumn:t.api.columnApi.getColumnFromId(o)};t.setupColumnCellRenderer(n),t.setupColumnCellStyle(n),t.setupColumnCellClass(n),t.setupColumnTooltipValueGetter(n),t.setupColumnTooltipField(n),t.setupColumnValueGetter(n),t.setupColumnAggFunc(n),t.setupColumnFilter(n),t.setupColumnFloatingFilter(n),t.setupColumnValueFormatter(n),t.setupColumnValueSetter(n),t.setupColumnComparator(n),t.setupColumnCellEditor(n),t.setupColumnHeader(n)})),this.setupRowStyling(),this.redrawBody(),this.redrawHeader()},t.prototype.setGridOptionsProperty=function(t,e){var i="user."+t,o="adaptable."+t,n=this.gridOptions[t];n!==this.gridOptionsPropertyCache.get(o)&&this.gridOptionsPropertyCache.set(i,n);var r=this.gridOptionsPropertyCache.get(i),a=e(r);null!=a&&this.gridOptionsPropertyCache.set(o,a),this.gridOptions[t]=null!==a&&void 0!==a?a:r},t.prototype.setColDefProperty=function(t,e,i){var o=this,n=t.getColId(),r=t.getColDef(),a={col:t,colDef:r,colId:n},l="user."+n+"."+e,s="adaptable."+n+"."+e,u=r[e];u!==this.colDefPropertyCache.get(s)&&this.colDefPropertyCache.set(l,u);var p=this.colDefPropertyCache.get(l),d=i(p);null!=d&&this.colDefPropertyCache.set(s,d);var c=null!==d&&void 0!==d?d:p;this.forPlugins((function(t){t.interceptSetupColumnProperty&&(c=t.interceptSetupColumnProperty(a,e,c,o.api))})),"aggFunc"===e&&r[e]!==(null!==c&&void 0!==c?c:null)&&this.gridOptions.columnApi.setColumnAggFunc(n,null!==c&&void 0!==c?c:null),void 0===c&&void 0===r[e]||(r[e]=c)},t.prototype.setupColumnCellStyle=function(t){var e=this,i=t.col,n=(t.colId,t.abColumn);this.setColDefProperty(i,"cellStyle",(function(t){var i={backgroundColor:null,color:null,fontWeight:null,fontStyle:null,fontSize:null},r=e.api.formatColumnApi.getFormatColumnForColumn(n),a=e.api.conditionalStyleApi.getConditionalStylesForColumn(n),l=e.getQuickSearchCellStyle(),s=void 0!=l;return function(u){var p=r?e.getFormatColumnCellStyle(r,u):void 0,d=s&&e.isQuickSearchActive(n,u);return o.__assign(o.__assign(o.__assign(o.__assign(o.__assign(o.__assign(o.__assign(o.__assign(o.__assign(o.__assign({},i),e.getReadOnlyCellStyle(n,u)),e.getEditableCellStyle(n,u)),"function"===typeof t?t(u):t),p),e.getConditionalStyleCellStyle(a,n,u)),d?l:void 0),e.getAlertCellStyle(n,u)),e.getFlashingAlertCellStyle(n,u)),e.getCellHighlightStyle(n,u))}}))},t.prototype.setupColumnCellClass=function(t){var e=this,i=t.col,o=t.colId,n=t.abColumn;this.setColDefProperty(i,"cellClass",(function(t){var i,r=e.api.formatColumnApi.getFormatColumnWithStyleClassNameForColumn(n),a=r?null===(i=r.Style)||void 0===i?void 0:i.ClassName:null,l=e.api.conditionalStyleApi.getConditionalStylesForColumn(n).filter((function(t){return S.StringExtensions.IsNotNullOrEmpty(t.Style.ClassName)})),s=A.ArrayExtensions.IsNotNullOrEmpty(l),u=e.api.quickSearchApi.getQuickSearchStyle().ClassName,p=S.StringExtensions.IsNotNullOrEmpty(u);return function(i){var r=p&&e.isQuickSearchActive(n,i),d=e.getPrimaryKeyValueFromRowNode(i.node),c=[e.getExcelClassNameForCell(o,d),"function"===typeof t?t(i):t,a,s?e.getConditionalStyleCellClass(l,n,i):null,r?u:null].filter((function(t){return!!t})).join(" ");return S.StringExtensions.IsNotNullOrEmpty(c)?c:void 0}}))},t.prototype.getExcelClassNameForCell=function(t,e){return"--excel-cell-"+t+"-"+e},t.prototype.setupColumnCellEditor=function(t){var e=this,i=t.colId,o=t.col,n=this.api.userInterfaceApi.getEditLookUpItemForColumn(i);this.setColDefProperty(o,"cellEditor",(function(){if(n)return e.isModulePresent("rich-select")?"agRichSelectCellEditor":"agSelectCellEditor"})),this.setColDefProperty(o,"cellEditorParams",(function(){if(n)return{values:e.api.userInterfaceApi.getEditLookUpValuesForEditLookUpItem(n,i)}}))},t.prototype.setupColumnCellRenderer=function(t){var e=this,i=t.col,o=t.colId,n=t.abColumn;this.setColDefProperty(i,"cellRenderer",(function(){var t=e.api.formatColumnApi.getFormatColumnForColumn(n);if(t&&t.ColumnStyle){if(t.ColumnStyle.PercentBarStyle)return e.agGridHelper.createNumericStyleRendererFunc(t);if(t.ColumnStyle.CheckBoxStyle)return e.agGridHelper.createCheckboxRendererComp(n.ColumnId,n.ReadOnly)}var i=e.api.sparklineColumnApi.getSparklineByColumn(o);if(i)return e.agGridHelper.createSparklineCellRendererComp(i)}))},t.prototype.setupColumnTooltipValueGetter=function(t){var e=this,i=t.col,o=t.colId;this.setColDefProperty(i,"tooltipValueGetter",(function(){var t,i=e.api.formatColumnApi.getFormatColumnForColumnId(o);if(i&&i.ColumnStyle&&i.ColumnStyle.PercentBarStyle&&i.ColumnStyle.PercentBarStyle.ToolTipText&&(null===(t=null===i||void 0===i?void 0:i.ColumnStyle)||void 0===t?void 0:t.PercentBarStyle))return function(t){var o=e.api.formatColumnApi.getNumericStyleMinValue(null===i||void 0===i?void 0:i.ColumnStyle,t.node),n=e.api.formatColumnApi.getNumericStyleMaxValue(null===i||void 0===i?void 0:i.ColumnStyle,t.node),r=i.ColumnStyle.PercentBarStyle.ToolTipText,a="";if(r.includes("CellValue"))if(i.DisplayFormat){var l=i.DisplayFormat.Options;a=l?w.default.NumberFormatter(t.value,l):t.value}else a=t.value;r.includes("PercentageValue")&&(a+=" ("+((N.Helper.clamp(t.value,o,n)-o)/(n-o)*100).toFixed(0)+"%)");return a||t.value}}))},t.prototype.setupColumnTooltipField=function(t){var e=this,i=t.col,o=t.colId,n=t.colDef;this.setColDefProperty(i,"tooltipField",(function(){var t=e.api.sparklineColumnApi.getSparklineByColumn(o);if(t)return t.ShowToolTip?n.field:""}))},t.prototype.setupColumnHeader=function(t){var e=this,i=t.col,o=t.abColumn;this.setColDefProperty(i,"headerName",(function(){var t=e.api.formatColumnApi.getFormatColumnForColumnId(o.ColumnId);if(t&&t.HeaderName)return o.FriendlyName=t.HeaderName,t.HeaderName}))},t.prototype.setupColumnFilter=function(t){var e=this,i=t.col,o=t.colDef;this.setColDefProperty(i,"filter",(function(){if(o.filter&&e.adaptableOptions.searchOptions.useAdaptableFilterForm)return e.gridOptions.api.destroyFilter(i),z.FilterWrapperFactory(e)}))},t.prototype.setupColumnFloatingFilter=function(t){var e=this,i=t.col,o=!t.colDef.floatingFilter||!this.adaptableOptions.searchOptions.useAdaptableQuickFilter;this.setColDefProperty(i,"floatingFilterComponent",(function(){if(!o)return j.FloatingFilterWrapperFactory(e)})),this.setColDefProperty(i,"floatingFilterComponentParams",(function(){if(!o)return{suppressFilterButton:!0}}))},t.prototype.setupColumnValueFormatter=function(t){var e=this,i=t.col,o=t.abColumn;this.setColDefProperty(i,"valueFormatter",(function(){var t=e.api.formatColumnApi.getFormatColumnWithDisplayFormatForColumn(o);if(t&&t.DisplayFormat){var i=void 0;if("NumberFormatter"===t.DisplayFormat.Formatter&&e.api.scopeApi.isColumnInNumericScope(o,t.Scope)){var n=t.DisplayFormat.Options;i=function(t){return w.default.NumberFormatter(t.value,n)}}if("DateFormatter"===t.DisplayFormat.Formatter&&e.api.scopeApi.isColumnInDateScope(o,t.Scope)){var r=t.DisplayFormat.Options;i=function(t){return w.default.DateFormatter(t.value,r)}}if("StringFormatter"===t.DisplayFormat.Formatter&&e.api.scopeApi.isColumnInStringsScope(o,t.Scope)){var a=t.DisplayFormat.Options;i=function(t){return w.default.StringFormatter(t.value,a)}}return i}}))},t.prototype.setupColumnValueSetter=function(t){var e=this,i=t.col,o=t.colId,n=t.abColumn;this.setColDefProperty(i,"valueSetter",(function(t){var i,r=e.api.alertApi.getAlertDefinitionsWithPreventEdit().filter((function(t){return e.api.scopeApi.isColumnInScope(n,t.Scope)})),a=e.adaptableOptions.editOptions.isCellEditable,l=!r.length&&!(null===(i=e.adaptableOptions.editOptions)||void 0===i?void 0:i.validateOnServer);if(!l||a){return function(i){var n;if(a){var s=e.getGridCellFromRowNode(i.node,i.column.getColId());if(!a(s,i.node))return!1}var u=i.column.getColDef().field;if(l)return"function"===typeof t?t(i):(u&&(i.data[u]=i.newValue),!0);var p=e.api.internalApi.buildDataChangedInfo({oldValue:i.oldValue,newValue:i.newValue,columnId:i.column.getColId(),primaryKeyValue:e.getPrimaryKeyValueFromRowNode(i.node),rowNode:i.node,trigger:"edit"});if(!r.length)return!0;if(p.oldValue===p.newValue)return!0;if(!e.ValidationService.performValidation(p))return!1;if((null===(n=e.adaptableOptions.editOptions)||void 0===n?void 0:n.validateOnServer)&&e.ValidationService.performServerValidation(p,{onServerValidationCompleted:function(){}})(),"function"===typeof t)return t(i);if(!u)throw"Cannot edit a column without a field - column id was "+o;return i.data[u]=i.newValue,!0}}}))},t.prototype.setupColumnComparator=function(t){var e=this,i=t.col,o=t.colId,n=t.abColumn,r=this.api.customSortApi.getCustomSortByColumn(o),a=this.api.internalApi.getColumnSortComparer(n),l=function(){if(r||a)return a?a.comparer:e.runAdaptableComparerFunction(r.ColumnId,r.SortedValues)};this.setColDefProperty(i,"comparator",l),this.setColDefProperty(i,"pivotComparator",l)},t.prototype.applyCurrentTheme=function(){this.api.themeApi.applyCurrentTheme()},t.prototype.applyFinalRendering=function(){this.embedColumnMenu=this.isModulePresent("menu"),this.gridOptions.defaultGroupSortComparator=this.agGridHelper.runAdaptableNodeComparerFunction(),this.gridOptions.treeData&&1==this.gridOptions.treeData?this.api.internalApi.setTreeModeOn():this.api.internalApi.setTreeModeOff(),this.agGridHelper.checkShouldClearExistingFiltersOrSearches()},t.prototype.isModulePresent=function(t){var e=n.ModuleRegistry.getRegisteredModules().concat(this.agGridModules).map((function(t){return t.moduleName}));return A.ArrayExtensions.ContainsAnyItem(e,["@ag-grid-enterprise/"+t,"@ag-grid-enterprise/all-modules"])},t.prototype.onRowDataChanged=function(t){var e=this,i=t.rowNode,o=t.oldData,n=t.newData;if(null!=o&&void 0!=o&&o!=n){var r=this.getPrimaryKeyValueFromRowNode(i);if(r){var a=[];Object.keys(o).forEach((function(t){if(e.api.columnApi.doesColumnExist(t)){var l=o[t],s=n[t];if(l!=s){var u=e.api.internalApi.buildDataChangedInfo({oldValue:l,newValue:s,columnId:t,primaryKeyValue:r,rowNode:i,trigger:"tick"});a.push(u)}}})),this.performPostEditChecks(a)}}},t.prototype.onCellDataChanged=function(t){var e=t.rowNode,i=t.oldValue,o=t.newValue,n=t.colId;if(i!=o){var r=this.getPrimaryKeyValueFromRowNode(e);if(r&&this.api.columnApi.doesColumnExist(n)){var a=this.api.internalApi.buildDataChangedInfo({oldValue:i,newValue:o,columnId:n,primaryKeyValue:r,rowNode:e,trigger:"edit"});this.performPostEditChecks([a])}}},t.prototype.performPostEditChecks=function(t){var e=this,i=t[0];if(i&&i.rowNode){var o=this.isVisibleNode(i.rowNode);t.forEach((function(t){"edit"==t.trigger&&(e.checkChangedCellCurrentlySelected(t),e.api.freeTextColumnApi.checkFreeTextColumnForDataChange(t)),e.DataService.CreateDataChangedEvent(t)})),o&&this.refreshExpressionStylesIfNeeded(i.rowNode,t),"tick"==i.trigger?this.filterOnTickingDataChange():this.filterOnEditDataChange()}},t.prototype.refreshExpressionStylesIfNeeded=function(t,e){var i=this,o=this.api.conditionalStyleApi.getConditionalStylesWithExpression();if(!A.ArrayExtensions.IsNullOrEmpty(o)){var n=!1,r=!1,a=new Set,l=new Set;e.forEach((function(t){n||o.forEach((function(e){if(!n){i.api.queryApi.getColumnsFromExpression(e.Rule.BooleanExpression).forEach((function(t){return a.add(t)}));var o=a.has(t.columnId);if(i.api.scopeApi.scopeIsAll(e.Scope)){if(o)return void(n=!0)}else i.api.scopeApi.getColumnsForScope(e.Scope).map((function(t){return t.ColumnId})).forEach((function(t){l.add(t)}))}})),a.has(t.columnId)&&(r=!0)})),n?this.redrawRow(t):r&&this.refreshCells([t],Array.from(l.values()),!0)}},t.prototype.checkChangedCellCurrentlySelected=function(t){var e=this.api.gridApi.getSelectedCellInfo();e&&A.ArrayExtensions.IsNotNullOrEmpty(e.gridCells)&&(e.gridCells.find((function(e){return e.primaryKeyValue==t.primaryKeyValue&&e.columnId==t.columnId}))&&this.setSelectedCells());var i=this.api.gridApi.getSelectedRowInfo();i&&A.ArrayExtensions.IsNotNullOrEmpty(i.GridRows)&&(i.GridRows.find((function(e){return e.primaryKeyValue==t.primaryKeyValue}))&&this.setSelectedRows())},t.prototype.getColumnSorts=function(){var t=[];return this.gridOptions.columnApi.getColumnState().forEach((function(e){var i=e.colId;e.sort&&null!=e.sortIndex&&t.push({ColumnId:i,SortOrder:"asc"===e.sort?"Asc":"Desc",SortIndex:e.sortIndex})})),t.sort((function(t,e){return t.SortIndex-e.SortIndex})),t.map((function(t){return{ColumnId:t.ColumnId,SortOrder:t.SortOrder}}))},t.prototype.onSortChanged=function(){var t=this.getColumnSorts();this.api.gridApi.setColumnSorts(t),this._emit("SortChanged",t)},t.prototype.expandAllRowGroups=function(){this.gridOptions.api.forEachNode((function(t){t.group&&(t.expanded=!0)})),this.gridOptions.api.onGroupExpandedOrCollapsed()},t.prototype.closeAllRowGroups=function(){this.gridOptions.api.forEachNode((function(t){t.group&&(t.expanded=!1)})),this.gridOptions.api.onGroupExpandedOrCollapsed()},t.prototype.expandRowGroupsForValues=function(t){if(A.ArrayExtensions.IsNotNullOrEmpty(t)){var e=t.reduce((function(t,e){return t[e]=!0,t}),{});this.gridOptions.api.forEachNode((function(t){if(t.group&&!t.expanded){for(var i=[],o=t;o;)i.push(o.key),o=o.parent;var n=i.filter((function(t){return!!t})).reverse().join("/");e[n]&&t.setExpanded(!0)}})),this.gridOptions.api.onGroupExpandedOrCollapsed()}},t.prototype.getVendorGridColumnFieldForColumn=function(t){return this.gridOptions.columnApi.getAllColumns().find((function(e){return e.getColId()===t.ColumnId})).getColDef().field||""},t.prototype.getExpandRowGroupsKeys=function(){var t=[];return this.adaptableOptions.layoutOptions.includeExpandedRowGroups&&this.gridOptions.api.forEachNode((function(e){if(e.group&&e.expanded){for(var i=e,o=[];i;)o.push(i.key),i=i.parent;t.push(o.filter((function(t){return!!t})).reverse().join("/"))}})),t},t.prototype.getRowCount=function(){return this.gridOptions.rowData?this.gridOptions.rowData.length:this.gridOptions.api.getDisplayedRowCount()},t.prototype.getColumnCount=function(){return this.gridOptions.columnApi.getAllColumns().length},t.prototype.getVisibleRowCount=function(){return this.gridOptions.api.getDisplayedRowCount()},t.prototype.getVisibleColumnCount=function(){return this.gridOptions.columnApi.getAllColumns().filter((function(t){return t.isVisible()})).length},t.prototype.selectColumns=function(t){var e=this;t.forEach((function(t){return e.selectColumn(t)}))},t.prototype.selectColumn=function(t){this.gridOptions.api.clearRangeSelection();var e={rowStartIndex:0,rowEndIndex:this.gridOptions.api.getDisplayedRowCount(),columnStart:t,columnEnd:t};this.gridOptions.api.addCellRange(e)},t.prototype.selectAll=function(){this.gridOptions.api.selectAll()},t.prototype.hideColumn=function(t){this.gridOptions.columnApi.getColumn(t)&&(this.gridOptions.columnApi.setColumnVisible(t,!1),this.updateColumnsIntoStore())},t.prototype.showColumn=function(t){this.gridOptions.columnApi.getColumn(t)&&(this.gridOptions.columnApi.setColumnVisible(t,!0),this.updateColumnsIntoStore())},t.prototype.setColumnSort=function(t){var e=t.reduce((function(t,e,i){return t[e.ColumnId]=o.__assign(o.__assign({},e),{SortIndex:i}),t}),{});if(this.gridOptions.api){var i=this.gridOptions.columnApi.getColumnState().map((function(t){var i=t.colId,n=o.__assign({},t),r=e[i];return r?(n.sort="Asc"===r.SortOrder?"asc":"desc",n.sortIndex=r.SortIndex):(n.sort=null,n.sortIndex=null),n}));this.gridOptions.columnApi.setColumnState(i),this.gridOptions.api.onSortChanged()}},t.prototype.setDataSource=function(t){this.gridOptions.api&&(this.hasAutogeneratedPrimaryKey()&&this.addSyntheticPrimaryKey(t),this.gridOptions.api.setRowData(t))},t.prototype.loadDataSource=function(t){this.hasAutogeneratedPrimaryKey()&&this.addSyntheticPrimaryKey(t),this.setDataSource(t)},t.prototype.updateRows=function(t,e){this.hasAutogeneratedPrimaryKey()&&this.addSyntheticPrimaryKeyIfMissing(t),(e=e||{}).runAsync?this.gridOptions.api.applyTransactionAsync({update:t},e.callback):this.gridOptions.api.applyTransaction({update:t})},t.prototype.addRows=function(t,e){this.hasAutogeneratedPrimaryKey()&&this.addSyntheticPrimaryKey(t),(e=e||{}).runAsync?this.gridOptions.api.applyTransactionAsync({add:t},e.callback):this.gridOptions.api.applyTransaction({add:t})},t.prototype.deleteRows=function(t,e){(e=e||{}).runAsync?this.gridOptions.api.applyTransactionAsync({remove:t},e.callback):this.gridOptions.api.applyTransaction({remove:t})},t.prototype.getFirstGroupedColumn=function(){var t=this.gridOptions.columnApi.getRowGroupColumns();if(A.ArrayExtensions.IsNotNullOrEmpty(t)){var e=t[0];return this.api.columnApi.getColumnFromId(e.getColId())}},t.prototype.checkColumnsDataTypeSet=function(){var t=this.api.columnApi.getColumns()[0];t&&t.DataType==h.DataType.Unknown&&this.updateColumnsIntoStore()},t.prototype.runAdaptableComparerFunction=function(t,e){var i=this;return function(o,n,r,a){var l=r?i.getDisplayValueFromRowNode(r,t):o,s=a?i.getDisplayValueFromRowNode(a,t):n,u=e.indexOf(l),p=u>=0,d=e.indexOf(s),c=d>=0;return p||c?p?c?u-d:-1:1:o==n?0:o<n?-1:1}},t.prototype.isGridSelectable=function(){return!(!this.isModulePresent("range-selection")||null==this.gridOptions.enableRangeSelection||!this.gridOptions.enableRangeSelection)},t.prototype.isGridGroupable=function(){return!this.api.internalApi.isGridInTreeMode()},t.prototype.isGridGroupingActive=function(){var t=!1;return this.gridOptions.api.forEachNode((function(e){t||e.group&&(t=!0)})),t},t.prototype.isGridPivotable=function(){return!this.api.internalApi.isGridInTreeMode()},t.prototype.isQuickFilterAvailable=function(){return!0===this.hasFloatingFilterOnAtLeastOneColumn()},t.prototype.hasFloatingFilterOnAtLeastOneColumn=function(t){var e,i,n;if(void 0===t&&(t=this.gridOptions.columnDefs),this.gridOptions.defaultColDef&&this.gridOptions.defaultColDef.floatingFilter)return!0;try{for(var r=o.__values(t),a=r.next();!a.done;a=r.next()){if((n=a.value).floatingFilter)return!0;if(n.children&&this.hasFloatingFilterOnAtLeastOneColumn(n.children))return!0}}catch(l){e={error:l}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}return!1},t.prototype.showQuickFilter=function(){this.gridOptions.api.setFloatingFiltersHeight(null)},t.prototype.hideQuickFilter=function(){this.gridOptions.api.setFloatingFiltersHeight(0)},t.prototype.getVendorColumnType=function(t){var e;return(null!==(e=this.gridOptions.api.getColumnDef(t))&&void 0!==e?e:{}).type||""},t.prototype.getVendorGridLightThemeName=function(){var t=this.getGridContainerElement();if(t&&t.classList)for(var e=t.classList,i=0,o=e.length;i<o;i++){var n=e[i];if(0===n.indexOf("ag-theme-"))return n.replace("-dark","")}return this.agGridHelper.getVendorLightThemeName()},t.prototype.getVendorGridCurrentThemeName=function(){var t=this.getGridContainerElement();if(t&&t.classList)for(var e=t.classList,i=0,o=e.length;i<o;i++){var n=e[i];if(0===n.indexOf("ag-theme-"))return n}return this.getVendorGridLightThemeName()},t.prototype.applyAdaptableTheme=function(t){var e=this,i="string"===typeof t?t:t.Name,n=[],r=[],a=this.api.themeApi.getAllTheme().map((function(t){return o.__assign({},t)})).reduce((function(t,e){return t[e.Name]=e,t}),{}),l=document.documentElement;l.classList.forEach((function(t){if(0===t.indexOf(g.THEME_STYLE)){n.push(t);var e=t.substring(g.THEME_STYLE.length);a[e]&&r.push(a[e])}})),n.forEach((function(t){return l.classList.remove(t)})),this.adaptableOptions.userInterfaceOptions&&this.adaptableOptions.userInterfaceOptions.useCustomMacLikeScrollbars&&E.default()>0?l.classList.add("ab--custom-mac-like-scrollbars"):l.classList.remove("ab--custom-mac-like-scrollbars");var s=a[i],u=g.THEME_STYLE+i;l.classList.add(u);var p=getComputedStyle(l),d=o.__read(["--ab-loaded","--ab-theme-loaded"].map((function(t){var e=p.getPropertyValue(t);return"string"===typeof e&&e.trim&&(e=e.trim()),e})),2),c=d[0],h=d[1],f=!!this.api.themeApi.getAllSystemTheme().filter((function(t){return t.Name===i}))[0],m=this.getGridContainerElement(),y=function(){return e.getVendorGridLightThemeName()};if(s&&f&&(i===C.LIGHT_THEME&&(s.VendorGridClassName=s.VendorGridClassName||y()),i===C.DARK_THEME&&(s.VendorGridClassName=s.VendorGridClassName||y()+"-dark")),s.VendorGridClassName||(s.VendorGridClassName=y()),null!=m){r.length&&r.forEach((function(t){t.VendorGridClassName&&m.classList.remove(t.VendorGridClassName)}));var v=[];m.classList.forEach((function(t){t&&0===t.indexOf("ag-theme-")&&v.push(t)})),v.forEach((function(t){return m.classList.remove(t)})),s&&s.VendorGridClassName&&m.classList.add(s.VendorGridClassName),m.classList.add("ab-Grid"),this.adaptableOptions.searchOptions.indicateFilteredColumns&&m.classList.add("ab-Grid--indicate-filtered-columns")}"777"!==c&&I.ConsoleLogError('Please import Adaptable styles from "adaptableadaptable/index.css"'),h!==i&&I.ConsoleLogWarning('Theme "'+i+'" doesn\'t seem to be loaded! Make sure you import the css file for the "'+i+'" theme!\n\nIf it\'s a default theme, try\n\nimport "@adaptabletools/adaptable/themes/'+i+'.css"')},t.prototype.setupRowStyling=function(){var t=this,e=this.api.conditionalStyleApi.getRowConditionalStyles();this.setGridOptionsProperty("getRowStyle",(function(i){return function(n){return o.__assign(o.__assign({},null===i||void 0===i?void 0:i(n)),t.getConditionalStyleRowStyle(e,n))}})),this.setGridOptionsProperty("getRowClass",(function(i){return function(o){var n=["function"===typeof i?i(o):i,t.getConditionalStyleRowClass(e.filter((function(t){return S.StringExtensions.IsNotNullOrEmpty(t.Style.ClassName)})),o)].filter((function(t){return!!t})).join(" ");return S.StringExtensions.IsNotNullOrEmpty(n)?n:void 0}}))},t.prototype.getConditionalStyleRowClass=function(t,e){if(A.ArrayExtensions.IsNotNullOrEmpty(t)){var i=this.ModuleService.getModuleById(y.ConditionalStyleModuleId);return t.map((function(t){var o;if(i.isConditionalStyleActiveForRow(t,e))return null===(o=t.Style)||void 0===o?void 0:o.ClassName})).filter((function(t){return!!t})).join(" ")}},t.prototype.getConditionalStyleRowStyle=function(t,e){if(A.ArrayExtensions.IsNotNullOrEmpty(t)){var i=this.ModuleService.getModuleById(y.ConditionalStyleModuleId),o=t.find((function(t){return i.isConditionalStyleActiveForRow(t,e)}));if(o)return this.convertAdaptableStyleToCSS(o.Style)}},t.prototype.getGridOptionsApi=function(){if(this.gridOptions.api)return this.gridOptions.api;I.LogAdaptableError("There is a problem with your instance of ag-Grid - it has no gridApi object.  Please contact Support.")},t.prototype.canExportToExcel=function(){return this.isModulePresent("excel-export")},t.prototype.exportToExcel=function(t,e){var i={columnDefs:t.columns.map((function(t){return{field:t.ColumnId,headerName:t.FriendlyName}})),rowData:t.rows},o=new n.Grid(document.createElement("div"),i);i.api.exportDataAsExcel({sheetName:"Sheet 1",fileName:e}),o.destroy()},t.prototype.setExcelStylesForExport=function(){var t=this;this.setGridOptionsProperty("excelStyles",(function(e){var i=[],n=t.gridOptions.columnApi.getAllDisplayedColumns(),r=n.map((function(t){return t.getColDef()}));return t.forAllVisibleRowNodesDo((function(e,a){var l={node:e,data:e.data,rowIndex:a,$scope:{},api:t.gridOptions.api,columnApi:t.gridOptions.columnApi,context:{}},s=t.gridOptions.getRowStyle(l);n.forEach((function(n,l){var u=r[l],p={colDef:u,node:e,data:e.data,value:t.getRawValueFromRowNode(e,n.getId()),rowIndex:a,$scope:{},api:t.gridOptions.api,columnApi:t.gridOptions.columnApi,context:{}},d="function"===typeof u.cellStyle?u.cellStyle(p):{},c=o.__assign(o.__assign({},s),Object.keys(d).reduce((function(t,e){return null!==d[e]&&(t[e]=d[e]),t}),{}));i.push(o.__assign({id:t.getExcelClassNameForCell(n.getId(),t.getPrimaryKeyValueFromRowNode(e))},t.convertCSSToExcelStyle(c)))}))})),o.__spread(null!==e&&void 0!==e?e:[],i)}))},t.prototype.exportVisibleDataToClipboard=function(){var t=this.getGridOptionsApi();t.selectAllFiltered(),t.copySelectedRowsToClipboard(!0),t.deselectAll()},t.prototype.exportVisibleDataToExcel=function(){this.adaptableOptions.exportOptions.exportToExcelWithStyles&&this.setExcelStylesForExport(),this.gridOptions.api.exportDataAsExcel({sheetName:"Sheet 1",fileName:C.VISIBLE_DATA_REPORT}),this.setGridOptionsProperty("excelStyles",(function(t){return t}))},t.prototype.exportVisibleDataToCsv=function(){this.gridOptions.api.exportDataAsCsv({fileName:C.VISIBLE_DATA_REPORT})},t.prototype.convertAdaptableStyleToCSS=function(t){return q.convertAdaptableStyleToCSS(t)},t.prototype.convertCSSToExcelStyle=function(t){var e=function(t){var e=J(t),i=e.getAlpha();return J.mix(J("white"),e,100*i).toHexString()},i={};return i.interior=i.interior||{},i.font=i.font||{},i.alignment=i.alignment||{},null!=t.backgroundColor&&(i.interior.pattern="solid",i.interior.color=e(t.backgroundColor)),null!=t.color&&(i.font.color=e(t.color)),i.alignment.horizontal=t.textAlign?S.StringExtensions.CapitaliseFirstLetter(t.textAlign):"Left","italic"===t.fontStyle&&(i.font.italic=!0),null!=t.fontWeight&&("bold"===t.fontWeight||Number(t.fontWeight)>=600)&&(i.font.bold=!0),i},t.prototype.hasAutogeneratedPrimaryKey=function(){return this.adaptableOptions.autogeneratePrimaryKey},t.prototype.addSyntheticPrimaryKey=function(t){void 0===t&&(t=[]);for(var e=0;e<t.length;e++)t[e][C.AUTOGENERATED_PK_COLUMN]=f.createUuid()},t.prototype.addSyntheticPrimaryKeyIfMissing=function(t){void 0===t&&(t=[]),this.adaptableOptions.primaryKey=C.AUTOGENERATED_PK_COLUMN;for(var e=0;e<t.length;e++)t[e][C.AUTOGENERATED_PK_COLUMN]||(t[e][C.AUTOGENERATED_PK_COLUMN]=f.createUuid())},t}();e.Adaptable=ot;var nt=function(){function t(t,e){var i=this;void 0===e&&(e={});this.adaptableOptions=t,this.init=e.onInit||function(t){var e=t.gridOptions,n=t.adaptableOptions;return o.__awaiter(i,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return n.vendorGrid=e,[4,ot.init(n)];case 1:return[2,t.sent()]}}))}))},this.extraOptions=e,this.render()}return t.prototype.render=function(t){var e,i=this,n=v.DefaultAdaptableOptions.containerOptions.adaptableContainer||"adaptable";if(!t){var r=null===(e=this.adaptableOptions.containerOptions)||void 0===e?void 0:e.adaptableContainer;r&&("string"===typeof r?n=null!==r&&void 0!==r?r:n:t=r)}if(!(t=t||document.getElementById(n)))throw new Error("Cannot find container in which to render Adaptable No Code Wizard");t.classList.add("adaptable--in-wizard"),p.render(u.createElement(k.default,o.__assign(o.__assign({adaptableOptions:this.adaptableOptions},this.extraOptions),{onInit:function(e){t.classList.remove("adaptable--in-wizard"),p.unmountComponentAtNode(t),i.init({adaptableOptions:e,gridOptions:e.vendorGrid})}})),t)},t}();e.AdaptableNoCodeWizard=nt}}]);
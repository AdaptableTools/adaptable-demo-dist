(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{ydiI:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("mrSG"),n=i("DR3G"),r=i("i8i4"),a=i("q1tI"),l=i("LvDl"),s=i("F9nB"),u=i("QIb0"),p=i("7VOM"),d=i("MbTd"),c=i("nWPU"),h=i("0J2a"),m=i("6aYJ"),g=i("+UTi"),f=i("5wQp"),C=i("7Sag"),y=i("KOcV"),v=i("SF8o"),E=i("u3yE"),O=i("UQRY"),S=i("adxL"),A=i("CUPq"),N=i("YKwl"),b=i("RQz/"),I=i("UtRb"),w=i("MjQ7"),D=i("txn5"),R=i("pBDx"),F=i("qN6A"),V=i("zwJd"),G=i("z1Bd"),x=i("ojqC"),L=i("EYOP"),P=i("fwGq"),_=i("pioK"),T=i("n6u+"),H=i("kVrw"),M=i("W07B"),k=i("w5Eo"),U=i("yRSI"),Q=i("j9Nh"),B=i("vk8B"),K=i("lg1K"),W=i("+0VI"),z=i("MXaM"),q=i("OwXO"),Y=i("2WK/"),j=i("SXdp"),J=i("02Nn"),X=i("U/tm"),Z=i("DR3G"),$=i("vs66"),ee=i("1f9d");Z.ModuleRegistry.registerModules(Z.AllCommunityModules);var te=n.RowNode.prototype,ie=te.dispatchLocalEvent,oe=function(e,t,i){e.forEach((function(e,o,n){e.children?oe(e.children,t,e):t(e,o,n,i)}))},ne={},re=function(){function e(t,i,n,a){var p=this;if((void 0===i&&(i=!0),this.calculatedColumnPathMap=new Map,this.originalColDefValueFormatters={},this._on=function(e,t){return p.emitter.on(e,t)},this._emit=function(e,t){return p.emitter.emit(e,t)},this.isPluginLoaded=function(e){for(var t=p.adaptableOptions.plugins||[],i=0,o=t.length;i<o;i++){if(t[i].pluginId===e)return!0}return!1},this.debouncedSetColumnIntoStore=l.debounce((function(){p.gridOptions.api&&p.setColumnIntoStore()}),P.HALF_SECOND),this.debouncedSaveGridLayout=l.debounce((function(){p.gridOptions.api&&p.saveGridLayout()}),P.HALF_SECOND),this.debouncedSetSelectedCells=l.debounce((function(){p.gridOptions.api&&p.setSelectedCells()}),250),this.debouncedSetSelectedRows=l.debounce((function(){p.gridOptions.api&&p.setSelectedRows()}),P.HALF_SECOND),this.debouncedFilterGrid=l.debounce((function(){p.gridOptions.api&&p.applyGridFiltering()}),P.HALF_SECOND),this.mapColumnDefs=function(e,t){t=t||{removeEmpty:!1};var i=o.__spread(p.getColumnDefs());return oe(i,(function(i,o,n,r){var a=e(i,o,n),l=r?r.children:n;l[o]=a,o===n.length-1&&t.removeEmpty&&r&&(r.children=l.filter((function(e){return!!e})))})),t.removeEmpty&&(i=i.filter((function(e){return!!e}))),i},this.getColumnDefs=function(){return p.gridOptions.columnApi.columnController.columnDefs||[]},a||R.LoggingHelper.LogAdaptableWarning('\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!!! You should not use the "Adaptable" constructor directly, as it is deprecated and will not work in a future version!\n!!!!!!!\n!!!!!!! Use Adaptable.init(adaptableOptions) instead.\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'),this.emitter=new s.default,this.renderGrid=i,this.adaptableOptions=X.default.assignadaptableOptions(t),e.collectInstance(this),X.default.CheckadaptableOptions(this.adaptableOptions),this.runtimeConfig=n,this.gridOptions=this.adaptableOptions.vendorGrid,void 0===this.gridOptions.allowContextMenuWithControlKey&&(this.gridOptions.allowContextMenuWithControlKey=!0),this.vendorGridName="agGrid",this.embedColumnMenu=!0,this.isInitialised=!1,this.useRowNodeLookUp=!1,this.forPlugins((function(e){return e.afterInitOptions(p,p.adaptableOptions)})),this.api=new L.AdaptableApiImpl(this),this.forPlugins((function(e){return e.afterInitApi(p,p.api)})),this.DataService=new y.DataService(this),this.AuditLogService=new g.AuditLogService(this),this.initStore(),this.agGridHelper=new _.agGridHelper(this,this.gridOptions),this.CalendarService=new C.CalendarService(this),this.ValidationService=new v.ValidationService(this),this.StyleService=new f.StyleService(this),this.ChartService=new E.ChartService(this),this.FreeTextColumnService=new O.FreeTextColumnService(this),this.ScheduleService=new H.ScheduleService(this),this.SearchService=new M.SearchService(this),this.Glue42Service=new K.Glue42Service(this),this.PushPullService=new z.PushPullService(this),this.ReportService=new W.ReportService(this),this.LayoutService=new Y.LayoutService(this),this.FilterService=new j.FilterService(this),this.StrategyService=new q.StrategyService(this),this.CalculatedColumnExpressionService=new S.CalculatedColumnExpressionService(this,(function(e,t){return p.gridOptions.api.getValue(e,t)})),this.forPlugins((function(e){return e.afterInitServices(p)})),!(this.gridOptions.api&&"function"===typeof this.gridOptions.api.getValue))&&!this.tryInstantiateAgGrid())return void R.LoggingHelper.LogAdaptableError("Unable to set up ag-Grid");this.gridOptions.api&&(this.gridOptions.api.__adaptable=this),this.strategies=this.agGridHelper.setUpStrategies(),this.forPlugins((function(e){return e.afterInitStrategies(p,p.strategies)})),this.AdaptableStore.Load.then((function(){return p.strategies.forEach((function(e){return e.initializeWithRedux()}))}),(function(e){R.LoggingHelper.LogAdaptableError("Failed to Init AdaptableStore : ",e),p.strategies.forEach((function(e){return e.initializeWithRedux()})),p.api.internalApi.hideLoadingScreen()})).then((function(){return p.initInternalGridLogic()}),(function(e){R.LoggingHelper.LogAdaptableError("Failed to Init Strategies : ",e),p.initInternalGridLogic(),p.api.internalApi.hideLoadingScreen()})).then((function(){return o.__awaiter(p,void 0,void 0,(function(){return o.__generator(this,(function(e){return this.applyFinalRendering(),this.isInitialised=!0,this.api.internalApi.hideLoadingScreen(),[2]}))}))})),i&&(null==this.abContainerElement&&(this.abContainerElement=this.getadaptableContainerElement()),null!=this.abContainerElement&&(this.abContainerElement.innerHTML="",r.render(u.AdaptableApp({Adaptable:this}),this.abContainerElement))),this.throttleOnDataChangedUser=l.throttle(this.applyDataChange,this.adaptableOptions.filterOptions.filterActionOnUserDataChange.ThrottleDelay),this.throttleOnDataChangedExternal=l.throttle(this.applyDataChange,this.adaptableOptions.filterOptions.filterActionOnExternalDataChange.ThrottleDelay)}return e.init=function(t){var i={renderGrid:void 0,runtimeConfig:null};Array.isArray(t.plugins)&&t.plugins.forEach((function(e){e.beforeInit(t,i)}));var o=new e(t,i.renderGrid,i.runtimeConfig,!0);return Array.isArray(t.plugins)&&t.plugins.forEach((function(e){e.afterInit(o)})),o.api},e.initLazy=function(t){var i,n;return o.__awaiter(this,void 0,void 0,(function(){var r,a,l,s,u;return o.__generator(this,(function(p){switch(p.label){case 0:if(r={renderGrid:void 0,runtimeConfig:null},!Array.isArray(t.plugins))return[3,13];p.label=1;case 1:p.trys.push([1,7,8,13]),a=o.__asyncValues(t.plugins),p.label=2;case 2:return[4,a.next()];case 3:return(l=p.sent()).done?[3,6]:[4,l.value.beforeInit(t,r)];case 4:p.sent(),p.label=5;case 5:return[3,2];case 6:return[3,13];case 7:return s=p.sent(),i={error:s},[3,13];case 8:return p.trys.push([8,,11,12]),l&&!l.done&&(n=a.return)?[4,n.call(a)]:[3,10];case 9:p.sent(),p.label=10;case 10:return[3,12];case 11:if(i)throw i.error;return[7];case 12:return[7];case 13:return u=new e(t,r.renderGrid,r.runtimeConfig,!0),Array.isArray(t.plugins)&&t.plugins.forEach((function(e){e.afterInit(u)})),[2,u.api]}}))}))},e.collectInstance=function(e){e._id=e.adaptableOptions.adaptableId||k.createUuid(),ne[e._id]=e},e.forEachAdaptable=function(e){Object.keys(ne).forEach((function(t){e(ne[t])}))},e.dismissInstance=function(e){delete ne[e._id]},e.prototype.forPlugins=function(e){Array.isArray(this.adaptableOptions.plugins)&&this.adaptableOptions.plugins.forEach((function(t){e(t)}))},e.prototype.lookupPlugins=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var n=this.adaptableOptions.plugins||[],r=0,a=n.length;r<a;r++){var l=n[r];if(l.hasProperty(e))return l.getProperty(e).apply(void 0,o.__spread(t))}},e.prototype.initStore=function(){var e=this;this.AdaptableStore=new h.AdaptableStore(this),this.AdaptableStore.onAny((function(t,i){e.forPlugins((function(o){return o.onStoreEvent(t,i,e.AdaptableStore)})),t==h.INIT_STATE&&(e.forPlugins((function(t){return t.onAdaptableReady(e,e.adaptableOptions)})),e.api.eventApi.emit("AdaptableReady",{adaptableApi:e.api,vendorGrid:e.adaptableOptions.vendorGrid}))}))},e.prototype.tryInstantiateAgGrid=function(){var e=this.getGridContainerElement();if(!e)return R.LoggingHelper.LogAdaptableError("You must provide an element id in `containerOptions.vendorContainer`"),!1;if(this.useRowNodeLookUp=this.agGridHelper.TrySetUpNodeIds(),this.adaptableOptions.userInterfaceOptions.showAdaptableToolPanel&&(R.LoggingHelper.LogAdaptableInfo("Adding Adaptable Tool Panel"),this.gridOptions.sideBar=this.gridOptions.sideBar||{},this.gridOptions.components=this.gridOptions.components||{},this.gridOptions.sideBar)){var t=this.gridOptions.sideBar;if(!0===t)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!0,!0);else if("columns"===t)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!1,!0);else if("filters"===t)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!0,!1);else{var i=this.gridOptions.sideBar;i&&(i.toolPanels=i.toolPanels||[],i.toolPanels.push(this.agGridHelper.createAdaptableToolPanel()))}var o={Adaptable:this};this.gridOptions.components.AdaptableToolPanel=T.AdaptableToolPanelBuilder(o)}var r=(this.adaptableOptions.vendorGrid||{}).modules||[];return delete this.gridOptions.modules,null!=(this.runtimeConfig&&this.runtimeConfig.instantiateGrid?this.runtimeConfig.instantiateGrid(e,this.gridOptions,{modules:r}):new n.Grid(e,this.gridOptions,{modules:r}))},e.prototype.filterOnUserDataChange=function(e){this.adaptableOptions.filterOptions.filterActionOnUserDataChange.RunFilter==b.FilterOnDataChangeOptions.Always?this.applyDataChange(e):this.adaptableOptions.filterOptions.filterActionOnUserDataChange.RunFilter==b.FilterOnDataChangeOptions.Throttle&&this.throttleOnDataChangedUser(e)},e.prototype.filterOnExternalDataChange=function(e){this.adaptableOptions.filterOptions.filterActionOnExternalDataChange.RunFilter==b.FilterOnDataChangeOptions.Always?this.applyDataChange(e):this.adaptableOptions.filterOptions.filterActionOnExternalDataChange.RunFilter==b.FilterOnDataChangeOptions.Throttle&&this.throttleOnDataChangedExternal(e)},e.prototype.createFilterWrapper=function(e){this.gridOptions.api.destroyFilter(e),this.gridOptions.api.getColumnDef(e).filter=A.FilterWrapperFactory(this),e.initialise()},e.prototype.createQuickFilterWrapper=function(e){var t=this.gridOptions.api.getColumnDef(e);t&&(t.floatingFilterComponentParams={suppressFilterButton:!1},t.floatingFilterComponent=N.FloatingFilterWrapperFactory(this))},e.prototype.reloadGrid=function(){this._emit("GridReloaded")},e.prototype.applyGridFiltering=function(){this.gridOptions.api.onFilterChanged(),this._emit("SearchApplied"),this._emit("GridFiltered"),this.setSelectedCells(),this.setSelectedRows()},e.prototype.applyDataChange=function(e){var t=this;if(this.gridOptions.api){var i=e.filter((function(e){return!t.isGroupRowNode(e)})).filter((function(e){return t.isDataInModel(e)})).map((function(e){return e.data}));V.ArrayExtensions.IsNotNullOrEmpty(i)&&this.gridOptions.api.updateRowData({update:i})}},e.prototype.isGroupRowNode=function(e){return!!e&&(!!e.isEmptyRowGroupNode()||(!(!e.group||!0!==e.group)||!(!e.leafGroup||!0!==e.leafGroup)))},e.prototype.isDataInModel=function(e){if(!e)return!1;var t=e.data[this.adaptableOptions.primaryKey];return!!t&&!!this.getRowNodeForPrimaryKey(t)},e.prototype.isPinnedRowNode=function(e){return!!e&&!!e.isRowPinned()},e.prototype.clearGridFiltering=function(){this.gridOptions.columnApi.getAllColumns().forEach((function(e){e.setFilterActive(!1)}))},e.prototype.clearColumnFiltering=function(e){var t=this;e.forEach((function(e){var i=t.gridOptions.columnApi.getAllColumns().find((function(t){return t.getColId()==e}));i&&i.setFilterActive(!1)}))},e.prototype.hideFilterForm=function(){this.hideFilterFormPopup&&this.hideFilterFormPopup()},e.prototype.setNewColumnListOrder=function(e){var t=this,i=this.gridOptions.columnApi.getAllGridColumns(),o=e.map((function(e){return e.ColumnId})),n=o.reduce((function(e,t){return e[t]=!0,e}),{});i.forEach((function(e){n[e.getColId()]||t.setColumnVisible(e,!1)})),this.setColumnIntoStore(),requestAnimationFrame((function(){return t.setColumnOrder(o)}))},e.prototype.setColumnIntoStore=function(){var e=this;if(!this.gridOptions.columnApi.isPivotMode()||!V.ArrayExtensions.IsNotNullOrEmpty(this.gridOptions.columnApi.getPivotColumns())){var t=[],i=this.api.gridApi.getColumns();this.gridOptions.columnApi.getAllGridColumns().forEach((function(o){var n=o.getColId();if(!w.ColumnHelper.isSpecialColumn(n)){var r=w.ColumnHelper.getColumnFromId(n,i);r?(r.Visible=o.isVisible(),r.DataType==b.DataType.Unknown&&(r.DataType=e.agGridHelper.getColumnDataType(o))):r=e.createAdaptableColumn(o),t.push(r)}})),this.api.internalApi.setColumns(t),this.LayoutService.autoSaveLayout()}},e.prototype.createAdaptableColumn=function(e){var t=this.agGridHelper.createAdaptableColumnFromVendorColumn(e);return this.applyStylingToColumn(e,t),t},e.prototype.applyStylingToColumn=function(e,t){e.getColDef().filter&&this.adaptableOptions.filterOptions.useAdaptableFilterForm&&this.createFilterWrapper(e),this.isQuickFilterActive()&&this.createQuickFilterWrapper(e);var i=this.getQuickSearchClassName();null==t&&(t=w.ColumnHelper.getColumnFromId(e.getColId(),this.api.gridApi.getColumns())),t&&this.addQuickSearchStyleToColumn(t,i)},e.prototype.safeSetColDefs=function(e){var t=this;this.gridOptions.api.setColumnDefs([]),this.gridOptions.api.setColumnDefs(e),this.gridOptions.columnApi.getAllGridColumns().forEach((function(e){var i=w.ColumnHelper.getColumnFromId(e.getColId(),t.api.gridApi.getColumns());t.applyStylingToColumn(e,i)})),this.redraw()},e.prototype.getQuickSearchClassName=function(){return F.StringExtensions.IsNotNullOrEmpty(this.api.quickSearchApi.getQuickSearchStyle().ClassName)?this.api.quickSearchApi.getQuickSearchStyle().ClassName:this.StyleService.CreateStyleName(p.QuickSearchStrategyId)},e.prototype.addQuickSearchStyleToColumn=function(e,t){var i=this,o={};o[t]=function(t){if(t.node&&!t.node.group){var o=t.colDef.colId?t.colDef.colId:t.colDef.field,n=i.api.quickSearchApi.getQuickSearchState();if(F.StringExtensions.IsNotNullOrEmpty(n.QuickSearchText)&&(n.DisplayAction==b.DisplayAction.HighlightCell||n.DisplayAction==b.DisplayAction.ShowRowAndHighlightCell)){if(e.IsExcludedFromQuickSearch)return!1;if(null==o){if(t.columnApi){var r=t.columnApi.getAllColumns();if(V.ArrayExtensions.IsNotNullOrEmpty(r)){var a=r.find((function(e){return e.getColDef().headerName==t.colDef.headerName}));a&&(o=a.getColId())}}if(null==o&&t.value)return String(t.value).toLowerCase().includes(n.QuickSearchText)}if(null!=o){var l=x.RangeHelper.CreateValueRangeFromOperand(n.QuickSearchText);if(l&&x.RangeHelper.IsColumnAppropriateForRange(l,e)){var s=D.ExpressionHelper.CreateSingleColumnExpression(o,null,null,null,[l]);if(D.ExpressionHelper.checkForExpressionFromRowNode(s,t.node,[e],i))return!0}}}}return!1},this.setCellClassRules(o,e.ColumnId,"QuickSearch")},e.prototype.getPrimaryKeyValueFromRowNode=function(e){var t=this.getGridOptionsApi();if(t)return t.getValue(this.adaptableOptions.primaryKey,e)},e.prototype.gridHasCurrentEditValue=function(){return!!this._currentEditor},e.prototype.getCurrentCellEditValue=function(){return this._currentEditor?this._currentEditor.getValue():""},e.prototype.getActiveCell=function(){var e=this.gridOptions.api.getFocusedCell();if(e){var t=this.gridOptions.api.getModel().getRow(e.rowIndex);if(t&&!this.isGroupRowNode(t))return{columnId:e.column.getColId(),primaryKeyValue:this.getPrimaryKeyValueFromRowNode(t),rawValue:this.getRawValueFromRowNode(t,e.column.getColId()),displayValue:this.getDisplayValueFromRowNode(t,e.column.getColId())}}},e.prototype.saveGridLayout=function(){null!=this.adaptableOptions.layoutOptions&&null!=this.adaptableOptions.layoutOptions.includeVendorStateInLayouts&&this.adaptableOptions.layoutOptions.includeVendorStateInLayouts&&this.LayoutService.autoSaveLayout()},e.prototype.setSelectedCells=function(){var e=this,t=this.gridOptions.api.getCellRanges(),i=[],n=[];if(!this.api.internalApi.isGridInPivotMode()){t&&t.forEach((function(t){var r,a,l=!0,s=null!=t.startRow.rowPinned,u=null!=t.endRow.rowPinned;if(s&&(u&&(l=!1),R.LoggingHelper.LogWarning("Cannot select pinned rows in ag-Grid.")),l){var p=Math.min(t.startRow.rowIndex,t.endRow.rowIndex),d=Math.max(t.startRow.rowIndex,t.endRow.rowIndex),c=function(t){if(null!=t){var o=t.getColId(),r=w.ColumnHelper.getColumnFromId(o,e.api.gridApi.getColumns());r&&null==i.find((function(e){return e.ColumnId==r.ColumnId}))&&i.push(r);for(var a=p;a<=d;a++){var l=e.gridOptions.api.getModel().getRow(a);if(l&&!e.isPinnedRowNode(l)){var s=e.getPrimaryKeyValueFromRowNode(l),u={columnId:o,rawValue:e.getRawValueFromRowNode(l,o),displayValue:e.getDisplayValueFromRowNode(l,o),primaryKeyValue:s};n.push(u)}}}};try{for(var h=o.__values(t.columns),m=h.next();!m.done;m=h.next()){c(m.value)}}catch(g){r={error:g}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}}}));var r={Columns:i,GridCells:n};this.api.internalApi.setSelectedCells(r),this._emit("CellsSelected"),this.agGridHelper.fireSelectionChangedEvent()}},e.prototype.setSelectedRows=function(){var e=this,t=this.gridOptions.api.getSelectedNodes(),i=[];if(!this.gridOptions.columnApi.isPivotMode()){V.ArrayExtensions.IsNotNullOrEmpty(t)&&t.forEach((function(t){var o={isMaster:!(null==t.master||1!=t.master),isExpanded:!(null==t.expanded||1!=t.expanded),isGroup:!(null==t.group||1!=t.group),level:t.level},n={primaryKeyValue:e.getPrimaryKeyValueFromRowNode(t),rowData:t.data,rowNode:null,rowInfo:o};i.push(n)}));var o={GridRows:i};this.api.internalApi.setSelectedRows(o),this._emit("RowsSelected"),this.agGridHelper.fireSelectionChangedEvent()}},e.prototype.setValue=function(e,t){var i,o=this,n=w.ColumnHelper.getColumnDataTypeFromColumnId(e.ColumnId,this.api.gridApi.getColumns());if(i=n==b.DataType.Number?Number(e.NewValue):e.NewValue,e.RowNode)e.RowNode.setDataValue(e.ColumnId,i);else if(this.useRowNodeLookUp){var r=this.gridOptions.api.getRowNode(e.PrimaryKeyValue);null!=r&&(r.setDataValue(e.ColumnId,i),e.RowNode=r)}else{var a=!1;this.gridOptions.api.getModel().forEachNode((function(t){a||e.PrimaryKeyValue==o.getPrimaryKeyValueFromRowNode(t)&&(t.setDataValue(e.ColumnId,i),e.RowNode=t,a=!0)}))}this.performPostEditChecks(e,t,!t),t&&this.agGridHelper.reselectSelectedCells()},e.prototype.cancelEdit=function(){this.gridOptions.api.stopEditing(!0)},e.prototype.getRowNodeIsSatisfiedFunction=function(e,t){var i=this;if(t==b.DistinctCriteriaPairValue.RawValue){var o;if(this.useRowNodeLookUp)o=this.gridOptions.api.getRowNode(e);else{var n=!1;this.gridOptions.api.getModel().forEachNode((function(t){n||e!=i.getPrimaryKeyValueFromRowNode(t)||(o=t,n=!0)}))}return function(e){return i.gridOptions.api.getValue(e,o)}}return function(t){return i.getDisplayValue(e,t)}},e.prototype.getRowNodeIsSatisfiedFunctionFromRowNode=function(e,t){var i=this;if(t==b.DistinctCriteriaPairValue.RawValue){return function(t){return i.gridOptions.api.getValue(t,e)}}return function(t){return i.getDisplayValueFromRowNode(e,t)}},e.prototype.setCustomSort=function(e,t){var i=this.gridOptions.api.getSortModel(),o=this.gridOptions.api.getColumnDef(e);o&&(o.comparator=t,o.pivotComparator=t),this.gridOptions.api.setSortModel(i)},e.prototype.removeCustomSort=function(e){var t=this.gridOptions.api.getSortModel(),i=this.gridOptions.api.getColumnDef(e);i&&(i.comparator=null),this.gridOptions.api.setSortModel(t)},e.prototype.getColumnValueDisplayValuePairDistinctList=function(e,t,i){var o=this,n=new Map,r=this.api.userInterfaceApi.getPermittedValuesForColumn(e);if(V.ArrayExtensions.IsNotNullOrEmpty(r))r.forEach((function(e){n.set(e,{RawValue:e,DisplayValue:e})}));else{var a=this.useRawValueForColumn(e);i?this.gridOptions.api.forEachNodeAfterFilter((function(i){o.addDistinctColumnValue(i,e,a,t,n)})):this.gridOptions.api.forEachNode((function(i){o.addDistinctColumnValue(i,e,a,t,n)}))}return Array.from(n.values()).slice(0,this.adaptableOptions.queryOptions.maxColumnValueItemsDisplayed)},e.prototype.getColumnValueDisplayValuePairList=function(e,t,i){var o=this,n=[],r=new Map,a=this.api.userInterfaceApi.getPermittedValuesForColumn(e);V.ArrayExtensions.IsNotNullOrEmpty(a)?a.forEach((function(e){r.set(e,{RawValue:e,DisplayValue:e})})):r=null;var l=this.useRawValueForColumn(e),s=function(e,t,a){if(e&&!o.isGroupRowNode(e)){var l=o.gridOptions.api.getValue(t,e),s=a?G.Helper.StringifyValue(l):o.getDisplayValueFromRowNode(e,t),u=!r||r.has(s);if(u&&i){var p=o.getPrimaryKeyValueFromRowNode(e);u=!!i[p]}u&&n.push({RawValue:l,DisplayValue:s})}};return t?this.gridOptions.api.forEachNodeAfterFilter((function(t){s(t,e,l)})):this.gridOptions.api.forEachNode((function(t){s(t,e,l)})),n.slice(0,this.adaptableOptions.queryOptions.maxColumnValueItemsDisplayed)},e.prototype.addDistinctColumnValue=function(e,t,i,o,n){if(e&&!this.isGroupRowNode(e)){var r=this.gridOptions.api.getValue(t,e),a=i?G.Helper.StringifyValue(r):this.getDisplayValueFromRowNode(e,t);o==b.DistinctCriteriaPairValue.RawValue?n.set(r,{RawValue:r,DisplayValue:a}):n.set(a,{RawValue:r,DisplayValue:a})}},e.prototype.useRawValueForColumn=function(e){var t=this.gridOptions.api.getColumnDef(e);if(t&&null!=t.cellRenderer)return!0;var i=this.api.percentBarApi.getAllPercentBar();return!V.ArrayExtensions.IsEmpty(i)&&V.ArrayExtensions.ContainsItem(i.map((function(e){return e.ColumnId})),e)},e.prototype.getDisplayValue=function(e,t){var i,o=this;if(this.useRowNodeLookUp){var n=this.gridOptions.api.getRowNode(e);i=this.getDisplayValueFromRowNode(n,t)}else{var r=!1;this.gridOptions.api.getModel().forEachNode((function(n){r||e!=o.getPrimaryKeyValueFromRowNode(n)||(i=o.getDisplayValueFromRowNode(n,t),r=!0)}))}return i},e.prototype.getDisplayValueFromRowNode=function(e,t){if(null==e)return"";var i=this.gridOptions.api.getValue(t,e);return this.useRawValueForColumn(t)?G.Helper.StringifyValue(i):this.getDisplayValueFromRawValue(t,i)},e.prototype.getDisplayValueFromRawValue=function(e,t){var i=this.gridOptions.api.getColumnDef(e);if(i){if(i.valueFormatter){var o=this.gridOptions.columnApi.getAllColumns().find((function(t){return t.getColId()==e})),n=(0,i.valueFormatter)({value:t,node:null,data:null,colDef:i,column:o,api:this.gridOptions.api,columnApi:this.gridOptions.columnApi,context:null});return i.cellRenderer?this.getRenderedValue(i,n):n||""}if(i.cellRenderer)return this.getRenderedValue(i,t)}return this.agGridHelper.getCleanValue(t)},e.prototype.getRenderedValue=function(e,t){return this.agGridHelper.getRenderedValue(this.api.percentBarApi.getAllPercentBar(),e,t)},e.prototype.getRawValueFromRowNode=function(e,t){return this.gridOptions.api.getValue(t,e)},e.prototype.getDataRowFromRowNode=function(e){return null!=e&&void 0!=e?e.data:void 0},e.prototype.getRowNodeForPrimaryKey=function(e){var t=this;if(this.useRowNodeLookUp)return this.gridOptions.api.getRowNode(e);this.gridOptions.api.getModel().forEachNode((function(i){if(e==t.getPrimaryKeyValueFromRowNode(i))return i}))},e.prototype.getRowNodesForPrimaryKeys=function(e){var t=this,i=[];return this.useRowNodeLookUp?e.forEach((function(e){var o=t.gridOptions.api.getRowNode(e);o&&i.push(o)})):e.forEach((function(e){var o=!1;t.gridOptions.api.getModel().forEachNode((function(n){o||e!=t.getPrimaryKeyValueFromRowNode(n)||(i.push(n),o=!0)}))})),i},e.prototype.setCellClassRules=function(e,t,i){var o=this.gridOptions.columnApi.getColumn(t);if(o){var n=o.getColDef();if(n){var r=n.cellClassRules;if(r){if("FormatColumn"==i)for(var a in r)a.includes(p.FormatColumnStrategyId)&&delete r[a];else if("ConditionalStyle"==i){var l=this.api.conditionalStyleApi.getAllConditionalStyle().map((function(e){return e.Style.ClassName}));for(var a in r)(a.includes(p.ConditionalStyleStrategyId)||V.ArrayExtensions.ContainsItem(l,a))&&delete r[a]}else if("QuickSearch"==i)for(var a in r)a.includes(p.QuickSearchStrategyId)&&delete r[a];else if("Alert"==i)for(var a in r)a.includes(d.ALERT_STYLE)&&delete r[a];else if("UpdatedRow"==i)for(var a in r)a.includes(d.UPDATED_ROW_NEUTRAL_STYLE)&&delete r[a];else if("FlashingCell"==i)for(var a in r)a.includes(d.FLASH_CELL_UP_STYLE)&&delete r[a],a.includes(d.FLASH_CELL_DOWN_STYLE)&&delete r[a];for(var a in e)r[a]=e[a]}else n.cellClassRules=e}}},e.prototype.setRowClassRules=function(e,t){this.gridOptions.rowClassRules;this.gridOptions.rowClassRules=e},e.prototype.forAllRowNodesDo=function(e){this.gridOptions.api.getModel().forEachNode((function(t){e(t)}))},e.prototype.forAllVisibleRowNodesDo=function(e){this.gridOptions.api.forEachNodeAfterFilterAndSort((function(t){e(t)}))},e.prototype.selectNodes=function(e){var t=this;V.ArrayExtensions.IsNotNullOrEmpty(e)&&e.forEach((function(e){return t.selectNode(e)}))},e.prototype.selectNode=function(e){e?e.setSelected(!0,!0):R.LoggingHelper.LogAdaptableError("No node to select")},e.prototype.redraw=function(){this.gridOptions.api.redrawRows(),this.gridOptions.api.refreshHeader(),this._emit("GridRefreshed")},e.prototype.redrawRow=function(e){this.gridOptions.api.redrawRows({rowNodes:[e]})},e.prototype.refreshCells=function(e,t){var i={rowNodes:e,columns:t,force:!0};this.gridOptions.api.refreshCells(i)},e.prototype.jumpToRow=function(e){this.gridOptions.api.ensureNodeVisible(e,"middle")},e.prototype.jumpToColumn=function(e){this.gridOptions.api.ensureColumnVisible(e)},e.prototype.jumpToCell=function(e,t){this.jumpToRow(t),this.jumpToColumn(e)},e.prototype.editCalculatedColumnInGrid=function(e){var t,i,n,r,a=this,l=this.api.gridApi.getColumns(),s=l.find((function(t){return t.Uuid==e.Uuid}));if(s){var u=this.CalculatedColumnExpressionService.CleanExpressionColumnNames(e.ColumnExpression,l),p=this.mapColumnDefs((function(t){if(t.headerName===s.ColumnId){var i=o.__assign({},t);return i.valueGetter=function(e){return a.CalculatedColumnExpressionService.ComputeExpressionValue(u,e.node)},i.type=a.agGridHelper.getAgGridDataType(e.CalculatedColumnSettings.DataType),i.enableValue=e.CalculatedColumnSettings.Aggregatable,i.filter=e.CalculatedColumnSettings.Filterable,i.resizable=e.CalculatedColumnSettings.Resizable,i.enableRowGroup=e.CalculatedColumnSettings.Groupable,i.sortable=e.CalculatedColumnSettings.Sortable,i.enablePivot=e.CalculatedColumnSettings.Pivotable,i.headerName=e.ColumnId,i.colId=e.ColumnId,s.ColumnId=e.ColumnId,s.DataType=e.CalculatedColumnSettings.DataType,s.Aggregatable=a.agGridHelper.isColumnAggregetable(i),s.Filterable=a.agGridHelper.isColumnFilterable(i),s.Groupable=a.agGridHelper.isColumnGroupable(i),s.Pivotable=a.agGridHelper.isColumnPivotable(i),s.Sortable=a.agGridHelper.isColumnSortable(i),s.ReadOnly=a.agGridHelper.isColumnReadonly(i),a.api.internalApi.addAdaptableColumn(s),i}return t}));this.safeSetColDefs(p);try{for(var d=o.__values(this.calculatedColumnPathMap.values()),c=d.next();!c.done;c=d.next()){var h=c.value,m=h.indexOf(e.ColumnId);m>-1&&h.splice(m,1)}}catch(E){t={error:E}}finally{try{c&&!c.done&&(i=d.return)&&i.call(d)}finally{if(t)throw t.error}}var g=this.CalculatedColumnExpressionService.GetColumnListFromExpression(u);try{for(var f=o.__values(g),C=f.next();!C.done;C=f.next()){var y=C.value,v=this.calculatedColumnPathMap.get(y);v||(v=[],this.calculatedColumnPathMap.set(y,v)),v.push(e.ColumnId)}}catch(O){n={error:O}}finally{try{C&&!C.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}}this.postSpecialColumnEditDelete(!0)},e.prototype.removeCalculatedColumnFromGrid=function(e){var t,i,n=!1,r=this.mapColumnDefs((function(t){return t.headerName===e?(n=!0,null):t}),{removeEmpty:!0});n&&this.safeSetColDefs(r);try{for(var a=o.__values(this.calculatedColumnPathMap.values()),l=a.next();!l.done;l=a.next()){var s=l.value,u=s.indexOf(e);u>-1&&s.splice(u,1)}}catch(p){t={error:p}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}this.postSpecialColumnEditDelete(!0)},e.prototype.addCalculatedColumnToGrid=function(e){var t,i,n=this,r=o.__spread(this.getColumnDefs()||[]),a=this.api.gridApi.getColumns(),l=this.CalculatedColumnExpressionService.CleanExpressionColumnNames(e.ColumnExpression,a),s={headerName:e.ColumnId,colId:e.ColumnId,hide:!0,editable:!1,enableValue:e.CalculatedColumnSettings.Aggregatable,filter:e.CalculatedColumnSettings.Filterable,resizable:e.CalculatedColumnSettings.Resizable,enableRowGroup:e.CalculatedColumnSettings.Groupable,sortable:e.CalculatedColumnSettings.Sortable,enablePivot:e.CalculatedColumnSettings.Pivotable,type:this.agGridHelper.getAgGridDataType(e.CalculatedColumnSettings.DataType),valueGetter:function(e){return n.CalculatedColumnExpressionService.ComputeExpressionValue(l,e.node)}};e.CalculatedColumnSettings.DataType,b.DataType.Number,r.push(s),this.safeSetColDefs(r);var u=this.CalculatedColumnExpressionService.GetColumnListFromExpression(l);try{for(var p=o.__values(u),d=p.next();!d.done;d=p.next()){var c=d.value,h=this.calculatedColumnPathMap.get(c);h||(h=[],this.calculatedColumnPathMap.set(c,h)),h.push(e.ColumnId)}}catch(m){t={error:m}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(t)throw t.error}}this.addSpecialColumnToState(e.Uuid,e.ColumnId,e.CalculatedColumnSettings.DataType)},e.prototype.addFreeTextColumnToGrid=function(e){var t=this,i=o.__spread(this.getColumnDefs()),n={headerName:e.ColumnId,colId:e.ColumnId,editable:!0,hide:!0,filter:!0,sortable:!0,resizable:!0,cellEditor:"agLargeTextCellEditor",type:"abColDefString",valueSetter:function(t){return t.data[e.ColumnId]=t.newValue},valueGetter:function(i){return t.FreeTextColumnService.GetFreeTextValue(e,i.node)}};i.push(n),this.safeSetColDefs(i),this.addSpecialColumnToState(e.Uuid,e.ColumnId,b.DataType.String)},e.prototype.removeFreeTextColumnFromGrid=function(e){var t=!1,i=this.mapColumnDefs((function(i){return i.headerName===e?(t=!0,null):i}),{removeEmpty:!0});t&&this.safeSetColDefs(i),this.postSpecialColumnEditDelete(!0)},e.prototype.editFreeTextColumnInGrid=function(e){this.postSpecialColumnEditDelete(!0)},e.prototype.addActionColumnToGrid=function(e){var t=o.__spread(this.getColumnDefs()),i={headerName:e.FriendlyName?e.FriendlyName:e.ColumnId,colId:e.ColumnId,editable:!1,hide:!1,filter:!1,sortable:!1,resizable:!0,cellRenderer:U.ActionColumnRenderer};t.push(i),this.safeSetColDefs(t),this.addSpecialColumnToState(e.Uuid,e.ColumnId,b.DataType.String)},e.prototype.addSpecialColumnToState=function(e,t,i){var o=this.gridOptions.columnApi.getAllColumns().find((function(e){return e.getColId()==t}));if(o){var n=o.getColDef(),r={Uuid:e,ColumnId:t,FriendlyName:t,DataType:i,Visible:!1,ReadOnly:this.agGridHelper.isColumnReadonly(n),Sortable:this.agGridHelper.isColumnSortable(n),Filterable:this.agGridHelper.isColumnFilterable(n),Groupable:this.agGridHelper.isColumnGroupable(n),Pivotable:this.agGridHelper.isColumnPivotable(n),Aggregatable:this.agGridHelper.isColumnAggregetable(n),IsSparkline:i==b.DataType.NumberArray,SpecialColumn:!0,IsExcludedFromQuickSearch:!1};this.api.internalApi.addAdaptableColumn(r),this.applyStylingToColumn(o,r),this.postSpecialColumnEditDelete(!1)}},e.prototype.getFirstRowNode=function(){var e;return this.gridOptions.api.forEachNode((function(t){t.group||e||(e=t)})),e},e.prototype.destroy=function(t){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy(),this.rowListeners=null,this.emitter.clearListeners(),this.emitter=null,e.dismissInstance(this);var i=this.getadaptableContainerElement();t&&!t.unmount||null!=i&&r.unmountComponentAtNode(i)},e.prototype.getDefaultIPPStyle=function(){return{Header:{headerColor:"#000000",headerBackColor:"#f5f7f7",headerFontFamily:"sans-serif",headerFontSize:"12px",headerFontStyle:"normal",headerFontWeight:"400",height:65,Columns:this.api.gridApi.getColumns().map((function(e){return{columnFriendlyName:e.FriendlyName,width:200,textAlign:"start"}}))},Row:{color:"#000000",backColor:"#ffffff",altBackColor:"#fcfdfe",fontFamily:"sans-serif",fontSize:"12px",fontStyle:"normal",fontWeight:"400",height:30,Columns:this.api.gridApi.getColumns().map((function(e){return{columnFriendlyName:e.FriendlyName,width:200,textAlign:"start"}}))}}},e.prototype.getCurrentIPPStyle=function(){var e=document.querySelectorAll(".ag-header-cell").item(0),t=document.querySelector(".ag-header"),i=t?window.getComputedStyle(t,null):null,o=document.querySelector(".ag-row-even"),n=o?window.getComputedStyle(o,null):null,r=document.querySelector(".ag-row-odd"),a=r?window.getComputedStyle(r,null):{backgroundColor:"#fff"};return{Header:{headerColor:new I.Color(i.color).toHex(),headerBackColor:new I.Color(i.backgroundColor).toHex(),headerFontFamily:i.fontFamily,headerFontSize:i.fontSize,headerFontStyle:i.fontStyle,headerFontWeight:i.fontWeight,height:Number(i.height.replace("px","")),Columns:this.api.gridApi.getColumns().map((function(t){var i=document.querySelector(".ag-header-cell[col-id='"+t.ColumnId+"']"),o=window.getComputedStyle(i||e,null);return{columnFriendlyName:t.FriendlyName,width:Number(o.width.replace("px","")),textAlign:o.textAlign}}))},Row:{color:new I.Color(n.color).toHex(),backColor:new I.Color(n.backgroundColor).toHex(),altBackColor:new I.Color(a.backgroundColor).toHex(),fontFamily:n.fontFamily,fontSize:n.fontSize,fontStyle:n.fontStyle,fontWeight:n.fontWeight,height:Number(n.height.replace("px","")),Columns:this.api.gridApi.getColumns().map((function(e){var t=document.querySelector(".ag-cell[col-id='"+e.ColumnId+"']"),i=window.getComputedStyle(t||o,null);return{columnFriendlyName:e.FriendlyName,width:Number(i.width.replace("px","")),textAlign:i.textAlign}}))}}},e.prototype.getadaptableContainerElement=function(){if(!this.abContainerElement&&(this.abContainerElement=document.getElementById(this.adaptableOptions.containerOptions.adaptableContainer),!this.abContainerElement)){var e=document.getElementById("adaptableBlotter");e&&(R.LoggingHelper.LogAdaptableWarning('\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!! The old default container element for Adaptable was "#adaptableBlotter", configured via \'containerOptions.adaptableContainer="adaptableBlotter"\'.\n!!!!! Seems like you haven\'t updated your html container selector, so we\'re falling back to using that one.\n!!!!!\n!!!!! To make this warning go away, update your html structure and make sure you have an element with id="adaptable" in your app!\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n'),this.abContainerElement=e)}return this.abContainerElement},e.prototype.getGridContainerElement=function(){return this.gridContainerElement||(this.gridContainerElement=document.getElementById(this.adaptableOptions.containerOptions.vendorContainer)),this.gridContainerElement},e.prototype.initInternalGridLogic=function(){var t=this;if(this.renderGrid&&(null==this.abContainerElement&&(this.abContainerElement=this.getadaptableContainerElement()),null==this.abContainerElement))R.LoggingHelper.LogAdaptableError('There is no DIV with id="'+this.adaptableOptions.containerOptions.adaptableContainer+'" so cannot render Adaptable');else{var i=this.getGridContainerElement();i&&i.addEventListener("keydown",(function(e){return t._emit("KeyDown",e)})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_VISIBLE,(function(e){e.visible&&e.column&&t.updateQuickSearchRangeVisibleColumn(e.column.colId)}));var r=[n.Events.EVENT_COLUMN_MOVED,n.Events.EVENT_GRID_COLUMNS_CHANGED,n.Events.EVENT_COLUMN_EVERYTHING_CHANGED,n.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,n.Events.EVENT_COLUMN_VISIBLE,n.Events.EVENT_NEW_COLUMNS_LOADED];this.gridOptions.api.addGlobalListener((function(e){if(r.indexOf(e)>-1){var i=t.getState().Popup.ScreenPopup;i.ShowScreenPopup&&(i.ComponentName==c.ColumnChooserPopup||c.CalculatedColumnPopup)||t.debouncedSetColumnIntoStore(),t.debouncedFilterGrid()}})),this.gridOptions.api.addEventListener(n.Events.EVENT_FIRST_DATA_RENDERED,(function(){t.debouncedSetColumnIntoStore()})),this.gridOptions.api.addEventListener(n.Events.EVENT_GRID_READY,(function(){})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(e){"columnPivotModeChanged"==e.type&&null!=e.columnApi&&null!=e.columnApi.columnController&&1==e.columnApi.columnController.pivotMode?(1==t.adaptableOptions.layoutOptions.autoSizeColumnsInPivotLayout&&t.gridOptions.columnApi.autoSizeAllColumns(),t.api.internalApi.setPivotModeOn()):t.api.internalApi.setPivotModeOff()})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_PIVOT_CHANGED,(function(e){"columnPivotChanged"==e.type&&null!=e.columnApi&&null!=e.columnApi.columnController&&1==e.columnApi.columnController.pivotMode&&1==t.adaptableOptions.layoutOptions.autoSizeColumnsInPivotLayout&&t.gridOptions.columnApi.autoSizeAllColumns()}));var a=[n.Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,n.Events.EVENT_COLUMN_PINNED,n.Events.EVENT_COLUMN_PIVOT_CHANGED,n.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,n.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,n.Events.EVENT_SORT_CHANGED,n.Events.EVENT_COLUMN_ROW_GROUP_CHANGED];this.gridOptions.api.addGlobalListener((function(e){a.indexOf(e)>-1&&t.debouncedSaveGridLayout()})),this.gridOptions.api.addEventListener(n.Events.EVENT_ROW_GROUP_OPENED,(function(e){t.adaptableOptions.layoutOptions.includeOpenedRowGroups&&t.debouncedSaveGridLayout()})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_RESIZED,(function(e){t.gridOptions.api&&"columnResized"==e.type&&1==e.finished&&(t.isQuickFilterActive()&&t.gridOptions.api.refreshHeader(),e.column&&t._emit("ColumnResized",e.column.colId))})),this.gridOptions.api.addEventListener(n.Events.EVENT_CELL_EDITING_STARTED,(function(e){if(!t.gridOptions.columnApi.isPivotMode()){var i=t.gridOptions.api.rowRenderer;if(i){var o=i.rowCompsByIndex[e.node.rowIndex];if(o){var r=o.cellComps[e.column.getColId()].cellEditor;r instanceof n.PopupEditorWrapper?t._currentEditor=r.cellEditor:t._currentEditor=r}}if(t._currentEditor){var a=t._currentEditor.isCancelAfterEnd;t._currentEditor.isCancelAfterEnd=function(){var i={OldValue:t.gridOptions.api.getValue(e.column.getColId(),e.node),NewValue:t._currentEditor.getValue(),ColumnId:e.column.getColId(),PrimaryKeyValue:t.getPrimaryKeyValueFromRowNode(e.node),RowNode:e.node};if(i.OldValue===i.NewValue)return!0;if(!t.ValidationService.PerformCellValidation(i))return!0;var o=function(){var e=!!a&&a();return e||t.performPostEditChecks(i,!1,!1),e};return(t.adaptableOptions.editOptions.validateOnServer?t.ValidationService.PerformServerValidation(i,{onServerValidationCompleted:o}):o)()}}}})),this.gridOptions.api.addEventListener(n.Events.EVENT_CELL_EDITING_STOPPED,(function(e){if(t._currentEditor=void 0,e&&e.node){var i=e.column;if(i){var o=w.ColumnHelper.getColumnFromId(i.colId,t.api.gridApi.getColumns());if(o&&o.DataType==b.DataType.Number){var n=!0;if(V.ArrayExtensions.IsNotNullOrEmpty(t.api.shortcutApi.getAllShortcut()))t.api.internalApi.getSystemState().LastAppliedShortCut&&(n=!1);n&&e.node.setDataValue(i.colId,Number(e.value))}}t.filterOnUserDataChange([e.node]),t.debouncedSetSelectedCells()}})),this.gridOptions.api.addEventListener(n.Events.EVENT_CELL_VALUE_CHANGED,(function(e){if(e.newValue!=e.oldValue){var i=e.colDef.field;if(i){var o=[i],n=t.calculatedColumnPathMap.get(i);if(n){var r=t.getPrimaryKeyValueFromRowNode(e.node);n.forEach((function(i){var n={OldValue:e.oldValue,NewValue:t.gridOptions.api.getValue(i,e.node),ColumnId:i,PrimaryKeyValue:r,RowNode:e.node};t.DataService.CreateDataChangedEvent(n),V.ArrayExtensions.AddItem(o,i)}))}t.api.percentBarApi.getAllPercentBar().forEach((function(e){o.forEach((function(t){F.StringExtensions.IsNotNullOrEmpty(e.PositiveValueColumnId)&&e.PositiveValueColumnId==t&&V.ArrayExtensions.AddItem(o,e.ColumnId),F.StringExtensions.IsNotNullOrEmpty(e.NegativeValueColumnId)&&e.NegativeValueColumnId==t&&V.ArrayExtensions.AddItem(o,e.ColumnId)}))}))}t.filterOnExternalDataChange([e.node])}}));var l=[n.Events.EVENT_ROW_GROUP_OPENED,n.Events.EVENT_SELECTION_CHANGED,n.Events.EVENT_ROW_SELECTED];this.gridOptions.api.addGlobalListener((function(e){V.ArrayExtensions.ContainsItem(l,e)&&t.debouncedSetSelectedRows()})),this.gridOptions.api.addEventListener(n.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(e){})),this.gridOptions.api.addEventListener(n.Events.EVENT_SELECTION_CHANGED,(function(){})),this.gridOptions.api.addEventListener(n.Events.EVENT_ROW_SELECTED,(function(){})),this.gridOptions.api.addEventListener(n.Events.EVENT_RANGE_SELECTION_CHANGED,(function(){t.debouncedSetSelectedCells()}));var s=[n.Events.EVENT_SORT_CHANGED];this.gridOptions.api.addGlobalListener((function(e){V.ArrayExtensions.ContainsItem(s,e)&&(t.onSortChanged(),t.debouncedSetSelectedCells())})),this.gridOptions.api.addEventListener(n.Events.EVENT_MODEL_UPDATED,(function(e){if(t.adaptableOptions.generalOptions.showGroupingTotalsAsHeader&&e&&e.api){var i=e.api.getPinnedTopRow(0),o=e.api.getModel().getRootNode();i?i.updateData(o.aggData):e.api.setPinnedTopRowData([o.aggData])}t.checkColumnsDataTypeSet()})),this.rowListeners={dataChanged:function(e){t.onRowDataChanged({rowNode:e.node,oldData:e.oldData,newData:e.newData})}},te.dispatchLocalEvent=function(t){var i=t.node,o=ie.apply(this,arguments);return i&&e.forEachAdaptable((function(e){if(i.gridApi===e.gridOptions.api){var o=e.rowListeners?e.rowListeners[t.type]:null;o&&o(t)}})),o};var u=this.gridOptions.isExternalFilterPresent;this.gridOptions.isExternalFilterPresent=function(){var e,i,n=t.api.columnFilterApi.getAllColumnFilter(),r=V.ArrayExtensions.IsNotNullOrEmpty(n);if(r)try{for(var a=o.__values(n),l=a.next();!l.done;l=a.next()){var s=l.value,p=t.gridOptions.columnApi.getColumn(s.ColumnId);p&&(p.isFilterActive()||p.setFilterActive(!0))}}catch(h){e={error:h}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(e)throw e.error}}var d=F.StringExtensions.IsNotNullOrEmpty(t.api.advancedSearchApi.getAdvancedSearchState().CurrentAdvancedSearch),c=F.StringExtensions.IsNotNullOrEmpty(t.api.quickSearchApi.getQuickSearchValue());return r||d||c||!!u&&u()};var p=this.gridOptions.doesExternalFilterPass;this.gridOptions.doesExternalFilterPass=function(e){var i,n,r,a,l=t.api.gridApi.getColumns();if("None"==t.adaptableOptions.searchOptions.serverSearchOption){var s=t.api.advancedSearchApi.getCurrentAdvancedSearch();if(s&&!D.ExpressionHelper.checkForExpressionFromRowNode(s.Expression,e,l,t))return!1}if("None"==t.adaptableOptions.searchOptions.serverSearchOption||"AdvancedSearch"==t.adaptableOptions.searchOptions.serverSearchOption){var u=t.api.columnFilterApi.getAllColumnFilter();if(u.length>0)try{for(var d=o.__values(u),c=d.next();!c.done;c=d.next()){var h=c.value;if(!D.ExpressionHelper.checkForExpressionFromRowNode(h.Filter,e,l,t))return!1}}catch(S){i={error:S}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(i)throw i.error}}var m=t.api.quickSearchApi.getQuickSearchState();if(m.DisplayAction!=b.DisplayAction.HighlightCell){if(F.StringExtensions.IsNullOrEmpty(m.QuickSearchText))return!0;var g=t.getState().System.QuickSearchVisibleColumnExpressions,f=t.getState().System.QuickSearchRange;if(null==f&&(f=x.RangeHelper.CreateValueRangeFromOperand(m.QuickSearchText)),null==f)return!0;var C=l.filter((function(e){return e.Visible&&!e.IsExcludedFromQuickSearch})),y=function(i){var o=g.find((function(e){return e.RangeExpressions[0].ColumnId==i.ColumnId}));if(o&&D.ExpressionHelper.checkForExpressionFromRowNode(o,e,[i],t))return{value:!p||p(e)}};try{for(var v=o.__values(C),E=v.next();!E.done;E=v.next()){var O=y(E.value);if("object"===typeof O)return O.value}}catch(A){r={error:A}}finally{try{E&&!E.done&&(a=v.return)&&a.call(v)}finally{if(r)throw r.error}}return!1}}return!p||p(e)},this.addSpecialRendereredColumns(),this.applyFormatColumnDisplayFormats();var d=this.gridOptions.getMainMenuItems;this.gridOptions.getMainMenuItems=function(e){var i,n=e.column.getColId(),r=[],a=w.ColumnHelper.getColumnFromId(n,t.api.gridApi.getColumns());if(null!=a&&t.strategies.forEach((function(e){var t=e.addColumnMenuItems(a);t&&r.push.apply(r,o.__spread(t))})),d){var l=d(e);i=l.slice(0)}else i=e.defaultItems.slice(0);i.push("separator");var s={GridCell:void 0,Column:a,IsSelectedCell:!1,IsSingleSelectedColumn:!1,IsGroupedNode:!1,RowNode:void 0,PrimaryKeyValue:void 0,SelectedCellInfo:t.api.gridApi.getSelectedCellInfo(),SelectedRowInfo:t.api.gridApi.getSelectedRowInfo(),AdaptableApi:t.api},u=t.adaptableOptions.userInterfaceOptions.showAdaptableColumnMenu;null!=u&&!1===u||r.forEach((function(e){if(e){var o=!0;if(null!=u&&"function"===typeof u&&(o=u(e,s)),o){var n=t.agGridHelper.createAgGridMenuDefFromAdaptableMenu(e);i.push(n)}}}));var p=t.api.userInterfaceApi.getUserInterfaceState().ColumnMenuItems;return V.ArrayExtensions.IsNotNullOrEmpty(p)&&p.filter((function(e){return!e.UserMenuItemShowPredicate||t.getUserFunctionHandler("UserMenuItemShowPredicate",e.UserMenuItemShowPredicate)(s)})).forEach((function(e){var o=t.agGridHelper.createAgGridMenuDefFromUsereMenu(e,s,"columnMenu");i.push(o)})),i};var h=this.gridOptions.getContextMenuItems;this.gridOptions.getContextMenuItems=function(e){var i,o=[];if(h){var n=h(e);o=n.slice(0)}else o=e.defaultItems?e.defaultItems.slice(0):[];var r=[],a=e.column;if(a){var l=w.ColumnHelper.getColumnFromId(a.getColId(),t.api.gridApi.getColumns());if(null!=l){if(i=t.agGridHelper.createMenuInfo(e,l),e.node.group||t.strategies.forEach((function(e){var t=e.addContextMenuItem(i);t&&r.push(t)})),V.ArrayExtensions.IsNotNullOrEmpty(r)){var s=t.adaptableOptions.userInterfaceOptions.showAdaptableContextMenu;null!=s&&!1===s||(o.push("separator"),r.forEach((function(e){if(e){var n=!0;if(null!=s&&"function"===typeof s&&(n=s(e,i)),n){var r=t.agGridHelper.createAgGridMenuDefFromAdaptableMenu(e);o.push(r)}}})))}var u=t.api.userInterfaceApi.getUserInterfaceState().ContextMenuItems;V.ArrayExtensions.IsNotNullOrEmpty(u)&&(o.push("separator"),u.filter((function(e){return!e.UserMenuItemShowPredicate||t.getUserFunctionHandler("UserMenuItemShowPredicate",e.UserMenuItemShowPredicate)(i)})).forEach((function(e){var n=t.agGridHelper.createAgGridMenuDefFromUsereMenu(e,i,"contextMenu");o.push(n)})))}}return o}}},e.prototype.applyFormatColumnDisplayFormats=function(){var e=this,t=this.api.formatColumnApi.getAllFormatColumnWithDisplayFormat().concat(this.api.formatColumnApi.getAllFormatColumnWithCellAlignment());this.gridOptions.columnApi.getAllColumns().forEach((function(i){var o=i.getColDef();void 0===e.originalColDefValueFormatters[o.field]&&(e.originalColDefValueFormatters[o.field]=o.valueFormatter||null),o.valueFormatter=e.originalColDefValueFormatters[o.field];var n=t.find((function(e){return e.ColumnId===o.field||e.ColumnId===o.colId}));if(n){if(n.DisplayFormat){if("NumberFormatter"===n.DisplayFormat.Formatter){var r=n.DisplayFormat.Options;o.valueFormatter=function(e){return ee.default.NumberFormatter(e.value,r)}}if("DateFormatter"===n.DisplayFormat.Formatter){var a=n.DisplayFormat.Options;o.valueFormatter=function(e){return ee.default.DateFormatter(e.value,a)}}}if(null!=n.CellAlignment)switch(n.CellAlignment){case"Left":o.cellClass="ab-cell--align-left";break;case"Right":o.cellClass="ab-cell--align-right";break;case"Center":o.cellClass="ab-cell--align-center"}}}))},e.prototype.postSpecialColumnEditDelete=function(e){if(this.isInitialised){if(this.api.layoutApi.getCurrentLayout()){var t=this.api.layoutApi.getCurrentLayout().Name;t!=P.DEFAULT_LAYOUT&&(e?(this.api.layoutApi.setLayout(P.DEFAULT_LAYOUT),this.api.layoutApi.setLayout(t),this.setColumnIntoStore()):this.api.layoutApi.setLayout(t))}this.addSpecialRendereredColumns(),this._emit("SpecialColumnAdded")}},e.prototype.addSpecialRendereredColumns=function(){var e=this;this.forPlugins((function(){})),this.api.percentBarApi.getAllPercentBar().forEach((function(t){e.addPercentBar(t)})),this.api.gradientColumnApi.getAllGradientColumn().forEach((function(t){e.addGradientColumn(t)})),this.api.sparklineColumnApi.getAllSparklineColumn().forEach((function(t){e.addSparklineColumn(t)}))},e.prototype.addSparklineColumn=function(e){if(null!=e.LineColor&&void 0!=e.LineColor||(e.LineColor=Q.DefaultSparklinesChartProperties.Brush),w.ColumnHelper.getColumnFromId(e.ColumnId,this.api.gridApi.getColumns())){var t=this.agGridHelper.createSparklineCellRendererComp(e,this.adaptableOptions.adaptableId),i=this.gridOptions.columnApi.getColumn(e.ColumnId).getColDef();t&&(i.cellRenderer=t),null!=e.ShowToolTip&&1==e.ShowToolTip?i.tooltipField=i.field:i.tooltipField=""}},e.prototype.removeSparklineColumn=function(e){if(w.ColumnHelper.getColumnFromId(e.ColumnId,this.api.gridApi.getColumns())){var t=this.gridOptions.columnApi.getColumn(e.ColumnId);t.getColDef().cellRenderer=null,t.getColDef().cellRenderer=null}},e.prototype.addGradientColumn=function(e){var t=this.gridOptions.api.getColumnDef(e.ColumnId);t&&(t.cellStyle=function(t){var i,o,n=e.BaseValue,r=t.value<0;if(r?(i=e.NegativeColor,o=e.NegativeValue):(i=e.PositiveColor,o=e.PositiveValue),o&&void 0!==n){var a=Math.abs(o-n),l=(t.value-n)/a*100;r&&(l*=-1);var s=Number((l/100).toPrecision(2));return{"background-color":new I.Color(i).toRgba(s)}}})},e.prototype.removeGradientColumn=function(e){var t=this.gridOptions.api.getColumnDef(e.ColumnId);t&&t.cellStyle&&(t.cellStyle=void 0)},e.prototype.addPercentBar=function(e){if(w.ColumnHelper.getColumnFromId(e.ColumnId,this.api.gridApi.getColumns())){var t=this.agGridHelper.createPercentBarCellRendererFunc(e,this.adaptableOptions.adaptableId),i=this.gridOptions.columnApi.getColumn(e.ColumnId).getColDef();i.cellRenderer=t,"number-cell"==i.cellClass&&(i.cellClass="number-cell-changed"),null!=e.ShowToolTip&&1==e.ShowToolTip?i.tooltipField=i.field:i.tooltipField=""}},e.prototype.removePercentBar=function(e){if(w.ColumnHelper.getColumnFromId(e.ColumnId,this.api.gridApi.getColumns())){var t=this.gridOptions.columnApi.getColumn(e.ColumnId);t.getColDef().cellRenderer=null;var i=t.getColDef();i.cellRenderer=null,"number-cell-changed"==i.cellClass&&(i.cellClass="number-cell")}},e.prototype.onRowDataChanged=function(e){var t=this,i=e.rowNode,o=e.oldData,n=e.newData;if(null!=o&&void 0!=o&&o!=n){var r=this.getPrimaryKeyValueFromRowNode(i);Object.keys(o).forEach((function(e){var a=o[e],l=n[e];if(a!=l){var s={OldValue:a,NewValue:l,ColumnId:e,PrimaryKeyValue:r,RowNode:i};t.performPostEditChecks(s,!1,!1)}}))}},e.prototype.performPostEditChecks=function(e,t,i){this.AuditLogService.isAuditCellEditsEnabled&&this.AuditLogService.addEditCellAuditLog(e),this.FreeTextColumnService.CheckIfDataChangingColumnIsFreeText(e),this.DataService.CreateDataChangedEvent(e),t&&this.filterOnUserDataChange([e.RowNode]),i&&this.filterOnExternalDataChange([e.RowNode]),this.checkChangedCellCurrentlySelected(e)},e.prototype.checkChangedCellCurrentlySelected=function(e){var t=this.api.gridApi.getSelectedCellInfo();t&&V.ArrayExtensions.IsNotNullOrEmpty(t.GridCells)&&(t.GridCells.find((function(t){return t.primaryKeyValue==e.PrimaryKeyValue&&t.columnId==e.ColumnId}))&&this.setSelectedCells());var i=this.api.gridApi.getSelectedRowInfo();i&&V.ArrayExtensions.IsNotNullOrEmpty(i.GridRows)&&(i.GridRows.find((function(t){return t.primaryKeyValue==e.PrimaryKeyValue}))&&this.setSelectedRows())},e.prototype.editPercentBar=function(e){this.removePercentBar(e),this.addPercentBar(e)},e.prototype.editGradientColumn=function(e){this.removeGradientColumn(e),this.addGradientColumn(e)},e.prototype.editSparklineColumn=function(e){this.removeSparklineColumn(e),this.addSparklineColumn(e)},e.prototype.onSortChanged=function(){var e=this,t=this.gridOptions.api.getSortModel(),i=[];V.ArrayExtensions.IsNotNullOrEmpty(t)&&t.forEach((function(t){w.ColumnHelper.isSpecialColumn(t.colId)&&e.agGridHelper.createGroupedColumnCustomSort();var o={Column:t.colId,SortOrder:"asc"==t.sort?b.SortOrder.Ascending:b.SortOrder.Descending};i.push(o)})),this.api.gridApi.setColumnSorts(i),this._emit("SortChanged",i)},e.prototype.expandAllRowGroups=function(){this.gridOptions.api.forEachNode((function(e){e.group&&(e.expanded=!0)})),this.gridOptions.api.onGroupExpandedOrCollapsed()},e.prototype.closeAllRowGroups=function(){this.gridOptions.api.forEachNode((function(e){e.group&&(e.expanded=!1)})),this.gridOptions.api.onGroupExpandedOrCollapsed()},e.prototype.expandRowGroupsForValues=function(e){V.ArrayExtensions.IsNotNullOrEmpty(e)&&(this.gridOptions.api.forEachNode((function(t){t.group&&!t.expanded&&V.ArrayExtensions.ContainsItem(e,t.key)&&t.setExpanded(!0)})),this.gridOptions.api.onGroupExpandedOrCollapsed())},e.prototype.getExpandRowGroupsKeys=function(){var e=[];return this.adaptableOptions.layoutOptions.includeOpenedRowGroups&&this.gridOptions.api.forEachNode((function(t){t.group&&t.expanded&&e.push(t.key)})),e},e.prototype.getRowCount=function(){return this.gridOptions.rowData?this.gridOptions.rowData.length:this.gridOptions.api.getDisplayedRowCount()},e.prototype.getColumnCount=function(){return this.gridOptions.columnApi.getAllColumns().length},e.prototype.getVisibleRowCount=function(){return this.gridOptions.api.getDisplayedRowCount()},e.prototype.getVisibleColumnCount=function(){return this.gridOptions.columnApi.getAllColumns().filter((function(e){return e.isVisible()})).length},e.prototype.selectColumns=function(e){var t=this;e.forEach((function(e){return t.selectColumn(e)}))},e.prototype.selectColumn=function(e){this.gridOptions.api.clearRangeSelection();var t={rowStartIndex:0,rowEndIndex:this.gridOptions.api.getDisplayedRowCount(),columnStart:e,columnEnd:e};this.gridOptions.api.addCellRange(t)},e.prototype.setColumnSort=function(e){var t=[];V.ArrayExtensions.IsNotNullOrEmpty(e)&&e.forEach((function(e){var i=e.SortOrder==b.SortOrder.Ascending?"asc":"desc";t.push({colId:e.Column,sort:i})})),this.gridOptions.api.setSortModel(t),this.gridOptions.api.onSortChanged()},e.prototype.setDataSource=function(e){this.gridOptions.api.setRowData(e)},e.prototype.loadDataSource=function(e){this.setDataSource(e);var t=this.api.layoutApi.getCurrentLayout();t&&t.AdaptableGridInfo&&V.ArrayExtensions.IsNotNullOrEmpty(t.AdaptableGridInfo.ExpandedRowGroupKeys)&&this.expandRowGroupsForValues(t.AdaptableGridInfo.ExpandedRowGroupKeys)},e.prototype.updateRows=function(e,t){(t=t||{}).batchUpdate?this.gridOptions.api.batchUpdateRowData({update:e},t.callback):this.gridOptions.api.updateRowData({update:e})},e.prototype.addRows=function(e){this.gridOptions.api.updateRowData({add:e})},e.prototype.deleteRows=function(e){this.gridOptions.api.updateRowData({remove:e})},e.prototype.updateQuickSearchRangeVisibleColumn=function(e){if(this.isInitialised){var t=this.api.quickSearchApi.getQuickSearchState();if(t.DisplayAction!=b.DisplayAction.HighlightCell&&F.StringExtensions.IsNotNullOrEmpty(t.QuickSearchText)){var i=w.ColumnHelper.getColumnFromId(e,this.api.gridApi.getColumns());if(!i.IsExcludedFromQuickSearch){var o=this.getState().System.QuickSearchRange;if(null!=o&&x.RangeHelper.IsColumnAppropriateForRange(o,i)){var n=D.ExpressionHelper.CreateSingleColumnExpression(i.ColumnId,null,null,null,[o]),r=[].concat(this.getState().System.QuickSearchVisibleColumnExpressions);r.push(n),this.AdaptableStore.TheStore.dispatch(m.QuickSearchSetVisibleColumnExpressions(r))}}}}},e.prototype.getFirstGroupedColumn=function(){var e=this.gridOptions.columnApi.getRowGroupColumns();if(V.ArrayExtensions.IsNotNullOrEmpty(e)){var t=e[0];return w.ColumnHelper.getColumnFromId(t.getColId(),this.api.gridApi.getColumns())}},e.prototype.checkColumnsDataTypeSet=function(){var e=this.api.gridApi.getColumns()[0];e&&e.DataType==b.DataType.Unknown&&this.setColumnIntoStore()},e.prototype.getVendorGridDefaultLayoutInfo=function(){return{GroupState:null,ColumnState:JSON.stringify(this.gridOptions.columnApi.getColumnState()),ColumnGroupState:JSON.stringify(this.gridOptions.columnApi.getColumnGroupState()),InPivotMode:this.gridOptions.pivotMode}},e.prototype.getVendorGridLayoutInfo=function(e){if(null!=this.adaptableOptions.layoutOptions&&null!=this.adaptableOptions.layoutOptions.includeVendorStateInLayouts&&this.adaptableOptions.layoutOptions.includeVendorStateInLayouts){var t=null,i=this.gridOptions.columnApi.getAllDisplayedColumns().find((function(e){return w.ColumnHelper.isSpecialColumn(e.getColId())}));i&&(t=i.getActualWidth());var o=this.gridOptions.columnApi.getColumnState();o.forEach((function(t){var i=t.colId;e.find((function(e){return e==i}))?t.hide=!1:t.hide=!0}));var n=this.gridOptions.columnApi.getColumnGroupState();return{GroupState:t,ColumnState:JSON.stringify(o),ColumnGroupState:V.ArrayExtensions.IsNotNullOrEmpty(n)?JSON.stringify(n):null,InPivotMode:this.gridOptions.columnApi.isPivotMode(),ValueColumns:this.gridOptions.columnApi.getValueColumns().map((function(e){return e.getColId()}))}}return null},e.prototype.setVendorGridLayoutInfo=function(e){if(e){if(e.ColumnState){var t=JSON.parse(e.ColumnState);t&&this.setColumnState(this.gridOptions.columnApi,t,"api")}if(e.GroupState){var i=e.GroupState;if(i){var o=this.gridOptions.columnApi.getColumn("ag-Grid-AutoColumn");o&&this.gridOptions.columnApi.setColumnWidth(o,i,!0)}}if(e.ColumnGroupState){var n=e.ColumnGroupState;n&&this.gridOptions.columnApi.setColumnGroupState(JSON.parse(n))}e.InPivotMode&&1==e.InPivotMode?this.gridOptions.columnApi.setPivotMode(!0):this.gridOptions.columnApi.setPivotMode(!1),V.ArrayExtensions.IsNotNullOrEmpty(e.ValueColumns)&&this.gridOptions.columnApi.setValueColumns(e.ValueColumns)}},e.prototype.setGroupedColumns=function(e){V.ArrayExtensions.IsNotNullOrEmpty(e)?this.gridOptions.columnApi.setRowGroupColumns(e):this.gridOptions.columnApi.setRowGroupColumns([]),1==this.adaptableOptions.layoutOptions.autoSizeColumnsInLayout&&this.gridOptions.columnApi.autoSizeAllColumns()},e.prototype.setPivotingDetails=function(e){this.LayoutService.isPivotedLayout(e)?(V.ArrayExtensions.IsNotNull(e.PivotColumns)&&this.gridOptions.columnApi.setPivotColumns(e.PivotColumns),V.ArrayExtensions.IsNotNull(e.AggregationColumns)&&this.gridOptions.columnApi.setValueColumns(e.AggregationColumns)):this.gridOptions.columnApi.setPivotMode(!1)},e.prototype.setPivotMode=function(e,t){null==t?this.LayoutService.isPivotedLayout(e)?this.turnOnPivoting():this.turnOffPivoting():t.InPivotMode&&1==t.InPivotMode?this.turnOnPivoting():this.turnOffPivoting()},e.prototype.turnOnPivoting=function(){this.gridOptions.columnApi.setPivotMode(!0)},e.prototype.turnOffPivoting=function(){this.gridOptions.columnApi.setPivotMode(!1)},e.prototype.setLayout=function(e){var t=this;e.Name===P.DEFAULT_LAYOUT?!0===this.adaptableOptions.layoutOptions.autoSizeColumnsInDefaultLayout&&this.gridOptions.columnApi.autoSizeAllColumns():!0===this.adaptableOptions.layoutOptions.autoSizeColumnsInLayout&&this.gridOptions.columnApi.autoSizeAllColumns(),V.ArrayExtensions.IsNotNullOrEmpty(e.AdaptableGridInfo.ExpandedRowGroupKeys)&&this.expandRowGroupsForValues(e.AdaptableGridInfo.ExpandedRowGroupKeys);var i=e.AdaptableGridInfo.CurrentColumnSorts;setTimeout((function(){t.setColumnSort(i)}),1e3)},e.prototype.setColumnVisible=function(e,t){this.gridOptions.columnApi.setColumnVisible(e,t)},e.prototype.setColumnOrder=function(e){if(this.gridOptions&&this.gridOptions.columnApi){this.gridOptions.columnApi.setColumnsVisible(e,!0);var t=this.gridOptions.columnApi.getAllDisplayedColumns().filter((function(e){return w.ColumnHelper.isSpecialColumn(e.getColId())}))[0];t&&(e=o.__spread([t.getColId()],e)),this.gridOptions.columnApi.moveColumns(e,0)}},e.prototype.setColumnState=function(e,t,i){e.setColumnState(t,i)},e.prototype.isSelectable=function(){return!(!this.agGridHelper.isModulePresent("range-selection")||null==this.gridOptions.enableRangeSelection||!this.gridOptions.enableRangeSelection)},e.prototype.isGroupable=function(){return!this.api.internalApi.isGridInTreeMode()},e.prototype.isPivotable=function(){return!this.api.internalApi.isGridInTreeMode()},e.prototype.isQuickFilterActive=function(){return!0===this.gridOptions.floatingFilter&&this.adaptableOptions.filterOptions.useAdaptableQuickFilter},e.prototype.showQuickFilter=function(){var e=this;this.adaptableOptions.filterOptions.useAdaptableQuickFilter&&(this.gridOptions.floatingFilter=!0,this.gridOptions.columnApi.getAllGridColumns().forEach((function(t){e.createQuickFilterWrapper(t)})),this.gridOptions.api.refreshHeader())},e.prototype.hideQuickFilter=function(){this.adaptableOptions.filterOptions.useAdaptableQuickFilter&&(this.gridOptions.floatingFilter=!1,this.gridOptions.api.refreshHeader())},e.prototype.applyAdaptableTheme=function(e){var t="string"===typeof e?e:e.Name,i=[],n=[],r=this.api.themeApi.getAllTheme().reduce((function(e,t){return e[t.Name]=t,e}),{}),a=document.documentElement;a.classList.forEach((function(e){if(0===e.indexOf(d.THEME_STYLE)){i.push(e);var t=e.substring(d.THEME_STYLE.length);r[t]&&n.push(r[t])}})),i.forEach((function(e){return a.classList.remove(e)})),this.adaptableOptions.userInterfaceOptions&&this.adaptableOptions.userInterfaceOptions.useCustomMacLikeScrollbars&&$.default()>0?a.classList.add("ab--custom-mac-like-scrollbars"):a.classList.remove("ab--custom-mac-like-scrollbars");var l=r[t],s=d.THEME_STYLE+t;a.classList.add(s);var u=getComputedStyle(a),p=o.__read(["--ab-loaded","--ab-theme-loaded"].map((function(e){var t=u.getPropertyValue(e);return"string"===typeof t&&t.trim&&(t=t.trim()),t})),2),c=p[0],h=p[1],m=!!this.api.themeApi.getAllSystemTheme().filter((function(e){return e.Name===t}))[0],g=this.getGridContainerElement();l&&m&&(t===P.LIGHT_THEME&&(l.VendorGridClassName=this.agGridHelper.getVendorLightThemeName()),t===P.DARK_THEME&&(l.VendorGridClassName=this.agGridHelper.getVendorDarkThemeName())),l.VendorGridClassName||(l.VendorGridClassName=this.agGridHelper.getVendorLightThemeName()),null!=g&&(n.length&&n.forEach((function(e){e.VendorGridClassName&&g.classList.remove(e.VendorGridClassName)})),l&&l.VendorGridClassName&&g.classList.add(l.VendorGridClassName),g.classList.add("ab-Grid"),this.adaptableOptions.filterOptions.indicateFilteredColumns&&g.classList.add("ab-Grid--indicate-filtered-columns")),"777"!==c&&R.LoggingHelper.LogError('Please import Adaptable styles from "adaptableadaptable/index.css"'),h!==t&&R.LoggingHelper.LogWarning('Theme "'+t+'" doesn\'t seem to be loaded! Make sure you import the css file for the "'+t+'" theme!\n\nIf it\'s a default theme, try\n\nimport "@adaptabletools/adaptable/themes/'+t+'.css"')},e.prototype.setUpRowStyles=function(){this.agGridHelper.setUpRowStyles()},e.prototype.clearRowStyles=function(){this.agGridHelper.clearRowStyles()},e.prototype.applyFinalRendering=function(){var e=this;this.gridOptions.defaultGroupSortComparator=this.agGridHelper.runAdaptableNodeComparerFunction();var t=this.api.userInterfaceApi.getUserInterfaceState().EditLookUpColumns;if(V.ArrayExtensions.IsNotNullOrEmpty(t)){var i=this.mapColumnDefs((function(i){return t.forEach((function(t){i.field===t.ColumnId&&(i.cellEditor="agRichSelectCellEditor",t.LookUpValues?i.cellEditorParams={values:e.api.userInterfaceApi.getEditLookUpValuesForColumn(t.ColumnId)}:i.cellEditorParams={values:e.getColumnValueDisplayValuePairDistinctList(t.ColumnId,b.DistinctCriteriaPairValue.DisplayValue,!1).map((function(e){return e.DisplayValue}))})})),i}));this.safeSetColDefs(i)}this.gridOptions.treeData&&1==this.gridOptions.treeData&&this.api.internalApi.setTreeModeOn(),this.isQuickFilterActive()&&(this.api.internalApi.showQuickFilterBar(),this.gridOptions.api.refreshHeader());var o=this.api.layoutApi.getCurrentLayoutName();this.agGridHelper.checkShouldClearExistingFiltersOrSearches(),o===P.DEFAULT_LAYOUT||F.StringExtensions.IsNullOrEmpty(o)?!0===this.adaptableOptions.layoutOptions.autoSizeColumnsInDefaultLayout&&this.gridOptions.columnApi.autoSizeAllColumns():this.api.layoutApi.setLayout(o),this.api.quickSearchApi.applyQuickSearch(this.api.quickSearchApi.getQuickSearchValue())},e.prototype.getState=function(){return this.AdaptableStore.TheStore.getState()},e.prototype.getGridOptionsApi=function(){if(this.gridOptions.api)return this.gridOptions.api;R.LogAdaptableError("There is a problem with your instance of ag-Grid - it has no gridApi object.  Please contact Support.")},e.prototype.getUserFunctionHandler=function(e,t){var i,n;try{for(var r=o.__values(this.adaptableOptions.userFunctions),a=r.next();!a.done;a=r.next()){var l=a.value;if(l.type===e&&l.name===t)return l.handler}}catch(s){i={error:s}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return null},e.prototype.exportToExcel=function(e,t,i){var o=t.map((function(e){return e.ColumnId})),r={columnDefs:t.map((function(e){return{field:e.ColumnId,headerName:e.FriendlyName}})),rowData:i.map((function(e){return l.zipObject(o,e)}))},a=new n.Grid(document.createElement("div"),r);r.api.exportDataAsExcel({sheetName:"Sheet 1",fileName:e.Name}),a.destroy()},e.prototype.exportVisibleToClipboard=function(e){this.gridOptions.api.selectAllFiltered(),this.gridOptions.api.copySelectedRowsToClipboard(!0),this.gridOptions.api.deselectAll()},e.prototype.exportVisibleToExcel=function(e){this.gridOptions.api.exportDataAsExcel({sheetName:"Sheet 1",fileName:e.Name})},e.prototype.exportVisibleToCsv=function(e){this.gridOptions.api.exportDataAsCsv({fileName:e.Name})},e}();t.Adaptable=re;var ae=function(){function e(e,t){void 0===t&&(t={});this.adaptableOptions=e,this.init=t.onInit||function(e){var t=e.gridOptions,i=e.adaptableOptions;return i.vendorGrid=t,new re(i)},this.extraOptions=t,this.render()}return e.prototype.render=function(e){var t=this,i=J.DefaultAdaptableOptions.containerOptions.adaptableContainer||"adaptable";if(e||this.adaptableOptions.containerOptions&&(i=this.adaptableOptions.containerOptions.adaptableContainer||"adaptable"),!(e=e||document.getElementById(i)))throw new Error("Cannot find container in which to render Adaptable No Code Wizard");e.classList.add("adaptable--in-wizard"),r.render(a.createElement(B.default,o.__assign(o.__assign({adaptableOptions:this.adaptableOptions},this.extraOptions),{onInit:function(i){e.classList.remove("adaptable--in-wizard"),r.unmountComponentAtNode(e),void 0===t.init({adaptableOptions:i,gridOptions:i.vendorGrid})&&new re(i)}})),e)},e}();t.AdaptableNoCodeWizard=ae}}]);
(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[7],{ydiI:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptableNoCodeWizard=t.Adaptable=void 0;var n=i("mrSG"),o=i("DR3G"),r=i("i8i4"),a=i("q1tI"),l=i("UXvI"),s=i("hbEN"),u=i("lE2N"),p=i("8QLk"),d=i("6LPd"),c=i("Muja"),h=i("F9nB"),f=i("QIb0"),m=i("7VOM"),g=i("MbTd"),C=i("0J2a"),v=i("+UTi"),y=i("5wQp"),O=i("KOcV"),E=i("SF8o"),A=i("u3yE"),S=i("UQRY"),I=i("adxL"),b=i("CUPq"),w=i("YKwl"),N=i("RQz/"),F=i("UtRb"),D=i("pBDx"),R=i("qN6A"),G=i("zwJd"),_=i("z1Bd"),V=i("EYOP"),L=i("fwGq"),x=i("pioK"),P=i("n6u+"),T=i("kVrw"),M=i("W07B"),H=i("w5Eo"),k=i("yRSI"),U=i("j9Nh"),K=i("vk8B"),B=i("+0VI"),W=i("OwXO"),z=i("2WK/"),Q=i("02Nn"),j=i("U/tm"),Y=i("DR3G"),q=i("vs66"),J=i("1f9d"),X=i("fkJU"),Z=i("YzQ+");Y.ModuleRegistry.registerModules(Y.AllCommunityModules);var $=o.RowNode.prototype,ee=$.dispatchLocalEvent,te=function(e,t,i){e.forEach((function(e,n,o){e.children?te(e.children,t,e):t(e,n,o,i)}))},ie={},ne=function(){function t(){var t=this;this.calculatedColumnPathMap=new Map,this.originalColDefValueFormatters={},this._on=function(e,i){return t.emitter.on(e,i)},this._emit=function(e,i){return t.emitter.emit(e,i)},this.isPluginLoaded=function(e){for(var i=t.adaptableOptions.plugins||[],n=0,o=i.length;n<o;n++){if(i[n].pluginId===e)return!0}return!1},this.debouncedSetColumnIntoStore=s.default((function(){t.gridOptions.api&&t.updateColumnsIntoStore()}),L.HALF_SECOND),this.debouncedSaveGridLayout=s.default((function(){t.gridOptions.api&&t.saveGridLayout()}),L.HALF_SECOND),this.debouncedSetSelectedCells=s.default((function(){t.gridOptions.api&&t.setSelectedCells()}),250),this.debouncedSetSelectedRows=s.default((function(){t.gridOptions.api&&t.setSelectedRows()}),L.HALF_SECOND),this.debouncedFilterGrid=s.default((function(){t.gridOptions.api&&t.applyGridFiltering()}),L.HALF_SECOND),this.mapColumnDefs=function(e,i){i=i||{removeEmpty:!1};var n=t.getColumnDefs();return te(n,(function(t,n,o,r){var a=e(t,n,o),l=r?r.children:o;l[n]=a,n===o.length-1&&i.removeEmpty&&r&&(r.children=l.filter((function(e){return!!e})))})),i.removeEmpty&&(n=n.filter((function(e){return!!e}))),n},this.getColumnDefs=function(){return t.gridOptions.columnApi.getAllColumns().map((function(e){return e.getColDef()}))},this.getColumnDefsWithCorrectVisibility=function(){var e=t.api.layoutApi.getCurrentVisibleColumnIdsMap();return t.gridOptions.columnApi.getAllColumns().map((function(t){var i=t.getColDef(),n=t.getColId();return i.colId=n,i.hide=!e[n],i}))},this.cachePreviousColDefInfo=function(e,t){var i=e;i.__ab=i.__ab||{},i.__ab[t]=i[t]},this.getPreviousColDefInfo=function(e){return e.__ab||{}},e.adaptable=this}return t.init=function(e){return t.initInternal(e)},t.initInternal=function(e,i){var o,r;return n.__awaiter(this,void 0,void 0,(function(){var a,l,s,u;return n.__generator(this,(function(p){switch(p.label){case 0:if({renderGrid:void 0,runtimeConfig:null},!Array.isArray(e.plugins))return[3,13];p.label=1;case 1:p.trys.push([1,7,8,13]),a=n.__asyncValues(e.plugins),p.label=2;case 2:return[4,a.next()];case 3:return(l=p.sent()).done?[3,6]:[4,l.value.beforeInit(e)];case 4:p.sent(),p.label=5;case 5:return[3,2];case 6:return[3,13];case 7:return s=p.sent(),o={error:s},[3,13];case 8:return p.trys.push([8,,11,12]),l&&!l.done&&(r=a.return)?[4,r.call(a)]:[3,10];case 9:p.sent(),p.label=10;case 10:return[3,12];case 11:if(o)throw o.error;return[7];case 12:return[7];case 13:return[2,(u=new t).init(e,i,!0).then((function(t){return Array.isArray(e.plugins)&&e.plugins.forEach((function(e){e.afterInit(u)})),t}))]}}))}))},t.collectInstance=function(e){e._id=e.adaptableOptions.adaptableId||H.createUuid(),ie[e._id]=e},t.forEachAdaptable=function(e){Object.keys(ie).forEach((function(t){e(ie[t])}))},t.dismissInstance=function(e){delete ie[e._id]},t.prototype.init=function(e,i,o){return n.__awaiter(this,void 0,void 0,(function(){var a=this;return n.__generator(this,(function(s){return o||D.LoggingHelper.LogAdaptableWarning('\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!!! You should not use the "Adaptable" constructor directly, as it was deprecated in v6 and removed in v7!\n!!!!!!!\n!!!!!!! Use const api = await Adaptable.init(adaptableOptions) instead.\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'),this.emitter=new h.default,this.adaptableOptions=j.default.assignadaptableOptions(e),t.collectInstance(this),j.default.CheckadaptableOptions(this.adaptableOptions),this.runtimeConfig=i||{},this.gridOptions=this.adaptableOptions.vendorGrid,void 0===this.gridOptions.allowContextMenuWithControlKey&&(this.gridOptions.allowContextMenuWithControlKey=!0),this.vendorGridName="agGrid",this.isInitialised=!1,this.useRowNodeLookUp=!1,this.forPlugins((function(e){return e.afterInitOptions(a,a.adaptableOptions)})),this.api=new V.AdaptableApiImpl(this),this.forPlugins((function(e){return e.afterInitApi(a,a.api)})),this.DataService=new O.DataService(this),this.AuditLogService=new v.AuditLogService(this),this.agGridHelper=new x.agGridHelper(this,this.gridOptions),this.initStore(),this.ValidationService=new E.ValidationService(this),this.StyleService=new y.StyleService(this),this.ChartService=new A.ChartService(this),this.FreeTextColumnService=new S.FreeTextColumnService(this),this.ScheduleService=new T.ScheduleService(this),this.SearchService=new M.SearchService(this),this.ReportService=new B.ReportService(this),this.LayoutService=new z.LayoutService(this),this.StrategyService=new W.StrategyService(this),this.CalculatedColumnExpressionService=new I.CalculatedColumnExpressionService(this),this.forPlugins((function(e){return e.afterInitServices(a)})),this.strategies=this.agGridHelper.setUpStrategies(),this.forPlugins((function(e){return e.afterInitStrategies(a,a.strategies)})),this.gridOptions.api&&(this.gridOptions.api.__adaptable=this),[2,this.initializeAgGrid().then((function(e){return e?(a.gridOptions.api&&(a.gridOptions.api.__adaptable=a),a.adaptableStore.Load.then((function(){return a.strategies.forEach((function(e){return e.initializeWithRedux()}))}),(function(e){D.LoggingHelper.LogAdaptableError("Failed to Init AdaptableStore : ",e),a.strategies.forEach((function(e){return e.initializeWithRedux()})),a.api.internalApi.hideLoadingScreen()})).then((function(){return a.initInternalGridLogic()}),(function(e){D.LoggingHelper.LogAdaptableError("Failed to Init Strategies : ",e),a.initInternalGridLogic(),a.api.internalApi.hideLoadingScreen()})).then((function(){return n.__awaiter(a,void 0,void 0,(function(){return n.__generator(this,(function(e){return this.isInitialised=!0,this.api.internalApi.hideLoadingScreen(),[2]}))}))})),null==a.abContainerElement&&(a.abContainerElement=a.getadaptableContainerElement()),null!=a.abContainerElement&&(a.abContainerElement.innerHTML="",r.render(f.AdaptableApp({Adaptable:a}),a.abContainerElement)),a.throttleOnDataChangedUser=l.default(a.applyDataChange,a.adaptableOptions.filterOptions.filterActionOnUserDataChange.ThrottleDelay),a.throttleOnDataChangedExternal=l.default(a.applyDataChange,a.adaptableOptions.filterOptions.filterActionOnExternalDataChange.ThrottleDelay),a.api):(D.LoggingHelper.LogAdaptableError("Unable to set up ag-Grid"),a.api)}))]}))}))},t.prototype.forPlugins=function(e){Array.isArray(this.adaptableOptions.plugins)&&this.adaptableOptions.plugins.forEach((function(t){e(t)}))},t.prototype.getPlugin=function(e){var t=(this.adaptableOptions.plugins||[]).filter((function(t){return t.pluginId===e}))[0];if(!t)throw'Cannot find plugin "'+e+'". Make sure you spelled it right!';return t},t.prototype.getPluginProperty=function(e,t){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var r=this.adaptableOptions.plugins||[],a=r.filter((function(t){return t.pluginId===e}))[0];if(!a)throw'Cannot find plugin "'+e+'". Make sure you spelled it right!';if(a&&a.hasProperty(t))return a.getProperty(t).apply(void 0,n.__spread(i))},t.prototype.lookupPlugins=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];for(var o=this.adaptableOptions.plugins||[],r=0,a=o.length;r<a;r++){var l=o[r];if(l.hasProperty(e))return l.getProperty(e).apply(void 0,n.__spread(t))}},t.prototype.initStore=function(){var e=this;this.adaptableStore=new C.AdaptableStore(this),this.adaptableStore.onAny((function(t,i){e.forPlugins((function(n){return n.onStoreEvent(t,i,e.adaptableStore)})),t==C.INIT_STATE&&(e.forPlugins((function(t){return t.onAdaptableReady(e,e.adaptableOptions)})),e.api.eventApi.emit("AdaptableReady",{adaptableApi:e.api,vendorGrid:e.adaptableOptions.vendorGrid}))}))},t.prototype.initializeAgGrid=function(){var e=this;if(this.useRowNodeLookUp=this.agGridHelper.TrySetUpNodeIds(),Array.isArray(this.gridOptions.columnDefs)){var t=function(e){e&&(e.field&&!e.colId&&(e.colId=e.field),e.children?e.children.forEach(t):e.colId||D.LoggingHelper.LogAdaptableWarning("A column is missing the colId - please check ",e,'Either pass a "field" property or a "colId" property.'))};this.gridOptions.columnDefs.forEach(t)}if(this.adaptableOptions.userInterfaceOptions.showAdaptableToolPanel&&this.gridOptions.sideBar){this.gridOptions.sideBar=this.gridOptions.sideBar||{},this.gridOptions.components=this.gridOptions.components||{};var i=this.gridOptions.sideBar;if(!0===i)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!0,!0);else if("columns"===i)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!1,!0);else if("filters"===i)this.gridOptions.sideBar=this.agGridHelper.createAdaptableSideBarDefs(!0,!1);else{var n=this.gridOptions.sideBar;n&&(n.toolPanels=n.toolPanels||[],n.toolPanels.push(this.agGridHelper.createAdaptableToolPanel()))}this.gridOptions.components.AdaptableToolPanel=P.getAdaptableToolPanelAgGridComponent(this),this.gridOptions.api&&this.gridOptions.api.setSideBar(this.gridOptions.sideBar)}var r,a=function(){var t=e.getGridContainerElement();return!(!t&&!(t=e.initVendorContainerFromInitializedAgGrid()))||(D.LoggingHelper.LogAdaptableError("You must provide an element id in `containerOptions.vendorContainer`"),!1)};if(this.gridOptions.api&&"function"===typeof this.gridOptions.api.getValue)return a()?Promise.resolve(!0):Promise.resolve(!1);if(this.runtimeConfig.waitForAgGrid)return function(e){var t=Date.now();return e()?Promise.resolve():new Promise((function(i,n){var o=function(i){var r=e();if(Date.now()-t>5e4)return console.warn("Could not find any agGrid instance rendered."),void n("Could not find any agGrid instance rendered.");r?i():requestAnimationFrame((function(){o(i)}))};o(i)}))}((function(){return!!e.gridOptions.api})).then((function(){return e.initVendorContainerFromInitializedAgGrid(),Promise.resolve(!0)}));if(!a())return Promise.resolve(!1);var l=(this.adaptableOptions.vendorGrid||{}).modules||[],s=this.getGridContainerElement();return this.gridOptions.modules&&delete this.gridOptions.modules,r=new o.Grid(s,this.gridOptions,{modules:l}),this.gridOptions.api&&(this.gridOptions.api.__adaptable=this),Promise.resolve(null!=r)},t.prototype.initVendorContainerFromInitializedAgGrid=function(){if(!this.getGridContainerElement()){for(var e,t=this.gridOptions.api&&this.gridOptions.api.gridOptionsWrapper&&this.gridOptions.api.gridOptionsWrapper.layoutElements||[],i=0,n=t.length;i<n;i++){var o=t[i];if(o&&o.matches(".ag-root-wrapper")){var r=o.closest('[class*="ag-theme"]');if(r){e=r;break}}}return e||console.error("Could not find the agGrid vendor container. This will probably break some AdapTable functionality."),this.adaptableOptions.containerOptions.vendorContainer=e}},t.prototype.filterOnUserDataChange=function(e){this.adaptableOptions.filterOptions.filterActionOnUserDataChange.RunFilter==N.FilterOnDataChangeOptions.Always?this.applyDataChange(e):this.adaptableOptions.filterOptions.filterActionOnUserDataChange.RunFilter==N.FilterOnDataChangeOptions.Throttle&&this.throttleOnDataChangedUser(e)},t.prototype.filterOnExternalDataChange=function(e){this.adaptableOptions.filterOptions.filterActionOnExternalDataChange.RunFilter==N.FilterOnDataChangeOptions.Always?this.applyDataChange(e):this.adaptableOptions.filterOptions.filterActionOnExternalDataChange.RunFilter==N.FilterOnDataChangeOptions.Throttle&&this.throttleOnDataChangedExternal(e)},t.prototype.createFilterWrapper=function(e){this.gridOptions.api.destroyFilter(e),this.gridOptions.api.getColumnDef(e).filter=b.FilterWrapperFactory(this),e.initialise()},t.prototype.createQuickFilterWrapper=function(e){var t=this.gridOptions.api.getColumnDef(e);t&&(t.floatingFilterComponentParams={suppressFilterButton:!0},t.floatingFilterComponent=w.FloatingFilterWrapperFactory(this))},t.prototype.applyGridFiltering=function(){this.api.filterApi.isQuickFilterAvailable()&&(this.api.filterApi.isQuickFilterVisible()?this.showQuickFilter():this.hideQuickFilter()),this.gridOptions.api.onFilterChanged(),this._emit("SearchApplied"),this._emit("GridFiltered"),this.setSelectedCells(),this.setSelectedRows()},t.prototype.applyDataChange=function(e){var t=this;if(this.gridOptions.api){var i=e.filter((function(e){return!t.isGroupRowNode(e)})).filter((function(e){return t.isDataInModel(e)})).map((function(e){return e.data}));G.ArrayExtensions.IsNotNullOrEmpty(i)&&this.gridOptions.api.applyTransaction({update:i})}},t.prototype.isGroupRowNode=function(e){return!!e&&(!!e.isEmptyRowGroupNode()||(!(!e.group||!0!==e.group)||!(!e.leafGroup||!0!==e.leafGroup)))},t.prototype.isDataInModel=function(e){if(!e)return!1;var t=e.data[this.adaptableOptions.primaryKey];return!!t&&!!this.getRowNodeForPrimaryKey(t)},t.prototype.isPinnedRowNode=function(e){return!!e&&!!e.isRowPinned()},t.prototype.clearGridFiltering=function(){this.gridOptions.columnApi.getAllColumns().forEach((function(e){e.setFilterActive(!1)}))},t.prototype.clearColumnFiltering=function(e){var t=this;e.forEach((function(e){var i=t.gridOptions.columnApi.getAllColumns().find((function(t){return t.getColId()==e}));i&&i.setFilterActive(!1)}))},t.prototype.hideFilterForm=function(){this.hideFilterFormPopup&&this.hideFilterFormPopup()},t.prototype.updateColumnsIntoStore=function(){var e=this,t=[];this.gridOptions.columnApi.getAllColumns().forEach((function(i){var n=i.getColId();e.api.columnApi.isRowGroupColumn(n)||t.push(e.createAdaptableColumn(i))})),this.api.internalApi.setColumns(t)},t.prototype.createAdaptableColumn=function(e){var t=this.agGridHelper.createAdaptableColumnFromVendorColumn(e);return this.applyStylingToColumn(e,t),t},t.prototype.applyStylingToColumn=function(e,t){var i=e.getColDef();if(!i.__styleApplied){i.__styleApplied=!0,i.filter&&this.adaptableOptions.filterOptions.useAdaptableFilterForm&&this.createFilterWrapper(e),i.floatingFilter&&this.adaptableOptions.filterOptions.useAdaptableQuickFilter&&this.createQuickFilterWrapper(e);var n=this.getQuickSearchClassName();null==t&&(t=this.api.columnApi.getColumnFromId(e.getColId())),t&&this.addQuickSearchStyleToColumn(t,n)}},t.prototype.safeSetColDefs=function(e){var t=this;this.gridOptions.api.setColumnDefs(e),this.updateColumnsIntoStore(),this.gridOptions.columnApi.getAllGridColumns().forEach((function(e){var i=t.api.columnApi.getColumnFromId(e.getColId());i&&t.applyStylingToColumn(e,i)}))},t.prototype.getQuickSearchClassName=function(){return R.StringExtensions.IsNotNullOrEmpty(this.api.quickSearchApi.getQuickSearchStyle().ClassName)?this.api.quickSearchApi.getQuickSearchStyle().ClassName:this.StyleService.CreateStyleName(m.QuickSearchStrategyId)},t.prototype.addQuickSearchStyleToColumn=function(e,t){var i=this.api,n={};n[t]=function(t){if(e.IsExcludedFromQuickSearch)return!1;if(t.node&&!t.node.group){var n=i.quickSearchApi.getQuickSearchValue();if(R.StringExtensions.IsNotNullOrEmpty(n)){var o=X.default.CreateColumnFilter(e.ColumnId,"Contains",[n]);return i.filterApi.evaluateColumnFilter(o,t.node)}}return!1},this.setCellClassRules(n,e.ColumnId,"QuickSearch")},t.prototype.getPrimaryKeyValueFromRowNode=function(e){var t,i,n=this.getGridOptionsApi();return n&&(i=n.getValue(this.adaptableOptions.primaryKey,e)),null===i&&e&&e.data&&(i=null!==(t=e.data[this.adaptableOptions.primaryKey])&&void 0!==t?t:null),i},t.prototype.gridHasCurrentEditValue=function(){return!!this._currentEditor},t.prototype.getCurrentCellEditValue=function(){return this._currentEditor?this._currentEditor.getValue():""},t.prototype.getActiveCell=function(){var e=this.gridOptions.api.getFocusedCell();if(e){var t=this.gridOptions.api.getModel().getRow(e.rowIndex);if(t&&!this.isGroupRowNode(t)){var i=e.column.getColId(),n=this.getCellValueFromRowNode(t,i);return{columnId:i,primaryKeyValue:this.getPrimaryKeyValueFromRowNode(t),rawValue:n.RawValue,displayValue:n.DisplayValue}}}},t.prototype.getSortedColumnStateForVisibleColumns=function(e,t){var i=this;t=t||this.gridOptions.columnApi.getColumnState();var o=e.reduce((function(e,t,i){return e[t]=i,e}),{}),r=t.reduce((function(e,t,i){return e[t.colId]=i,e}),{}),a=e.reduce((function(e,t,i){return e[t]=i,e}),{});return n.__spread(t).sort((function(e,t){var n=e.colId,o=t.colId,l=r[n],s=r[o];return i.api.columnApi.isRowGroupColumn(n)?-1:i.api.columnApi.isRowGroupColumn(o)?1:null!=a[n]&&null==a[o]?-1:null==a[n]&&null!=a[o]?1:null==a[n]&&null==a[o]?l-s:a[e.colId]-a[t.colId]})).map((function(e){return n.__assign(n.__assign({},e),{hide:null==o[e.colId]})}))},t.prototype.setColumnOrder=function(e){var t=this.getSortedColumnStateForVisibleColumns(e);this.gridOptions.columnApi.setColumnState(t),this.updateColumnsIntoStore()},t.prototype.persistLayout=function(e){this.api.layoutApi.shouldAutoSaveLayout(e)?this.api.layoutApi.saveLayout(e):this.api.internalApi.updateCurrentDraftLayout(e)},t.prototype.setLayout=function(e){var t,i,o,r,a,l,s=this;e||(e=this.api.layoutApi.getCurrentLayout()),e.Columns=e.Columns||[];var u=e.Columns.reduce((function(e,t){return e[t]=!0,e}),{}),p=this.gridOptions.columnApi.getColumnState(),d={},h=p.reduce((function(e,t,i){return d[t.colId]=i,e[t.colId]=t,e}),{}),f=(e.RowGroupedColumns||[]).reduce((function(e,t,i){return e[t]=i,e}),{}),m={},g=e.AggregationColumns||{},C=n.__spread(e.PivotColumns||[],Object.keys(e.AggregationColumns||{})),v=e.EnablePivot?C||[]:e.Columns;C.length&&e.RowGroupedColumns&&C.push.apply(C,n.__spread(e.RowGroupedColumns));var y=!1,O={},E=this.getSortedColumnStateForVisibleColumns(v,p).map((function(t){var i,o,r,a,l=t.colId,p=h[l],d=!u[l],C=n.__assign(n.__assign({},p),{hide:d});e.ColumnWidthMap&&null!=e.ColumnWidthMap[l]?C.width=e.ColumnWidthMap[l]:O[l]=!0,C.rowGroupIndex=null!=f[l]?f[l]:null;var v=!!e.PinnedColumnsMap&&e.PinnedColumnsMap[l];if(v&&(C.pinned=v),C.pivotIndex=null,null!=m[l]&&(C.pivotIndex=m[l]),C.aggFunc=null,null!=g[l]){var E=null===(o=null===(i=s.gridOptions)||void 0===i?void 0:i.api)||void 0===o?void 0:o.getColumnDef(l);C.aggFunc=!0===g[l]?null!==(a=null!==(r=t.aggFunc)&&void 0!==r?r:null===E||void 0===E?void 0:E.aggFunc)&&void 0!==a?a:"sum":g[l]}return y=y||!c.default(C,p),C})).filter((function(e){return!!e}));if(!y){var A=function(e){return e.colId+"-"+e.rowGroupIndex+"-"+e.pivotIndex+"-"+e.aggFunc+"-"+e.pinned+"-"+e.width+"-"+e.hide},S=p.map(A).join(","),I=E.map(A).join(",");y=I!=S}var b=this.gridOptions.api.getSortModel(),w=(null!==(t=e.ColumnSorts)&&void 0!==t?t:[]).map((function(e){var t=e.ColumnId;return u[t]?{colId:t,sort:"Asc"===e.SortOrder?"asc":"desc"}:null})).filter((function(e){return!!e})),N=c.default(b,w),F=!!e.EnablePivot,D=this.gridOptions.columnApi.isPivotMode()!==F;y=y||!N||D,G.ArrayExtensions.IsNotNullOrEmpty(e.ExpandedRowGroupValues)&&this.adaptableOptions.layoutOptions.includeExpandedRowGroups&&this.expandRowGroupsForValues(e.ExpandedRowGroupValues),y&&(this.gridOptions.columnApi.setColumnState(E),this.gridOptions.api.setSortModel(w),D&&this.gridOptions.columnApi.setPivotMode(F),this.gridOptions.columnApi.setPivotColumns(e.PivotColumns||[]),this.updateColumnsIntoStore());var R=Object.keys(O);if(F&&(null===(o=null===(i=this.adaptableOptions)||void 0===i?void 0:i.layoutOptions)||void 0===o?void 0:o.autoSizeColumnsInPivotLayout))return requestAnimationFrame((function(){s.gridOptions.columnApi.autoSizeAllColumns()})),void setTimeout((function(){var e;null===(e=s.gridOptions.columnApi)||void 0===e||e.autoSizeAllColumns(),setTimeout((function(){var e;null===(e=s.gridOptions.columnApi)||void 0===e||e.autoSizeAllColumns()}),200)}),100);(null===(a=null===(r=this.adaptableOptions)||void 0===r?void 0:r.layoutOptions)||void 0===a?void 0:a.autoSizeColumnsInLayout)&&R.length&&(null===(l=this.gridOptions.columnApi)||void 0===l||l.autoSizeColumns(R)),this.api.layoutApi.fireLayoutUpdatedEvent(e)},t.prototype.updateLayoutFromGrid=function(){var e=this.api.layoutApi.getCurrentLayout(),t=n.__assign({},e),i=[],o={},r={},a=this.gridOptions.api.getSortModel().map((function(e){return{ColumnId:e.colId,SortOrder:"asc"===e.sort?"Asc":"Desc"}})),l=this.gridOptions.columnApi.getColumnState(),s=n.__spread(new Array(l.length)),u=n.__spread(new Array(l.length)),p=[],d={},c=l.reduce((function(e,t){var n=t.colId;return null!=t.width&&(e[n]=t.width),null!=t.flex&&(o[n]=t.flex),"left"===t.pinned&&(r[n]="left"),"right"===t.pinned&&(r[n]="right"),t.hide||i.push(n),null!=t.rowGroupIndex&&(s[t.rowGroupIndex]=n),null!=t.pivotIndex&&(u[t.pivotIndex]=n),t.aggFunc&&"string"===typeof t.aggFunc&&(d[n]=t.aggFunc),e}),{});this.gridOptions.columnApi.getPivotColumns().forEach((function(e){p.push(e.getColId())})),s=s.filter((function(e){return!!e})),u=u.filter((function(e){return!!e})),t.ColumnWidthMap=c,t.PinnedColumnsMap=r,t.Columns=i,t.ColumnSorts=a,t.RowGroupedColumns=s,Object.keys(d).length&&(t.AggregationColumns=d),t.EnablePivot=this.gridOptions.columnApi.isPivotMode(),t.PivotColumns=p,this.adaptableOptions.layoutOptions.includeExpandedRowGroups&&(t.ExpandedRowGroupValues=this.getExpandRowGroupsKeys()),this.api.layoutApi.fireLayoutUpdatedEvent(t),this.persistLayout(t)},t.prototype.saveGridLayout=function(){this.updateLayoutFromGrid()},t.prototype.setSelectedCells=function(){var e=this;if(this.isSelectable()){var t=this.gridOptions.api.getCellRanges(),i=[],o=[];if(!this.api.internalApi.isGridInPivotMode()){t&&t.forEach((function(t){var r,a,l=!0,s=null!=t.startRow.rowPinned,u=null!=t.endRow.rowPinned;if(s&&(u&&(l=!1),D.LoggingHelper.LogWarning("Cannot select pinned rows in ag-Grid.")),l){var p=Math.min(t.startRow.rowIndex,t.endRow.rowIndex),d=Math.max(t.startRow.rowIndex,t.endRow.rowIndex),c=function(t){if(null!=t){var n=t.getColId(),r=e.api.columnApi.getColumnFromId(n);r&&null==i.find((function(e){return e.ColumnId==r.ColumnId}))&&i.push(r);for(var a=p;a<=d;a++){var l=e.gridOptions.api.getModel().getRow(a);if(l&&!e.isPinnedRowNode(l)){var s=e.getPrimaryKeyValueFromRowNode(l),u=e.getCellValueFromRowNode(l,n),c={columnId:n,rawValue:u.RawValue,displayValue:u.DisplayValue,primaryKeyValue:s};o.push(c)}}}};try{for(var h=n.__values(t.columns),f=h.next();!f.done;f=h.next()){c(f.value)}}catch(m){r={error:m}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}}}));var r={Columns:i,GridCells:o};this.api.internalApi.setSelectedCells(r),this._emit("CellsSelected"),this.agGridHelper.fireSelectionChangedEvent()}}},t.prototype.setSelectedRows=function(){var e=this;if(this.isSelectable()){var t=this.gridOptions.api.getSelectedNodes(),i=[];if(!this.gridOptions.columnApi.isPivotMode()){G.ArrayExtensions.IsNotNullOrEmpty(t)&&t.forEach((function(t){var n={isMaster:!(null==t.master||1!=t.master),isExpanded:!(null==t.expanded||1!=t.expanded),isGroup:!(null==t.group||1!=t.group),level:t.level},o={primaryKeyValue:e.getPrimaryKeyValueFromRowNode(t),rowData:t.data,rowNode:null,rowInfo:n};i.push(o)}));var n={GridRows:i};this.api.internalApi.setSelectedRows(n),this._emit("RowsSelected"),this.agGridHelper.fireSelectionChangedEvent()}}},t.prototype.setValue=function(e,t){var i,n=this,o=this.api.columnApi.getColumnDataTypeFromColumnId(e.ColumnId);if(i=o==N.DataType.Number?Number(e.NewValue):e.NewValue,void 0!=o){if(e.RowNode)e.RowNode.setDataValue(e.ColumnId,i);else if(this.useRowNodeLookUp){var r=this.gridOptions.api.getRowNode(e.PrimaryKeyValue);null!=r&&(r.setDataValue(e.ColumnId,i),e.RowNode=r)}else{var a=!1;this.gridOptions.api.getModel().forEachNode((function(t){a||e.PrimaryKeyValue==n.getPrimaryKeyValueFromRowNode(t)&&(t.setDataValue(e.ColumnId,i),e.RowNode=t,a=!0)}))}this.performPostEditChecks(e,t,!t),t&&this.agGridHelper.reselectSelectedCells()}},t.prototype.cancelEdit=function(){this.gridOptions.api.stopEditing(!0)},t.prototype.getDistinctValuesForColumn=function(e,t){var i=this,n=[],o=this.api.userInterfaceApi.getPermittedValuesForColumn(e);return G.ArrayExtensions.IsNotNull(o)?n=o.map((function(e){return{RawValue:e,DisplayValue:e}})):t?this.gridOptions.api.forEachNodeAfterFilter((function(t){var o=i.addDistinctColumnValue(t,e.ColumnId);void 0!=o.RawValue&&n.push(o)})):this.gridOptions.api.forEachNode((function(t){var o=i.addDistinctColumnValue(t,e.ColumnId);void 0!=o.RawValue&&n.push(o)})),u.default(n,"DisplayValue").slice(0,this.adaptableOptions.queryOptions.maxColumnValueItemsDisplayed)},t.prototype.getColumnValueDisplayValuePairList=function(e,t,i){var n=this,o=[],r=new Map,a=this.api.columnApi.getColumnFromId(e),l=this.api.userInterfaceApi.getPermittedValuesForColumn(a);G.ArrayExtensions.IsNotNullOrEmpty(l)?l.forEach((function(e){r.set(e,{RawValue:e,DisplayValue:e})})):r=null;this.shouldUseRawValueForColumn(e);var s=function(e,t,a){if(e&&!n.isGroupRowNode(e)){var l=n.getCellValueFromRowNode(e,t),s=!r||r.has(l.DisplayValue);if(s&&i){var u=n.getPrimaryKeyValueFromRowNode(e);s=!!i[u]}s&&o.push(l)}};return t?this.gridOptions.api.forEachNodeAfterFilter((function(t){s(t,e)})):this.gridOptions.api.forEachNode((function(t){s(t,e)})),o.slice(0,this.adaptableOptions.queryOptions.maxColumnValueItemsDisplayed)},t.prototype.addDistinctColumnValue=function(e,t){if(e&&!this.isGroupRowNode(e)){var i=this.getCellValueFromRowNode(e,t);return _.Helper.objectExists(i)?i:void 0}},t.prototype.shouldUseRawValueForColumn=function(e){var t=this.gridOptions.api.getColumnDef(e);return!(!t||null==t.cellRenderer)||!!this.api.columnApi.isSpecialRenderedColumn(e)},t.prototype.getDisplayValue=function(e,t){var i,n=this;if(this.useRowNodeLookUp){var o=this.gridOptions.api.getRowNode(e),r=this.getCellValueFromRowNode(o,t);r&&(i=r.DisplayValue)}else{var a=!1;this.gridOptions.api.getModel().forEachNode((function(o){if(!a&&e==n.getPrimaryKeyValueFromRowNode(o)){var r=n.getCellValueFromRowNode(o,t);r&&(i=r.DisplayValue),a=!0}}))}return i},t.prototype.getCellValueFromRowNode=function(e,t){if(null!=e){var i=this.getRawValueFromRowNode(e,t);return{RawValue:i,DisplayValue:this.getDisplayValueFromRawValue(t,i)}}},t.prototype.getDisplayValueFromRowNode=function(e,t){var i=this.getCellValueFromRowNode(e,t);if(void 0!=i)return i.DisplayValue},t.prototype.getDisplayValueFromRawValue=function(e,t){if(this.api.columnApi.isSpecialRenderedColumn(e))return this.agGridHelper.getCleanValue(t);if(this.api.columnApi.isActionColumn(e))return this.agGridHelper.getCleanValue(t);var i=this.gridOptions.api.getColumnDef(e);if(i){if("function"==typeof i.valueFormatter){var n=this.gridOptions.columnApi.getAllColumns().find((function(t){return t.getColId()==e})),o=(0,i.valueFormatter)({value:t,node:null,data:null,colDef:i,column:n,api:this.gridOptions.api,columnApi:this.gridOptions.columnApi,context:this.gridOptions.context});return i.cellRenderer?this.agGridHelper.getRenderedValue(i,o):o||""}if(i.cellRenderer)return this.agGridHelper.getRenderedValue(i,t)}return this.agGridHelper.getCleanValue(t)},t.prototype.getRawValueFromRowNode=function(e,t){return this.gridOptions.api.getValue(t,e)},t.prototype.getDataRowFromRowNode=function(e){return null!=e&&void 0!=e?e.data:void 0},t.prototype.getRowNodeForPrimaryKey=function(e){var t=this;if(this.useRowNodeLookUp)return this.gridOptions.api.getRowNode(e);this.gridOptions.api.getModel().forEachNode((function(i){if(e==t.getPrimaryKeyValueFromRowNode(i))return i}))},t.prototype.getRowNodesForPrimaryKeys=function(e){var t=this,i=[];return this.useRowNodeLookUp?e.forEach((function(e){var n=t.gridOptions.api.getRowNode(e);n&&i.push(n)})):e.forEach((function(e){var n=!1;t.gridOptions.api.getModel().forEachNode((function(o){n||e!=t.getPrimaryKeyValueFromRowNode(o)||(i.push(o),n=!0)}))})),i},t.prototype.setCellClassRules=function(e,t,i){var n=this.gridOptions.columnApi.getColumn(t);if(n){var o=n.getColDef();if(o){this.cachePreviousColDefInfo(o,"cellClassRules");var r=o.cellClassRules;if(r){if("FormatColumn"==i)for(var a in r)a.includes(m.FormatColumnStrategyId)&&delete r[a];else if("ConditionalStyle"==i){var l=this.api.conditionalStyleApi.getAllConditionalStyle().map((function(e){return e.Style.ClassName}));for(var a in r)(a.includes(m.ConditionalStyleStrategyId)||G.ArrayExtensions.ContainsItem(l,a))&&delete r[a]}else if("QuickSearch"==i)for(var a in r)a.includes(m.QuickSearchStrategyId)&&delete r[a];else if("Alert"==i)for(var a in r)a.includes(g.ALERT_STYLE)&&delete r[a];else if("UpdatedRow"==i)for(var a in r)a.includes(g.UPDATED_ROW_NEUTRAL_STYLE)&&delete r[a];else if("FlashingCell"==i)for(var a in r)a.includes(g.FLASH_CELL_UP_STYLE)&&delete r[a],a.includes(g.FLASH_CELL_DOWN_STYLE)&&delete r[a];for(var a in e)r[a]=e[a]}else o.cellClassRules=e}}},t.prototype.setRowClassRules=function(e){this.gridOptions.rowClassRules=e},t.prototype.forAllRowNodesDo=function(e){this.gridOptions.api.getModel().forEachNode((function(t){e(t)}))},t.prototype.forAllVisibleRowNodesDo=function(e){this.gridOptions.api.forEachNodeAfterFilterAndSort((function(t){e(t)}))},t.prototype.selectNodes=function(e){var t=this;G.ArrayExtensions.IsNotNullOrEmpty(e)&&e.forEach((function(e){return t.selectNode(e)}))},t.prototype.selectNode=function(e){e?e.setSelected(!0,!0):D.LoggingHelper.LogAdaptableError("No node to select")},t.prototype.redraw=function(){this.gridOptions.api.redrawRows(),this.gridOptions.api.refreshHeader(),this._emit("GridRefreshed")},t.prototype.redrawRow=function(e){this.gridOptions.api.redrawRows({rowNodes:[e]})},t.prototype.refreshCells=function(e,t){var i={rowNodes:e,columns:t,force:!0};this.gridOptions.api.refreshCells(i)},t.prototype.jumpToRow=function(e){this.gridOptions.api.ensureNodeVisible(e,"middle")},t.prototype.jumpToColumn=function(e){this.gridOptions.api.ensureColumnVisible(e)},t.prototype.jumpToCell=function(e,t){this.jumpToRow(t),this.jumpToColumn(e)},t.prototype.editCalculatedColumnInGrid=function(e){var t=this,i=e.FriendlyName||e.ColumnId,n=this.getColumnDefs().find((function(t){return t.colId===e.ColumnId})),o=this.gridOptions.columnApi.getColumn(n.colId),r=this.CalculatedColumnExpressionService.CleanExpressionColumnNames(e.ColumnExpression,this.api.columnApi.getColumns());e.CalculatedColumnSettings&&(n.width=e.CalculatedColumnSettings.Width,n.enableValue=e.CalculatedColumnSettings.Aggregatable,n.filter=e.CalculatedColumnSettings.Filterable,n.resizable=e.CalculatedColumnSettings.Resizable,n.enableRowGroup=e.CalculatedColumnSettings.Groupable,n.sortable=e.CalculatedColumnSettings.Sortable,n.enablePivot=e.CalculatedColumnSettings.Pivotable),n.headerName=i,n.valueGetter=function(e){return t.CalculatedColumnExpressionService.ComputeExpressionValue(r,e.node)},n.type=this.agGridHelper.getAgGridDataType(e.CalculatedColumnSettings.DataType),n.tooltipValueGetter=function(){return null!=e.CalculatedColumnSettings.ShowToolTip&&1==e.CalculatedColumnSettings.ShowToolTip?r:void 0},o.setColDef(n,null),this.updateColumnsIntoStore()},t.prototype.tryRemoveCalculatedColumnFromGrid=function(e){var t,i;if(this.isSpecialColumnReferenced(e))return!1;var o=!1,r=this.mapColumnDefs((function(t){return t.headerName===e?(o=!0,null):t}),{removeEmpty:!0});o&&this.safeSetColDefs(r);try{for(var a=n.__values(this.calculatedColumnPathMap.values()),l=a.next();!l.done;l=a.next()){var s=l.value,u=s.indexOf(e);u>-1&&s.splice(u,1)}}catch(p){t={error:p}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}return!0},t.prototype.addCalculatedColumnToGrid=function(e){this.addCalculatedColumnsToGrid([e])},t.prototype.addCalculatedColumnsToGrid=function(e,t){var i=this;if(e.length){t=t||this.getColumnDefs();var o=this.api.columnApi.getColumns(),r=e.map((function(e){var t=i.CalculatedColumnExpressionService.CleanExpressionColumnNames(e.ColumnExpression,o);e.CalculatedColumnSettings||(e.CalculatedColumnSettings=X.CreateEmptyCalculatedColumn().CalculatedColumnSettings);var n={headerName:e.FriendlyName?e.FriendlyName:e.ColumnId,colId:e.ColumnId,hide:!0,editable:!1,width:e.CalculatedColumnSettings.Width,enableValue:e.CalculatedColumnSettings.Aggregatable,filter:e.CalculatedColumnSettings.Filterable,floatingFilter:e.CalculatedColumnSettings.Filterable,resizable:e.CalculatedColumnSettings.Resizable,enableRowGroup:e.CalculatedColumnSettings.Groupable,sortable:e.CalculatedColumnSettings.Sortable,enablePivot:e.CalculatedColumnSettings.Pivotable,type:i.agGridHelper.getAgGridDataType(e.CalculatedColumnSettings.DataType),valueGetter:function(e){return i.CalculatedColumnExpressionService.ComputeExpressionValue(t,e.node)}};return null!=e.CalculatedColumnSettings.ShowToolTip&&1==e.CalculatedColumnSettings.ShowToolTip&&(n.tooltipValueGetter=function(){return t}),n}));t.push.apply(t,n.__spread(r)),this.safeSetColDefs(t)}},t.prototype.isSpecialColumnReferenced=function(e){var t=[];return this.strategies.forEach((function(i){i.getSpecialColumnReferences(e,t)})),!!G.ArrayExtensions.IsNotNullOrEmpty(t)&&(this.api.alertApi.showAlertError("Cannot Delete the Column as it is referenced in:",t.join("\n")),!0)},t.prototype.addFreeTextColumnToGrid=function(e,t){this.addFreeTextColumnsToGrid([e],t)},t.prototype.addFreeTextColumnsToGrid=function(e,t){var i=this;if(e.length){t=t||this.getColumnDefs();var o=e.map((function(e){return{headerName:e.FriendlyName||e.ColumnId,colId:e.ColumnId,editable:!0,hide:!0,filter:!0,sortable:!0,resizable:!0,enableRowGroup:!0,cellEditor:e.TextEditor&&"Large"==e.TextEditor?"agLargeTextCellEditor":"agTextCellEditor",type:"abColDefString",valueSetter:function(t){return t.data[e.ColumnId]=t.newValue},valueGetter:function(t){return i.FreeTextColumnService.GetFreeTextValue(e,t.node)}}}));t.push.apply(t,n.__spread(o)),this.safeSetColDefs(t)}},t.prototype.tryRemoveFreeTextColumnFromGrid=function(e){if(this.isSpecialColumnReferenced(e))return!1;var t=!1,i=this.mapColumnDefs((function(i){return i.colId===e?(t=!0,null):i}),{removeEmpty:!0});return t&&this.safeSetColDefs(i),!0},t.prototype.editFreeTextColumnInGrid=function(e){var t=e.FriendlyName||e.ColumnId,i=this.getColumnDefs().find((function(t){return t.colId===e.ColumnId}));i&&i.headerName!==t&&this.gridOptions.columnApi.getColumn(i.colId).setColDef(n.__assign(n.__assign({},i),{headerName:t}),null);this.updateColumnsIntoStore()},t.prototype.addActionColumnsToGrid=function(e){if(e.length){var t=this.getColumnDefs(),i=e.map((function(e){return{headerName:e.FriendlyName?e.FriendlyName:e.ColumnId,colId:e.ColumnId,editable:!1,hide:!1,filter:!1,sortable:!1,resizable:!0,cellRenderer:k.ActionColumnRenderer,type:"abColDefObject"}}));t.push.apply(t,n.__spread(i)),this.safeSetColDefs(t)}},t.prototype.getFirstRowNode=function(){var e;return this.gridOptions.api.forEachNode((function(t){t.group||e||(e=t)})),e},t.prototype.destroy=function(e){this.gridOptions&&this.gridOptions.api&&(this.gridOptions.api.__adaptable=null,e&&!1===e.destroyApi||this.gridOptions.api.destroy()),this.rowListeners=null,this.emitter.clearListeners(),this.emitter=null,t.dismissInstance(this);var i=this.getadaptableContainerElement();e&&!e.unmount||null!=i&&r.unmountComponentAtNode(i)},t.prototype.getDefaultIPPStyle=function(){return{Header:{headerColor:"#000000",headerBackColor:"#f5f7f7",headerFontFamily:"sans-serif",headerFontSize:"12px",headerFontStyle:"normal",headerFontWeight:"400",height:65,Columns:this.api.columnApi.getColumns().map((function(e){return{columnFriendlyName:e.FriendlyName,width:200,textAlign:"start"}}))},Row:{color:"#000000",backColor:"#ffffff",altBackColor:"#fcfdfe",fontFamily:"sans-serif",fontSize:"12px",fontStyle:"normal",fontWeight:"400",height:30,Columns:this.api.columnApi.getColumns().map((function(e){return{columnFriendlyName:e.FriendlyName,width:200,textAlign:"start"}}))}}},t.prototype.getCurrentIPPStyle=function(){return this.agGridHelper.getCurrentIPPStyle()},t.prototype.getadaptableContainerElement=function(){if(!this.abContainerElement&&(this.abContainerElement=document.getElementById(this.adaptableOptions.containerOptions.adaptableContainer),!this.abContainerElement)){var e=document.getElementById("adaptableBlotter");e&&(D.LoggingHelper.LogAdaptableWarning('\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!! The old default container element for Adaptable was "#adaptableBlotter", configured via \'containerOptions.adaptableContainer="adaptableBlotter"\'.\n!!!!! Seems like you haven\'t updated your html container selector, so we\'re falling back to using that one.\n!!!!!\n!!!!! To make this warning go away, update your html structure and make sure you have an element with id="adaptable" in your app!\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n'),this.abContainerElement=e)}return this.abContainerElement},t.prototype.getGridContainerElement=function(){return this.gridContainerElement||(this.gridContainerElement="string"===typeof this.adaptableOptions.containerOptions.vendorContainer?document.getElementById(this.adaptableOptions.containerOptions.vendorContainer):this.adaptableOptions.containerOptions.vendorContainer),this.gridContainerElement},t.prototype.initInternalGridLogic=function(){var e=this;if(null==this.abContainerElement&&(this.abContainerElement=this.getadaptableContainerElement()),null!=this.abContainerElement){var i=this.getGridContainerElement();i&&i.addEventListener("keydown",(function(t){return e._emit("KeyDown",t)}));var r=[o.Events.EVENT_COLUMN_MOVED,o.Events.EVENT_GRID_COLUMNS_CHANGED,o.Events.EVENT_COLUMN_EVERYTHING_CHANGED,o.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,o.Events.EVENT_COLUMN_VISIBLE,o.Events.EVENT_NEW_COLUMNS_LOADED];this.gridOptions.api.addGlobalListener((function(t){r.indexOf(t)>-1&&(e.debouncedSetColumnIntoStore(),e.debouncedFilterGrid())})),this.gridOptions.api.addEventListener(o.Events.EVENT_FIRST_DATA_RENDERED,(function(){e.setLayout()})),this.gridOptions.api.addEventListener(o.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,(function(t){"columnPivotModeChanged"==t.type&&null!=t.columnApi&&null!=t.columnApi.columnController&&1==t.columnApi.columnController.pivotMode?(1==e.adaptableOptions.layoutOptions.autoSizeColumnsInPivotLayout&&e.gridOptions.columnApi.autoSizeAllColumns(),e.api.internalApi.setPivotModeOn()):e.api.internalApi.setPivotModeOff()})),this.gridOptions.api.addEventListener(o.Events.EVENT_COLUMN_PIVOT_CHANGED,(function(t){"columnPivotChanged"==t.type&&null!=t.columnApi&&null!=t.columnApi.columnController&&1==t.columnApi.columnController.pivotMode&&1==e.adaptableOptions.layoutOptions.autoSizeColumnsInPivotLayout&&e.gridOptions.columnApi.autoSizeAllColumns()}));var a=[o.Events.EVENT_COLUMN_PINNED,o.Events.EVENT_COLUMN_PIVOT_CHANGED,o.Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,o.Events.EVENT_DISPLAYED_COLUMNS_CHANGED,o.Events.EVENT_SORT_CHANGED,o.Events.EVENT_COLUMN_ROW_GROUP_CHANGED];this.gridOptions.api.addGlobalListener((function(t){a.indexOf(t)>-1&&e.debouncedSaveGridLayout()})),this.gridOptions.api.addEventListener(o.Events.EVENT_ROW_GROUP_OPENED,(function(t){e.adaptableOptions.layoutOptions.includeExpandedRowGroups&&e.debouncedSaveGridLayout()})),this.gridOptions.api.addEventListener(o.Events.EVENT_COLUMN_RESIZED,(function(t){e.gridOptions.api&&"columnResized"==t.type&&1==t.finished&&(t.column&&e._emit("ColumnResized",t.column.getColId()),e.debouncedSaveGridLayout())})),this.gridOptions.api.addEventListener(o.Events.EVENT_CELL_EDITING_STARTED,(function(t){if(!e.gridOptions.columnApi.isPivotMode()){var i=e.gridOptions.api.rowRenderer;if(i){var n=i.rowCompsByIndex[t.node.rowIndex];if(n){var r=n.cellComps[t.column.getColId()].cellEditor;r instanceof o.PopupEditorWrapper?e._currentEditor=r.cellEditor:e._currentEditor=r}}if(e._currentEditor){var a=e._currentEditor.isCancelAfterEnd;e._currentEditor.isCancelAfterEnd=function(){var i={OldValue:e.gridOptions.api.getValue(t.column.getColId(),t.node),NewValue:e._currentEditor.getValue(),ColumnId:t.column.getColId(),PrimaryKeyValue:e.getPrimaryKeyValueFromRowNode(t.node),RowNode:t.node};if(i.OldValue===i.NewValue)return!0;if(!e.ValidationService.PerformCellValidation(i))return!0;var n=function(){var t=!!a&&a();return t||e.performPostEditChecks(i,!1,!1),t};return(e.adaptableOptions.editOptions.validateOnServer?e.ValidationService.PerformServerValidation(i,{onServerValidationCompleted:n}):n)()}}}})),this.gridOptions.api.addEventListener(o.Events.EVENT_CELL_EDITING_STOPPED,(function(t){if(e._currentEditor=void 0,t&&t.node){var i=t.column;if(i){var n=e.api.columnApi.getColumnFromId(i.colId);if(n&&n.DataType==N.DataType.Number){var o=!0;if(G.ArrayExtensions.IsNotNullOrEmpty(e.api.shortcutApi.getAllShortcut()))e.api.internalApi.getSystemState().LastAppliedShortCut&&(o=!1);o&&t.node.setDataValue(i.colId,Number(t.value))}}e.filterOnUserDataChange([t.node]),e.debouncedSetSelectedCells()}})),this.gridOptions.api.addEventListener(o.Events.EVENT_CELL_VALUE_CHANGED,(function(t){t.newValue!=t.oldValue&&e.filterOnExternalDataChange([t.node])}));var l=[o.Events.EVENT_ROW_GROUP_OPENED,o.Events.EVENT_SELECTION_CHANGED,o.Events.EVENT_ROW_SELECTED];this.gridOptions.api.addGlobalListener((function(t){G.ArrayExtensions.ContainsItem(l,t)&&e.debouncedSetSelectedRows()})),this.gridOptions.api.addEventListener(o.Events.EVENT_COLUMN_ROW_GROUP_CHANGED,(function(e){})),this.gridOptions.api.addEventListener(o.Events.EVENT_SELECTION_CHANGED,(function(){})),this.gridOptions.api.addEventListener(o.Events.EVENT_RANGE_SELECTION_CHANGED,(function(){e.debouncedSetSelectedCells()}));var s=[o.Events.EVENT_SORT_CHANGED];this.gridOptions.api.addGlobalListener((function(t){G.ArrayExtensions.ContainsItem(s,t)&&(e.onSortChanged(),e.debouncedSetSelectedCells())})),this.gridOptions.api.addEventListener(o.Events.EVENT_MODEL_UPDATED,(function(t){if(e.adaptableOptions.generalOptions.showGroupingTotalsAsHeader&&t&&t.api){var i=t.api.getPinnedTopRow(0),n=t.api.getModel().getRootNode();i?i.updateData(n.aggData):t.api.setPinnedTopRowData([n.aggData])}e.checkColumnsDataTypeSet()})),this.rowListeners={dataChanged:function(t){e.onRowDataChanged({rowNode:t.node,oldData:t.oldData,newData:t.newData})}},$.dispatchLocalEvent=function(e){var i=e.node,n=ee.apply(this,arguments);return i&&t.forEachAdaptable((function(t){if(i.gridApi===t.gridOptions.api){var n=t.rowListeners?t.rowListeners[e.type]:null;n&&n(e)}})),n};var u=this.gridOptions.isExternalFilterPresent;this.gridOptions.isExternalFilterPresent=function(){var t,i,o=e.api.filterApi.getAllColumnFilter(),r=G.ArrayExtensions.IsNotNullOrEmpty(o);if(r)try{for(var a=n.__values(o),l=a.next();!l.done;l=a.next()){var s=l.value,p=e.gridOptions.columnApi.getColumn(s.ColumnId);p&&(p.isFilterActive()||p.setFilterActive(!0))}}catch(h){t={error:h}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}var d=R.StringExtensions.IsNotNullOrEmpty(e.api.queryApi.getCurrentQuery()),c=R.StringExtensions.IsNotNullOrEmpty(e.api.quickSearchApi.getQuickSearchValue());return r||d||c||!!u&&u()};var p=this.gridOptions.doesExternalFilterPass;this.gridOptions.doesExternalFilterPass=function(t){var i,o;if(!e.api.internalApi.isServerSearchOptionSet("Query")){var r=e.api.queryApi.getCurrentQuery();if(r&&!Z.evaluate(r,{node:t,api:e.api}))return!1}if(!e.api.internalApi.isServerSearchOptionSet("Filter")){var a=e.api.filterApi.getAllColumnFilter();if(a.length>0)try{for(var l=n.__values(a),s=l.next();!s.done;s=l.next()){var u=s.value;if(!e.api.filterApi.evaluateColumnFilter(u,t))return!1}}catch(d){i={error:d}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}}return!p||p(t)};var d=this.gridOptions.getMainMenuItems;this.gridOptions.getMainMenuItems=function(t){var i,n=t.column.getColId();if(d){var o=d(t);i=o.slice(0)}else i=t.defaultItems.slice(0);if(e.api.columnApi.isRowGroupColumn(n)){if(e.adaptableOptions.userInterfaceOptions.showUngroupColumnMenuItem){i.push("separator");var r={Label:1==e.gridOptions.columnApi.getRowGroupColumns().length?"Ungroup Column":"Ungroup All",ClickFunction:function(){return e.gridOptions.columnApi.setRowGroupColumns([])},IsVisible:!0,Icon:"undo"},a=e.agGridHelper.createAgGridMenuDefFromAdaptableMenu(r);i.push(a)}}else{i.push("separator");var l=e.api.columnApi.getColumnFromId(n);if(void 0!=l){var s=e.createMenuInfoObject(l);e.getAdaptableMenuItemsColumnHeader(l,s).forEach((function(t){var n=e.agGridHelper.createAgGridMenuDefFromAdaptableMenu(t);i.push(n)}));var u=e.getUserMenuItemsColumnHeader(s);G.ArrayExtensions.IsNotNullOrEmpty(u)&&u.forEach((function(t){var n=e.agGridHelper.createAgGridMenuDefFromUserMenu(t.Key,t.Value,s);i.push(n)}))}}return i};var c=this.gridOptions.getContextMenuItems;this.gridOptions.getContextMenuItems=function(t){var i,n=[];if(c){var o=c(t);n=o.slice(0)}else n=t.defaultItems?t.defaultItems.slice(0):[];var r=[],a=t.column;if(a){var l=e.api.columnApi.getColumnFromId(a.getColId());if(void 0!=l){if(i=e.agGridHelper.createMenuInfo(t,l),t.node.group||e.strategies.forEach((function(e){var t=e.addContextMenuItem(i);t&&r.push(t)})),G.ArrayExtensions.IsNotNullOrEmpty(r)){var s=e.adaptableOptions.userInterfaceOptions.showAdaptableContextMenu;null!=s&&!1===s||(n.push("separator"),r.forEach((function(t){if(t){var o=!0;if(null!=s&&"function"===typeof s&&(o=s(t,i)),o){var r=e.agGridHelper.createAgGridMenuDefFromAdaptableMenu(t);n.push(r)}}})))}var u=e.api.userInterfaceApi.getUserInterfaceState().ContextMenuItems;G.ArrayExtensions.IsNotNullOrEmpty(u)&&(n.push("separator"),u.filter((function(t){return!t.UserMenuItemShowPredicate||e.getUserFunctionHandler("UserMenuItemShowPredicate",t.UserMenuItemShowPredicate)(i)})).forEach((function(t){var o=t.Label,r=e.getUserFunctionHandler("UserMenuItemLabelFunction",t.Label);if(r){var a=r(i);R.StringExtensions.IsNotNullOrEmpty(a)&&(o=a)}var l=e.agGridHelper.createAgGridMenuDefFromUserMenu(o,t,i);n.push(l)})))}}return n},this.prepareGrid()}else D.LoggingHelper.LogAdaptableError('There is no DIV with id="'+this.adaptableOptions.containerOptions.adaptableContainer+'" so cannot render Adaptable')},t.prototype.createMenuInfoObject=function(e){return{GridCell:void 0,Column:e,IsSelectedCell:!1,IsSingleSelectedColumn:!1,IsGroupedNode:!1,RowNode:void 0,PrimaryKeyValue:void 0,SelectedCellInfo:this.api.gridApi.getSelectedCellInfo(),SelectedRowInfo:this.api.gridApi.getSelectedRowInfo(),AdaptableApi:this.api}},t.prototype.buildStandaloneColumnHeader=function(e){var t=this,i=this.createMenuInfoObject(e),o=[];o.push.apply(o,n.__spread(this.getAdaptableMenuItemsColumnHeader(e,i)));var r=this.getUserMenuItemsColumnHeader(i);return G.ArrayExtensions.IsNotNullOrEmpty(r)&&r.forEach((function(e){var n=t.agGridHelper.createAdaptableMenuItemFromUserMenu(e.Key,e.Value,i);o.push(n)})),o},t.prototype.getAdaptableMenuItemsColumnHeader=function(e,t){var i=[],o=this.adaptableOptions.userInterfaceOptions.showAdaptableColumnMenu,r=null==o||!1!==o;return null!=e&&this.strategies.forEach((function(a){var l=a.addColumnMenuItems(e);l&&(r?l.forEach((function(e){if(e){var n=!0;null!=o&&"function"===typeof o&&(n=o(e,t)),n&&i.push(e)}})):i.push.apply(i,n.__spread(l)))})),i},t.prototype.getUserMenuItemsColumnHeader=function(e){var t=this,i=[],n=this.api.userInterfaceApi.getUserInterfaceState().ColumnMenuItems;return G.ArrayExtensions.IsNotNullOrEmpty(n)&&n.filter((function(i){return!i.UserMenuItemShowPredicate||t.getUserFunctionHandler("UserMenuItemShowPredicate",i.UserMenuItemShowPredicate)(e)})).forEach((function(n){var o=n.Label,r=t.getUserFunctionHandler("UserMenuItemLabelFunction",n.Label);if(r){var a=r(e);R.StringExtensions.IsNotNullOrEmpty(a)&&(o=a)}var l={Key:o,Value:n};i.push(l)})),i},t.prototype.cleanupCols=function(){var e=this;this.gridOptions.columnApi.getAllColumns().forEach((function(t){var i=t.getColDef();i&&Object.assign(i,e.getPreviousColDefInfo(i))}))},t.prototype.prepareGrid=function(){this.cleanupCols(),this.addSpecialRendereredColumns(),this.applyFormatColumnDisplayFormats(),this.applyCustomSorts(),this.applyCurrentTheme(),this.applyFinalRendering(),this.applyGridFiltering(),this.redraw()},t.prototype.applyCurrentTheme=function(){this.api.themeApi.applyCurrentTheme()},t.prototype.applyCustomSorts=function(){var e=this;this.api.customSortApi.getAllCustomSort().forEach((function(t){e.setCustomSort(t)}))},t.prototype.applyFinalRendering=function(){var e=this;this.embedColumnMenu=this.agGridHelper.isModulePresent("menu"),this.gridOptions.defaultGroupSortComparator=this.agGridHelper.runAdaptableNodeComparerFunction();var t=this.api.userInterfaceApi.getAllEditLookUpItems();if(G.ArrayExtensions.IsNotNullOrEmpty(t)){var i=this.mapColumnDefs((function(t){var i=e.api.userInterfaceApi.getEditLookUpItemForColumnId(t.colId);return i&&(t.cellEditor="agRichSelectCellEditor",t.cellEditorParams={values:e.api.userInterfaceApi.getEditLookUpValuesForEditLookUpItem(i,t.colId)}),t}));this.safeSetColDefs(i)}this.gridOptions.treeData&&1==this.gridOptions.treeData?this.api.internalApi.setTreeModeOn():this.api.internalApi.setTreeModeOff(),this.agGridHelper.checkShouldClearExistingFiltersOrSearches()},t.prototype.applyFormatColumnDisplayFormats=function(){var e=this;this.gridOptions.columnApi.getAllColumns().forEach((function(t){var i=t.getColDef();void 0===e.originalColDefValueFormatters[i.field]&&(e.originalColDefValueFormatters[i.field]=i.valueFormatter||null),i.valueFormatter=e.originalColDefValueFormatters[i.field];var n=e.api.columnApi.getColumnFromId(i.colId);if(n){var o=e.api.formatColumnApi.getFormatColumnWithDisplayFormatForColumn(n);if(!o)return;if(o.DisplayFormat){if("NumberFormatter"===o.DisplayFormat.Formatter&&e.api.scopeApi.isColumnInNumericScope(n,o.Scope)){var r=o.DisplayFormat.Options;e.cachePreviousColDefInfo(i,"valueFormatter"),i.valueFormatter=function(e){return J.default.NumberFormatter(e.value,r)}}if("DateFormatter"===o.DisplayFormat.Formatter&&e.api.scopeApi.isColumnInDateScope(n,o.Scope)){var a=o.DisplayFormat.Options;e.cachePreviousColDefInfo(i,"valueFormatter"),i.valueFormatter=function(e){return J.default.DateFormatter(e.value,a)}}}if(null!=o.CellAlignment){switch(o.CellAlignment){case"Left":i.cellClass="ab-cell--align-left";break;case"Right":i.cellClass="ab-cell--align-right";break;case"Center":i.cellClass="ab-cell--align-center"}e.cachePreviousColDefInfo(i,"cellClass")}}}))},t.prototype.addSpecialRendereredColumns=function(){var e=this;this.forPlugins((function(){})),this.api.percentBarApi.getAllPercentBar().forEach((function(t){e.addPercentBar(t)})),this.api.gradientColumnApi.getAllGradientColumn().forEach((function(t){e.addGradientColumn(t)})),this.api.sparklineColumnApi.getAllSparklineColumn().forEach((function(t){e.addSparklineColumn(t)}))},t.prototype.addSparklineColumn=function(e){if(null!=e.LineColor&&void 0!=e.LineColor||(e.LineColor=U.DefaultSparklinesChartProperties.Brush),this.api.columnApi.getColumnFromId(e.ColumnId)){var t=this.agGridHelper.createSparklineCellRendererComp(e),i=this.gridOptions.columnApi.getColumn(e.ColumnId).getColDef();t&&(this.cachePreviousColDefInfo(i,"cellRenderer"),i.cellRenderer=t),this.cachePreviousColDefInfo(i,"tooltipField"),null!=e.ShowToolTip&&1==e.ShowToolTip?i.tooltipField=i.field:i.tooltipField=""}},t.prototype.removeSparklineColumn=function(e){if(this.api.columnApi.getColumnFromId(e.ColumnId)){var t=this.gridOptions.columnApi.getColumn(e.ColumnId).getColDef();t.cellRenderer=this.getPreviousColDefInfo(t).cellRenderer}},t.prototype.addGradientColumn=function(e){var t=this.gridOptions.api.getColumnDef(e.ColumnId),i=this.gridOptions.columnApi.getColumn(e.ColumnId);if(t&&i){var o=i.getUserProvidedColDef();this.cachePreviousColDefInfo(t,"cellStyle"),t.cellStyle=function(t){var i,r,a=e.BaseValue,l=t.value<0;if(l?(i=e.NegativeColor,r=e.NegativeValue):(i=e.PositiveColor,r=e.PositiveValue),r&&void 0!==a){var s=Math.abs(r-a),u=(t.value-a)/s*100;l&&(u*=-1);var p=Number((u/100).toPrecision(2)),d=o.cellStyle?"function"===typeof o.cellStyle?o.cellStyle(t):o.cellStyle:null;return n.__assign(n.__assign({},d),{"background-color":new F.Color(i).toRgba(p)})}}}},t.prototype.removeGradientColumn=function(e){var t=this.gridOptions.api.getColumnDef(e.ColumnId);t&&t.cellStyle&&(t.cellStyle=this.getPreviousColDefInfo(t).cellStyle)},t.prototype.addPercentBar=function(e){if(this.api.columnApi.getColumnFromId(e.ColumnId)){var t=this.agGridHelper.createPercentBarCellRendererFunc(e),i=this.gridOptions.columnApi.getColumn(e.ColumnId).getColDef();if(this.cachePreviousColDefInfo(i,"cellRenderer"),i.cellRenderer=t,null!=e.ShowToolTip&&1==e.ShowToolTip&&e.Ranges){var n=e.Ranges[0].Min,o=e.Ranges[e.Ranges.length-1].Max;this.cachePreviousColDefInfo(i,"tooltipValueGetter"),i.tooltipValueGetter=function(t){var i=t.value,r=(p.default(i,n,o)-n)/(o-n)*100;return e.DisplayRawValue&&e.DisplayPercentageValue?i+" ("+r.toFixed(0)+"%)":e.DisplayPercentageValue?r.toFixed(0)+"%":i}}else i.tooltipField=""}},t.prototype.removePercentBar=function(e){if(void 0!=this.api.columnApi.getColumnFromId(e.ColumnId)){var t=this.gridOptions.columnApi.getColumn(e.ColumnId);t.getColDef().cellRenderer=null;var i=t.getColDef();i.cellRenderer=this.getPreviousColDefInfo(i).cellRenderer}},t.prototype.isSharedQueryReferenced=function(e){var t="";return this.strategies.forEach((function(i){var n=i.getSharedQueryReferences(e);R.StringExtensions.IsNotNullOrEmpty(n)&&(t+=" "+n)})),!!R.StringExtensions.IsNotNullOrEmpty(t)&&(alert("Cannot delete the Shared Query because it is referenced in"+t),!0)},t.prototype.onRowDataChanged=function(e){var t=this,i=e.rowNode,n=e.oldData,o=e.newData;if(null!=n&&void 0!=n&&n!=o){var r=this.getPrimaryKeyValueFromRowNode(i);Object.keys(n).forEach((function(e){var a=n[e],l=o[e];if(a!=l){var s={OldValue:a,NewValue:l,ColumnId:e,PrimaryKeyValue:r,RowNode:i};t.performPostEditChecks(s,!1,!1)}}))}},t.prototype.performPostEditChecks=function(e,t,i){this.AuditLogService.isAuditCellEditsEnabled&&this.AuditLogService.addEditCellAuditLog(e),this.FreeTextColumnService.CheckIfDataChangingColumnIsFreeText(e),this.DataService.CreateDataChangedEvent(e),t&&this.filterOnUserDataChange([e.RowNode]),i&&this.filterOnExternalDataChange([e.RowNode]),this.checkChangedCellCurrentlySelected(e)},t.prototype.checkChangedCellCurrentlySelected=function(e){var t=this.api.gridApi.getSelectedCellInfo();t&&G.ArrayExtensions.IsNotNullOrEmpty(t.GridCells)&&(t.GridCells.find((function(t){return t.primaryKeyValue==e.PrimaryKeyValue&&t.columnId==e.ColumnId}))&&this.setSelectedCells());var i=this.api.gridApi.getSelectedRowInfo();i&&G.ArrayExtensions.IsNotNullOrEmpty(i.GridRows)&&(i.GridRows.find((function(t){return t.primaryKeyValue==e.PrimaryKeyValue}))&&this.setSelectedRows())},t.prototype.editPercentBar=function(e){this.removePercentBar(e),this.addPercentBar(e)},t.prototype.editGradientColumn=function(e){this.removeGradientColumn(e),this.addGradientColumn(e)},t.prototype.editSparklineColumn=function(e){this.removeSparklineColumn(e),this.addSparklineColumn(e)},t.prototype.onSortChanged=function(){var e=this,t=this.gridOptions.api.getSortModel(),i=[];G.ArrayExtensions.IsNotNullOrEmpty(t)&&t.forEach((function(t){e.api.columnApi.isRowGroupColumn(t.colId)&&e.agGridHelper.createGroupedColumnCustomSort();var n={ColumnId:t.colId,SortOrder:"asc"==t.sort?N.SortOrder.Asc:N.SortOrder.Desc};i.push(n)})),this.api.gridApi.setColumnSorts(i),this._emit("SortChanged",i)},t.prototype.expandAllRowGroups=function(){this.gridOptions.api.forEachNode((function(e){e.group&&(e.expanded=!0)})),this.gridOptions.api.onGroupExpandedOrCollapsed()},t.prototype.closeAllRowGroups=function(){this.gridOptions.api.forEachNode((function(e){e.group&&(e.expanded=!1)})),this.gridOptions.api.onGroupExpandedOrCollapsed()},t.prototype.expandRowGroupsForValues=function(e){if(G.ArrayExtensions.IsNotNullOrEmpty(e)){var t=e.reduce((function(e,t){return e[t]=!0,e}),{});this.gridOptions.api.forEachNode((function(e){if(e.group&&!e.expanded){for(var i=[],n=e;n;)i.push(n.key),n=n.parent;var o=i.filter((function(e){return!!e})).reverse().join("/");t[o]&&e.setExpanded(!0)}})),this.gridOptions.api.onGroupExpandedOrCollapsed()}},t.prototype.getExpandRowGroupsKeys=function(){var e=[];return this.adaptableOptions.layoutOptions.includeExpandedRowGroups&&this.gridOptions.api.forEachNode((function(t){if(t.group&&t.expanded){for(var i=t,n=[];i;)n.push(i.key),i=i.parent;e.push(n.filter((function(e){return!!e})).reverse().join("/"))}})),e},t.prototype.getRowCount=function(){return this.gridOptions.rowData?this.gridOptions.rowData.length:this.gridOptions.api.getDisplayedRowCount()},t.prototype.getColumnCount=function(){return this.gridOptions.columnApi.getAllColumns().length},t.prototype.getVisibleRowCount=function(){return this.gridOptions.api.getDisplayedRowCount()},t.prototype.getVisibleColumnCount=function(){return this.gridOptions.columnApi.getAllColumns().filter((function(e){return e.isVisible()})).length},t.prototype.selectColumns=function(e){var t=this;e.forEach((function(e){return t.selectColumn(e)}))},t.prototype.selectColumn=function(e){this.gridOptions.api.clearRangeSelection();var t={rowStartIndex:0,rowEndIndex:this.gridOptions.api.getDisplayedRowCount(),columnStart:e,columnEnd:e};this.gridOptions.api.addCellRange(t)},t.prototype.selectAll=function(){this.gridOptions.api.selectAll()},t.prototype.hideColumn=function(e){this.gridOptions.columnApi.getColumn(e)&&(this.gridOptions.columnApi.setColumnVisible(e,!1),this.updateColumnsIntoStore())},t.prototype.showColumn=function(e){this.gridOptions.columnApi.getColumn(e)&&(this.gridOptions.columnApi.setColumnVisible(e,!0),this.updateColumnsIntoStore())},t.prototype.setColumnSort=function(e){var t=[];G.ArrayExtensions.IsNotNullOrEmpty(e)&&e.forEach((function(e){var i=e.SortOrder==N.SortOrder.Asc?"asc":"desc";t.push({colId:e.ColumnId,sort:i})})),this.gridOptions.api&&(this.gridOptions.api.setSortModel(t),this.gridOptions.api.onSortChanged())},t.prototype.setDataSource=function(e){this.gridOptions.api&&this.gridOptions.api.setRowData(e)},t.prototype.loadDataSource=function(e){this.setDataSource(e)},t.prototype.updateRows=function(e,t){(t=t||{}).batchUpdate?this.gridOptions.api.applyTransactionAsync({update:e},t.callback):this.gridOptions.api.applyTransaction({update:e})},t.prototype.addRows=function(e){this.gridOptions.api.applyTransaction({add:e})},t.prototype.deleteRows=function(e){this.gridOptions.api.applyTransaction({remove:e})},t.prototype.getFirstGroupedColumn=function(){var e=this.gridOptions.columnApi.getRowGroupColumns();if(G.ArrayExtensions.IsNotNullOrEmpty(e)){var t=e[0];return this.api.columnApi.getColumnFromId(t.getColId())}},t.prototype.checkColumnsDataTypeSet=function(){var e=this.api.columnApi.getColumns()[0];e&&e.DataType==N.DataType.Unknown&&this.updateColumnsIntoStore()},t.prototype.setCustomSort=function(e){var t=e.CustomSortComparerFunction?this.getUserFunctionHandler("CustomSortComparerFunction",e.CustomSortComparerFunction):this.runAdaptableComparerFunction(e.ColumnId,e.SortedValues),i=this.gridOptions.api.getSortModel(),n=this.gridOptions.api.getColumnDef(e.ColumnId);n&&(n.comparator=t,n.pivotComparator=t),this.gridOptions.api.setSortModel(i)},t.prototype.removeCustomSort=function(e){var t=this.gridOptions.api.getSortModel(),i=this.gridOptions.api.getColumnDef(e.ColumnId);i&&(i.comparator=null),this.gridOptions.api.setSortModel(t)},t.prototype.runAdaptableComparerFunction=function(e,t){var i=this;return function(n,o,r,a){var l=r?i.getDisplayValueFromRowNode(r,e):n,s=a?i.getDisplayValueFromRowNode(a,e):o,u=t.indexOf(l),p=u>=0,d=t.indexOf(s),c=d>=0;return p||c?p?c?u-d:-1:1:n==o?0:n<o?-1:1}},t.prototype.isSelectable=function(){return!(!this.agGridHelper.isModulePresent("range-selection")||null==this.gridOptions.enableRangeSelection||!this.gridOptions.enableRangeSelection)},t.prototype.isGroupable=function(){return!this.api.internalApi.isGridInTreeMode()},t.prototype.isPivotable=function(){return!this.api.internalApi.isGridInTreeMode()},t.prototype.isQuickFilterAvailable=function(){return!0===this.hasFloatingFilterOnAtLeastOneColumn()},t.prototype.hasFloatingFilterOnAtLeastOneColumn=function(e){var t,i,o;if(void 0===e&&(e=this.gridOptions.columnDefs),this.gridOptions.defaultColDef&&this.gridOptions.defaultColDef.floatingFilter)return!0;try{for(var r=n.__values(e),a=r.next();!a.done;a=r.next()){if((o=a.value).floatingFilter)return!0;if(o.children&&this.hasFloatingFilterOnAtLeastOneColumn(o.children))return!0}}catch(l){t={error:l}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}return!1},t.prototype.showQuickFilter=function(){this.gridOptions.api.setFloatingFiltersHeight(null)},t.prototype.hideQuickFilter=function(){this.gridOptions.api.setFloatingFiltersHeight(0)},t.prototype.getVendorGridLightThemeName=function(){var e=this.getGridContainerElement();if(e&&e.classList)for(var t=e.classList,i=0,n=t.length;i<n;i++){var o=t[i];if(0===o.indexOf("ag-theme-"))return o.replace("-dark","")}return this.agGridHelper.getVendorLightThemeName()},t.prototype.getVendorGridCurrentThemeName=function(){var e=this.getGridContainerElement();if(e&&e.classList)for(var t=e.classList,i=0,n=t.length;i<n;i++){var o=t[i];if(0===o.indexOf("ag-theme-"))return o}return this.getVendorGridLightThemeName()},t.prototype.applyAdaptableTheme=function(e){var t=this,i="string"===typeof e?e:e.Name,o=[],r=[],a=this.api.themeApi.getAllTheme().map((function(e){return n.__assign({},e)})).reduce((function(e,t){return e[t.Name]=t,e}),{}),l=document.documentElement;l.classList.forEach((function(e){if(0===e.indexOf(g.THEME_STYLE)){o.push(e);var t=e.substring(g.THEME_STYLE.length);a[t]&&r.push(a[t])}})),o.forEach((function(e){return l.classList.remove(e)})),this.adaptableOptions.userInterfaceOptions&&this.adaptableOptions.userInterfaceOptions.useCustomMacLikeScrollbars&&q.default()>0?l.classList.add("ab--custom-mac-like-scrollbars"):l.classList.remove("ab--custom-mac-like-scrollbars");var s=a[i],u=g.THEME_STYLE+i;l.classList.add(u);var p=getComputedStyle(l),d=n.__read(["--ab-loaded","--ab-theme-loaded"].map((function(e){var t=p.getPropertyValue(e);return"string"===typeof t&&t.trim&&(t=t.trim()),t})),2),c=d[0],h=d[1],f=!!this.api.themeApi.getAllSystemTheme().filter((function(e){return e.Name===i}))[0],m=this.getGridContainerElement(),C=function(){return t.getVendorGridLightThemeName()};if(s&&f&&(i===L.LIGHT_THEME&&(s.VendorGridClassName=s.VendorGridClassName||C()),i===L.DARK_THEME&&(s.VendorGridClassName=s.VendorGridClassName||C()+"-dark")),s.VendorGridClassName||(s.VendorGridClassName=C()),null!=m){r.length&&r.forEach((function(e){e.VendorGridClassName&&m.classList.remove(e.VendorGridClassName)}));var v=[];m.classList.forEach((function(e){e&&0===e.indexOf("ag-theme-")&&v.push(e)})),v.forEach((function(e){return m.classList.remove(e)})),s&&s.VendorGridClassName&&m.classList.add(s.VendorGridClassName),m.classList.add("ab-Grid"),this.adaptableOptions.filterOptions.indicateFilteredColumns&&m.classList.add("ab-Grid--indicate-filtered-columns")}"777"!==c&&D.LoggingHelper.LogError('Please import Adaptable styles from "adaptableadaptable/index.css"'),h!==i&&D.LoggingHelper.LogWarning('Theme "'+i+'" doesn\'t seem to be loaded! Make sure you import the css file for the "'+i+'" theme!\n\nIf it\'s a default theme, try\n\nimport "@adaptabletools/adaptable/themes/'+i+'.css"')},t.prototype.setUpRowStyles=function(){this.agGridHelper.setUpRowStyles()},t.prototype.clearRowStyles=function(){this.agGridHelper.clearRowStyles()},t.prototype.getGridOptionsApi=function(){if(this.gridOptions.api)return this.gridOptions.api;D.LogAdaptableError("There is a problem with your instance of ag-Grid - it has no gridApi object.  Please contact Support.")},t.prototype.getUserFunctionHandler=function(e,t){var i,o;try{for(var r=n.__values(this.adaptableOptions.userFunctions),a=r.next();!a.done;a=r.next()){var l=a.value;if(l.type===e&&l.name===t)return l.handler}}catch(s){i={error:s}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return null},t.prototype.canExportToExcel=function(){return this.agGridHelper.isModulePresent("excel-export")},t.prototype.exportToExcel=function(e,t,i){var n={columnDefs:e.map((function(e){return{field:e,headerName:e}})),rowData:t.map((function(t){return d.default(e,t)}))},r=new o.Grid(document.createElement("div"),n);n.api.exportDataAsExcel({sheetName:"Sheet 1",fileName:i}),r.destroy()},t.prototype.exportVisibleToClipboard=function(e){this.gridOptions.api.selectAllFiltered(),this.gridOptions.api.copySelectedRowsToClipboard(!0),this.gridOptions.api.deselectAll()},t.prototype.exportVisibleToExcel=function(e){this.gridOptions.api.exportDataAsExcel({sheetName:"Sheet 1",fileName:e.Name})},t.prototype.exportVisibleToCsv=function(e){this.gridOptions.api.exportDataAsCsv({fileName:e.Name})},t}();t.Adaptable=ne;var oe=function(){function e(e,t){var i=this;void 0===t&&(t={});this.adaptableOptions=e,this.init=t.onInit||function(e){var t=e.gridOptions,o=e.adaptableOptions;return n.__awaiter(i,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return o.vendorGrid=t,[4,ne.init(o)];case 1:return[2,e.sent()]}}))}))},this.extraOptions=t,this.render()}return e.prototype.render=function(e){var t=this,i=Q.DefaultAdaptableOptions.containerOptions.adaptableContainer||"adaptable";if(e||this.adaptableOptions.containerOptions&&(i=this.adaptableOptions.containerOptions.adaptableContainer||"adaptable"),!(e=e||document.getElementById(i)))throw new Error("Cannot find container in which to render Adaptable No Code Wizard");e.classList.add("adaptable--in-wizard"),r.render(a.createElement(K.default,n.__assign(n.__assign({adaptableOptions:this.adaptableOptions},this.extraOptions),{onInit:function(i){e.classList.remove("adaptable--in-wizard"),r.unmountComponentAtNode(e),t.init({adaptableOptions:i,gridOptions:i.vendorGrid})}})),e)},e}();t.AdaptableNoCodeWizard=oe}).call(this,i("3r9c"))}}]);